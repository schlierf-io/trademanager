(self.webpackChunktradingview=self.webpackChunktradingview||[]).push([[5093],{259142:function(e,t){var i,s,l;s=[t],i=function(e){"use strict";function t(e){if(Array.isArray(e)){for(var t=0,i=Array(e.length);t<e.length;t++)i[t]=e[t];return i}return Array.from(e)}Object.defineProperty(e,"__esModule",{value:!0});var i=!1;if("undefined"!=typeof window){var s={get passive(){i=!0}};window.addEventListener("testPassive",null,s),window.removeEventListener("testPassive",null,s)}var l="undefined"!=typeof window&&window.navigator&&window.navigator.platform&&/iP(ad|hone|od)/.test(window.navigator.platform),o=[],n=!1,a=-1,r=void 0,d=void 0,u=function(e){return o.some((function(t){return!(!t.options.allowTouchMove||!t.options.allowTouchMove(e))}))},h=function(e){var t=e||window.event;return!!u(t.target)||1<t.touches.length||(t.preventDefault&&t.preventDefault(),!1)},c=function(){setTimeout((function(){void 0!==d&&(document.body.style.paddingRight=d,d=void 0),void 0!==r&&(document.body.style.overflow=r,r=void 0)}))};e.disableBodyScroll=function(e,s){if(l){if(!e)return void console.error("disableBodyScroll unsuccessful - targetElement must be provided when calling disableBodyScroll on IOS devices.");if(e&&!o.some((function(t){return t.targetElement===e}))){var c={targetElement:e,options:s||{}};o=[].concat(t(o),[c]),e.ontouchstart=function(e){1===e.targetTouches.length&&(a=e.targetTouches[0].clientY)},e.ontouchmove=function(t){var i,s,l,o;1===t.targetTouches.length&&(s=e,o=(i=t).targetTouches[0].clientY-a,!u(i.target)&&(s&&0===s.scrollTop&&0<o||(l=s)&&l.scrollHeight-l.scrollTop<=l.clientHeight&&o<0?h(i):i.stopPropagation()))},n||(document.addEventListener("touchmove",h,i?{passive:!1}:void 0),n=!0)}}else{_=s,setTimeout((function(){if(void 0===d){var e=!!_&&!0===_.reserveScrollBarGap,t=window.innerWidth-document.documentElement.clientWidth;e&&0<t&&(d=document.body.style.paddingRight,document.body.style.paddingRight=t+"px")}void 0===r&&(r=document.body.style.overflow,document.body.style.overflow="hidden")}));var p={targetElement:e,options:s||{}};o=[].concat(t(o),[p])}var _},e.clearAllBodyScrollLocks=function(){l?(o.forEach((function(e){e.targetElement.ontouchstart=null,e.targetElement.ontouchmove=null})),n&&(document.removeEventListener("touchmove",h,i?{passive:!1}:void 0),n=!1),o=[],a=-1):(c(),o=[])},e.enableBodyScroll=function(e){if(l){if(!e)return void console.error("enableBodyScroll unsuccessful - targetElement must be provided when calling enableBodyScroll on IOS devices.");e.ontouchstart=null,e.ontouchmove=null,o=o.filter((function(t){return t.targetElement!==e})),n&&0===o.length&&(document.removeEventListener("touchmove",h,i?{passive:!1}:void 0),n=!1)}else 1===o.length&&o[0].targetElement===e?(c(),o=[]):o=o.filter((function(t){return t.targetElement!==e}))}},void 0===(l="function"==typeof i?i.apply(t,s):i)||(e.exports=l)},981193:e=>{e.exports={container:"container-Mtq7m9Yl","intent-default":"intent-default-Mtq7m9Yl",focused:"focused-Mtq7m9Yl",readonly:"readonly-Mtq7m9Yl",disabled:"disabled-Mtq7m9Yl",
"with-highlight":"with-highlight-Mtq7m9Yl",grouped:"grouped-Mtq7m9Yl","adjust-position":"adjust-position-Mtq7m9Yl","first-row":"first-row-Mtq7m9Yl","first-col":"first-col-Mtq7m9Yl",stretch:"stretch-Mtq7m9Yl","font-size-medium":"font-size-medium-Mtq7m9Yl","font-size-large":"font-size-large-Mtq7m9Yl","no-corner-top-left":"no-corner-top-left-Mtq7m9Yl","no-corner-top-right":"no-corner-top-right-Mtq7m9Yl","no-corner-bottom-right":"no-corner-bottom-right-Mtq7m9Yl","no-corner-bottom-left":"no-corner-bottom-left-Mtq7m9Yl","size-small":"size-small-Mtq7m9Yl","size-medium":"size-medium-Mtq7m9Yl","size-large":"size-large-Mtq7m9Yl","intent-success":"intent-success-Mtq7m9Yl","intent-warning":"intent-warning-Mtq7m9Yl","intent-danger":"intent-danger-Mtq7m9Yl","intent-primary":"intent-primary-Mtq7m9Yl","border-none":"border-none-Mtq7m9Yl","border-thin":"border-thin-Mtq7m9Yl","border-thick":"border-thick-Mtq7m9Yl",highlight:"highlight-Mtq7m9Yl",shown:"shown-Mtq7m9Yl"}},484684:e=>{e.exports={"inner-slot":"inner-slot-yJbunXPO",interactive:"interactive-yJbunXPO",icon:"icon-yJbunXPO","inner-middle-slot":"inner-middle-slot-yJbunXPO","before-slot":"before-slot-yJbunXPO","after-slot":"after-slot-yJbunXPO"}},358089:e=>{e.exports={input:"input-oiYdY6I4","with-start-slot":"with-start-slot-oiYdY6I4","with-end-slot":"with-end-slot-oiYdY6I4"}},733319:e=>{e.exports={loader:"loader-PZ4hqS2H",static:"static-PZ4hqS2H",item:"item-PZ4hqS2H","tv-button-loader":"tv-button-loader-PZ4hqS2H",medium:"medium-PZ4hqS2H",small:"small-PZ4hqS2H",black:"black-PZ4hqS2H",white:"white-PZ4hqS2H",gray:"gray-PZ4hqS2H",primary:"primary-PZ4hqS2H","loader-initial":"loader-initial-PZ4hqS2H","loader-appear":"loader-appear-PZ4hqS2H"}},452395:(e,t,i)=>{"use strict";i.d(t,{ControlSkeleton:()=>b,InputClasses:()=>m});var s=i(50959),l=i(497754),o=i(650151),n=i(662929),a=i(8626),r=i(301792),d=i(307754);var u=i(981193),h=i.n(u);function c(e){let t="";return 0!==e&&(1&e&&(t=l(t,h()["no-corner-top-left"])),2&e&&(t=l(t,h()["no-corner-top-right"])),4&e&&(t=l(t,h()["no-corner-bottom-right"])),8&e&&(t=l(t,h()["no-corner-bottom-left"]))),t}function p(e,t,i,s){const{removeRoundBorder:o,className:n,intent:a="default",borderStyle:r="thin",size:u,highlight:p,disabled:_,readonly:m,stretch:g,noReadonlyStyles:v,isFocused:b}=e,w=c(null!=o?o:(0,d.getGroupCellRemoveRoundBorders)(i));return l(h().container,h()[`intent-${a}`],h()[`border-${r}`],u&&h()[`size-${u}`],w,p&&h()["with-highlight"],_&&h().disabled,m&&!v&&h().readonly,b&&h().focused,g&&h().stretch,t&&h().grouped,!s&&h()["adjust-position"],i.isTop&&h()["first-row"],i.isLeft&&h()["first-col"],n)}function _(e,t){const{highlight:i,highlightRemoveRoundBorder:s}=e;if(!i)return h().highlight;const o=c(null!=s?s:(0,d.getGroupCellRemoveRoundBorders)(t));return l(h().highlight,h().shown,o)}const m={FontSizeMedium:(0,o.ensureDefined)(h()["font-size-medium"]),FontSizeLarge:(0,o.ensureDefined)(h()["font-size-large"])},g={passive:!1};function v(e,t){
const{style:i,id:l,role:o,onFocus:d,onBlur:u,onMouseOver:h,onMouseOut:c,onMouseDown:m,onMouseUp:v,onKeyDown:b,onClick:w,tabIndex:y,startSlot:S,middleSlot:f,endSlot:M,onWheel:C,onWheelNoPassive:E=null}=e,{isGrouped:V,cellState:x,disablePositionAdjustment:T=!1}=(0,s.useContext)(r.ControlGroupContext),P=function(e,t=null,i){const l=(0,s.useRef)(null),o=(0,s.useRef)(null),n=(0,s.useCallback)((()=>{if(null===l.current||null===o.current)return;const[e,t,i]=o.current;null!==t&&l.current.addEventListener(e,t,i)}),[]),a=(0,s.useCallback)((()=>{if(null===l.current||null===o.current)return;const[e,t,i]=o.current;null!==t&&l.current.removeEventListener(e,t,i)}),[]),r=(0,s.useCallback)((e=>{a(),l.current=e,n()}),[]);return(0,s.useEffect)((()=>(o.current=[e,t,i],n(),a)),[e,t,i]),r}("wheel",E,g);return s.createElement("span",{style:i,id:l,role:o,className:p(e,V,x,T),tabIndex:y,ref:(0,n.useMergedRefs)([t,P]),onFocus:d,onBlur:u,onMouseOver:h,onMouseOut:c,onMouseDown:m,onMouseUp:v,onKeyDown:b,onClick:w,onWheel:C,...(0,a.filterDataProps)(e),...(0,a.filterAriaProps)(e)},S,f,M,s.createElement("span",{className:_(e,x)}))}v.displayName="ControlSkeleton";const b=s.forwardRef(v)},514420:(e,t,i)=>{"use strict";i.d(t,{BeforeSlot:()=>a,StartSlot:()=>r,MiddleSlot:()=>d,EndSlot:()=>u,AfterSlot:()=>h});var s=i(50959),l=i(497754),o=i(484684),n=i.n(o);function a(e){const{className:t,children:i}=e;return s.createElement("span",{className:l(n()["before-slot"],t)},i)}function r(e){const{className:t,interactive:i=!0,icon:o=!1,children:a}=e;return s.createElement("span",{className:l(n()["inner-slot"],i&&n().interactive,o&&n().icon,t)},a)}function d(e){const{className:t,children:i}=e;return s.createElement("span",{className:l(n()["inner-slot"],n()["inner-middle-slot"],t)},i)}function u(e){const{className:t,interactive:i=!0,icon:o=!1,children:a}=e;return s.createElement("span",{className:l(n()["inner-slot"],i&&n().interactive,o&&n().icon,t)},a)}function h(e){const{className:t,children:i}=e;return s.createElement("span",{className:l(n()["after-slot"],t)},i)}},521040:(e,t,i)=>{"use strict";i.d(t,{InputControl:()=>b});var s=i(50959),l=i(497754),o=i(8626),n=i(763341),a=i(151057),r=i(662929),d=i(207357),u=i(405964),h=i(633750),c=i(452395),p=i(514420),_=i(358089),m=i.n(_);function g(e){return!(0,o.isAriaAttribute)(e)&&!(0,o.isDataAttribute)(e)}function v(e){const{id:t,title:i,role:n,tabIndex:a,placeholder:r,name:d,type:u,value:h,defaultValue:_,draggable:v,autoComplete:b,autoFocus:w,maxLength:y,min:S,max:f,step:M,pattern:C,inputMode:E,onSelect:V,onFocus:x,onBlur:T,onKeyDown:P,onKeyUp:k,onKeyPress:L,onChange:A,onDragStart:W,size:H="medium",className:B,inputClassName:D,disabled:z,readonly:I,containerTabIndex:N,startSlot:O,endSlot:R,reference:G,containerReference:F,onContainerFocus:q,...j}=e,U=(0,o.filterProps)(j,g),$={...(0,o.filterAriaProps)(j),...(0,o.filterDataProps)(j),id:t,title:i,role:n,tabIndex:a,placeholder:r,name:d,type:u,value:h,defaultValue:_,draggable:v,autoComplete:b,autoFocus:w,maxLength:y,min:S,max:f,step:M,pattern:C,inputMode:E,onSelect:V,onFocus:x,
onBlur:T,onKeyDown:P,onKeyUp:k,onKeyPress:L,onChange:A,onDragStart:W};return s.createElement(c.ControlSkeleton,{...U,disabled:z,readonly:I,tabIndex:N,className:l(m().container,B),size:H,ref:F,onFocus:q,startSlot:O,middleSlot:s.createElement(p.MiddleSlot,null,s.createElement("input",{...$,className:l(m().input,D,O&&m()["with-start-slot"],R&&m()["with-end-slot"]),disabled:z,readOnly:I,ref:G})),endSlot:R})}function b(e){e=(0,d.useControl)(e);const{disabled:t,autoSelectOnFocus:i,tabIndex:l=0,onFocus:o,onBlur:c,reference:p,containerReference:_=null}=e,m=(0,s.useRef)(null),g=(0,s.useRef)(null),[b,w]=(0,u.useFocus)(),y=t?void 0:b?-1:l,S=t?void 0:b?l:-1,{isMouseDown:f,handleMouseDown:M,handleMouseUp:C}=(0,h.useIsMouseDown)(),E=(0,n.createSafeMulticastEventHandler)(w.onFocus,(function(e){i&&!f.current&&(0,a.selectAllContent)(e.currentTarget)}),o),V=(0,n.createSafeMulticastEventHandler)(w.onBlur,c),x=(0,s.useCallback)((e=>{m.current=e,p&&("function"==typeof p&&p(e),"object"==typeof p&&(p.current=e))}),[m,p]);return s.createElement(v,{...e,isFocused:b,containerTabIndex:y,tabIndex:S,onContainerFocus:function(e){g.current===e.target&&null!==m.current&&m.current.focus()},onFocus:E,onBlur:V,reference:x,containerReference:(0,r.useMergedRefs)([g,_]),onMouseDown:M,onMouseUp:C})}},207357:(e,t,i)=>{"use strict";i.d(t,{useControl:()=>o});var s=i(763341),l=i(405964);function o(e){const{onFocus:t,onBlur:i,intent:o,highlight:n,disabled:a}=e,[r,d]=(0,l.useFocus)(void 0,a),u=(0,s.createSafeMulticastEventHandler)(a?void 0:d.onFocus,t),h=(0,s.createSafeMulticastEventHandler)(a?void 0:d.onBlur,i);return{...e,intent:o||(r?"primary":"default"),highlight:null!=n?n:r,onFocus:u,onBlur:h}}},405964:(e,t,i)=>{"use strict";i.d(t,{useFocus:()=>l});var s=i(50959);function l(e,t){const[i,l]=(0,s.useState)(!1);(0,s.useEffect)((()=>{t&&i&&l(!1)}),[t,i]);const o={onFocus:(0,s.useCallback)((function(t){void 0!==e&&e.current!==t.target||l(!0)}),[e]),onBlur:(0,s.useCallback)((function(t){void 0!==e&&e.current!==t.target||l(!1)}),[e])};return[i,o]}},640027:(e,t,i)=>{"use strict";i.d(t,{useIsMounted:()=>l});var s=i(50959);const l=()=>{const e=(0,s.useRef)(!1);return(0,s.useEffect)((()=>(e.current=!0,()=>{e.current=!1})),[]),e}},633750:(e,t,i)=>{"use strict";i.d(t,{useIsMouseDown:()=>l});var s=i(50959);function l(){const e=(0,s.useRef)(!1),t=(0,s.useCallback)((()=>{e.current=!0}),[e]),i=(0,s.useCallback)((()=>{e.current=!1}),[e]);return{isMouseDown:e,handleMouseDown:t,handleMouseUp:i}}},662929:(e,t,i)=>{"use strict";i.d(t,{useMergedRefs:()=>o});var s=i(50959),l=i(551080);function o(e){return(0,s.useCallback)((0,l.mergeRefs)(e),e)}},612247:(e,t,i)=>{"use strict";i.d(t,{Loader:()=>d});var s,l=i(50959),o=i(497754),n=i(745269),a=i(733319),r=i.n(a);!function(e){e[e.Initial=0]="Initial",e[e.Appear=1]="Appear",e[e.Active=2]="Active"}(s||(s={}));class d extends l.PureComponent{constructor(e){super(e),this._stateChangeTimeout=null,this.state={state:s.Initial}}render(){const{className:e,color:t="black",size:i="medium",staticPosition:s}=this.props,n=o(r().item,r()[t],r()[i])
;return l.createElement("span",{className:o(r().loader,s&&r().static,this._getStateClass(),e)},l.createElement("span",{className:n}),l.createElement("span",{className:n}),l.createElement("span",{className:n}))}componentDidMount(){this.setState({state:s.Appear}),this._stateChangeTimeout=setTimeout((()=>{this.setState({state:s.Active})}),2*n.dur)}componentWillUnmount(){this._stateChangeTimeout&&(clearTimeout(this._stateChangeTimeout),this._stateChangeTimeout=null)}_getStateClass(){switch(this.state.state){case s.Initial:return r()["loader-initial"];case s.Appear:return r()["loader-appear"];default:return""}}}},364511:(e,t,i)=>{"use strict";i.d(t,{SwitchGroup:()=>s.SwitchGroup,makeSwitchGroupItem:()=>l.makeSwitchGroupItem});var s=i(367254),l=i(771813)},771813:(e,t,i)=>{"use strict";i.d(t,{makeSwitchGroupItem:()=>o});var s=i(50959),l=i(719036);function o(e){var t;return t=class extends s.PureComponent{constructor(){super(...arguments),this._onChange=e=>{this.context.switchGroupContext.getOnChange()(e)},this._onUpdate=e=>{e.includes(this.props.value)&&this.forceUpdate()}}componentDidMount(){this.context.switchGroupContext.subscribe(this._onUpdate)}render(){return s.createElement(e,{...this.props,name:this._getName(),onChange:this._onChange,checked:this._isChecked()})}componentWillUnmount(){this.context.switchGroupContext.unsubscribe(this._onUpdate)}_getName(){return this.context.switchGroupContext.getName()}_isChecked(){return this.context.switchGroupContext.getValues().includes(this.props.value)}},t.contextTypes={switchGroupContext:l.any.isRequired},t}},367254:(e,t,i)=>{"use strict";i.d(t,{SwitchGroup:()=>o});var s=i(50959),l=i(719036);class o extends s.PureComponent{constructor(){super(...arguments),this._subscriptions=new Set,this._getName=()=>this.props.name,this._getValues=()=>this.props.values,this._getOnChange=()=>this.props.onChange,this._subscribe=e=>{this._subscriptions.add(e)},this._unsubscribe=e=>{this._subscriptions.delete(e)}}getChildContext(){return{switchGroupContext:{getName:this._getName,getValues:this._getValues,getOnChange:this._getOnChange,subscribe:this._subscribe,unsubscribe:this._unsubscribe}}}render(){return this.props.children}componentDidUpdate(e){this._notify(this._getUpdates(this.props.values,e.values))}_notify(e){this._subscriptions.forEach((t=>t(e)))}_getUpdates(e,t){return[...t,...e].filter((i=>t.includes(i)?!e.includes(i):e.includes(i)))}}o.childContextTypes={switchGroupContext:l.any.isRequired}},151057:(e,t,i)=>{"use strict";function s(e){null!==e&&e.setSelectionRange(0,e.value.length)}i.d(t,{selectAllContent:()=>s})},763341:(e,t,i)=>{"use strict";function s(...e){return t=>{for(const i of e)void 0!==i&&i(t)}}i.d(t,{createSafeMulticastEventHandler:()=>s})},822714:(e,t,i)=>{"use strict";i.r(t),i.d(t,{convertToCustomSymbolList:()=>n,convertToMarkedSymbolList:()=>a,convertToSymbolList:()=>r,getCustomWatchLists:()=>d,getAllWatchLists:()=>u,renameWatchList:()=>h,removeWatchList:()=>c,addSymbols:()=>p,removeSymbols:()=>_,replaceSymbols:()=>m,createWatchList:()=>g,putWatchList:()=>v,
setActive:()=>b,getActive:()=>w,changeDescription:()=>y});var s=i(650151),l=i(890740),o=i(658583);function n(e){var t;return{type:"custom",id:e.id,name:e.name,description:e.description,symbols:null!==(t=e.symbols)&&void 0!==t?t:[],shared:e.shared}}function a(e){var t,i;const l=(0,s.ensureNotNull)(e.color);return{type:"colored",id:l,color:l,name:null!==(t=e.name)&&void 0!==t?t:null,description:e.description,symbols:null!==(i=e.symbols)&&void 0!==i?i:[],shared:e.shared}}function r(e){return"custom"===e.type?n(e):a(e)}function d(){return(0,l.fetch)("/api/v1/symbols_list/custom/").then(o.handleJSON).then((e=>e.map(n)))}function u(){return(0,l.fetch)("/api/v1/symbols_list/all/").then(o.handleJSON).then((e=>e.map(r)))}function h(e,t){return(0,l.fetch)(`/api/v1/symbols_list/custom/${e.id}/rename/`,{method:"POST",body:JSON.stringify({name:t}),headers:{"Content-Type":"application/json"}}).then(o.handleJSON)}function c(e){return(0,l.fetch)(`/api/v1/symbols_list/custom/${e.id}/`,{method:"DELETE"}).then(o.handleJSON)}function p(e,t){return(0,l.fetch)(`/api/v1/symbols_list/custom/${e.id}/append/`,{method:"POST",body:JSON.stringify(t),headers:{"Content-Type":"application/json"}}).then(o.handleJSON)}function _(e,t){return(0,l.fetch)(`/api/v1/symbols_list/custom/${e.id}/remove/`,{method:"POST",body:JSON.stringify(t),headers:{"Content-Type":"application/json"}}).then(o.handleJSON)}function m(e,t){return(0,l.fetch)(`/api/v1/symbols_list/custom/${e.id}/replace/?unsafe=true`,{method:"POST",body:JSON.stringify(t),headers:{"Content-Type":"application/json"}}).then(o.handleJSON)}function g(e){return(0,l.fetch)("/api/v1/symbols_list/custom/",{method:"POST",body:JSON.stringify({name:e.name,symbols:e.symbols}),headers:{"Content-Type":"application/json"}}).then(o.handleJSON).then(n)}function v(e){throw new Error("not implemented")}function b(e){return(0,l.fetch)(`/api/v1/symbols_list/active/${e}/`,{method:"POST"})}async function w(){if((0,o.isDesktopWatchlistAvailable)(window.TVD)){const e=await window.TVD.getActiveWatchlistId();if(e){const t=await u(),i=t.find((t=>t.id===e));return null!=i?i:t[0]}}return(0,l.fetch)("/api/v1/symbols_list/active/",{method:"GET"}).then(o.handleJSON).then(r)}function y(e,t){return(0,l.fetch)(`/api/v1/symbols_list/custom/${e}/update_meta/`,{method:"POST",body:JSON.stringify({description:t}),headers:{"Content-Type":"application/json"}}).then(o.handleJSON).then(r)}},658583:(e,t,i)=>{"use strict";i.d(t,{handleJSON:()=>l,isDesktopWatchlistAvailable:()=>o});var s=i(638456);function l(e){return e.ok?204===e.status?Promise.resolve():e.json():e.json().then((e=>{const t=new Error(e.detail||"not ok");throw e.code&&(t.name=`ApiError:${e.code}`),t}))}function o(e){return Boolean((0,s.isDesktopApp)()&&e&&"getActiveWatchlistId"in e&&"onActiveWatchlistIdChange"in e)}},733410:(e,t,i)=>{"use strict";i.d(t,{KeyCode:()=>s,KeyboardListener:()=>o,makeKeyboardListener:()=>n});var s,l=i(50959);!function(e){e[e.Enter=13]="Enter",e[e.Space=32]="Space",e[e.Backspace=8]="Backspace",e[e.DownArrow=40]="DownArrow",e[e.UpArrow=38]="UpArrow",
e[e.RightArrow=39]="RightArrow",e[e.LeftArrow=37]="LeftArrow",e[e.Escape=27]="Escape",e[e.Tab=9]="Tab"}(s||(s={}));class o{constructor(){this._handlers=new Map}registerHandlers(e){Object.keys(e).forEach((t=>{const i=parseInt(t);let s=e[i];if(Array.isArray(s)||(s=[s]),this._handlers.has(i)){const e=this._handlers.get(i);e&&s.forEach((t=>e.add(t)))}else this._handlers.set(i,new Set(s))}))}unregisterHandlers(e){Object.keys(e).forEach((t=>{const i=parseInt(t);let s=e[i];if(Array.isArray(s)||(s=[s]),this._handlers.has(i)){const e=this._handlers.get(i);e&&s.forEach((t=>e.delete(t)))}}))}deleteAllHandlers(){this._handlers=new Map}registerHandler(e,t){if(this._handlers.has(e)){const i=this._handlers.get(e);i&&i.add(t)}else this._handlers.set(e,new Set([t]))}unregisterHandler(e,t){if(this._handlers.has(e)){const i=this._handlers.get(e);i&&i.delete(t)}}listen(e){if(this._handlers.has(e.keyCode)){const t=this._handlers.get(e.keyCode);t&&t.forEach((t=>t(e)))}}}function n(e){var t,i,s;return(s=class extends l.PureComponent{constructor(e){super(e),this._keyboardListener=new o,this._listener=this._keyboardListener.listen.bind(this._keyboardListener)}componentDidMount(){this._registerHandlers(this.props.keyboardEventHandlers)}componentDidUpdate(e){e.keyboardEventHandlers!==this.props.keyboardEventHandlers&&this._registerHandlers(this.props.keyboardEventHandlers)}render(){const{keyboardEventHandlers:t,...i}=this.props;return l.createElement(e,{...i,onKeyDown:this._listener})}_registerHandlers(e){e&&(this._keyboardListener.deleteAllHandlers(),this._keyboardListener.registerHandlers(e))}}).displayName=`KeyboardListener(${null!==(i=null!==(t=e.displayName)&&void 0!==t?t:e.name)&&void 0!==i?i:"Component"})`,s}},320116:(e,t,i)=>{"use strict";i.d(t,{CloseDelegateContext:()=>o});var s=i(50959),l=i(224743);const o=s.createContext(l.globalCloseDelegate)},377145:(e,t,i)=>{"use strict";function s(e,t){return e===t}function l(e,t,i){if(null===t||null===i||t.length!==i.length)return!1;for(var s=t.length,l=0;l<s;l++)if(!e(t[l],i[l]))return!1;return!0}function o(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:s,i=null,o=null;return function(){return l(t,i,arguments)||(o=e.apply(null,arguments)),i=arguments,o}}function n(e){var t=Array.isArray(e[0])?e[0]:e;if(!t.every((function(e){return"function"==typeof e}))){var i=t.map((function(e){return typeof e})).join(", ");throw new Error("Selector creators expect all input-selectors to be functions, instead received the following types: ["+i+"]")}return t}i.d(t,{defaultMemoize:()=>o,createSelector:()=>a});var a=function(e){for(var t=arguments.length,i=Array(t>1?t-1:0),s=1;s<t;s++)i[s-1]=arguments[s];return function(){for(var t=arguments.length,s=Array(t),l=0;l<t;l++)s[l]=arguments[l];var o=0,a=s.pop(),r=n(s),d=e.apply(void 0,[function(){return o++,a.apply(null,arguments)}].concat(i)),u=e((function(){for(var e=[],t=r.length,i=0;i<t;i++)e.push(r[i].apply(null,arguments));return d.apply(null,e)}));return u.resultFunc=a,u.dependencies=r,u.recomputations=function(){return o},
u.resetRecomputations=function(){return o=0},u}}(o)},149021:e=>{e.exports={"animation-minimize-corner-left-top":"animation-minimize-corner-left-top-qWid4aZU","animation-minimize-corner-right-top":"animation-minimize-corner-right-top-qWid4aZU","animation-minimize-corner-right-bottom":"animation-minimize-corner-right-bottom-qWid4aZU","animation-minimize-corner-left-bottom":"animation-minimize-corner-left-bottom-qWid4aZU","animation-maximize-corner-left-top":"animation-maximize-corner-left-top-qWid4aZU","animation-maximize-corner-right-top":"animation-maximize-corner-right-top-qWid4aZU","animation-maximize-corner-right-bottom":"animation-maximize-corner-right-bottom-qWid4aZU","animation-maximize-corner-left-bottom":"animation-maximize-corner-left-bottom-qWid4aZU"}},839653:e=>{e.exports={marginlegendhoriz:"4px",legend:"legend-G1_Pfvwd",item:"item-G1_Pfvwd",withAction:"withAction-G1_Pfvwd",selected:"selected-G1_Pfvwd",last:"last-G1_Pfvwd",text:"text-G1_Pfvwd",noWrapWrapper:"noWrapWrapper-G1_Pfvwd",noWrap:"noWrap-G1_Pfvwd",series:"series-G1_Pfvwd",valuesAdditionalWrapper:"valuesAdditionalWrapper-G1_Pfvwd",valueItem:"valueItem-G1_Pfvwd",valueTitle:"valueTitle-G1_Pfvwd",valueValue:"valueValue-G1_Pfvwd",hideUniportantValueItems:"hideUniportantValueItems-G1_Pfvwd",unimportant:"unimportant-G1_Pfvwd",valuesWrapper:"valuesWrapper-G1_Pfvwd",wrappable:"wrappable-G1_Pfvwd",directionColumn:"directionColumn-G1_Pfvwd",titleWrapper:"titleWrapper-G1_Pfvwd",button:"button-G1_Pfvwd",statusesWrapper:"statusesWrapper-G1_Pfvwd",buttonsWrapper:"buttonsWrapper-G1_Pfvwd",buttons:"buttons-G1_Pfvwd",noActions:"noActions-G1_Pfvwd",title:"title-G1_Pfvwd",intervalTitle:"intervalTitle-G1_Pfvwd",disabled:"disabled-G1_Pfvwd",disabledOnInterval:"disabledOnInterval-G1_Pfvwd",withDot:"withDot-G1_Pfvwd",withCustomTextColor:"withCustomTextColor-G1_Pfvwd",study:"study-G1_Pfvwd",mainTitle:"mainTitle-G1_Pfvwd",descTitle:"descTitle-G1_Pfvwd",hideValues:"hideValues-G1_Pfvwd",has5Buttons:"has5Buttons-G1_Pfvwd",stayInHoveredMode:"stayInHoveredMode-G1_Pfvwd",withTail:"withTail-G1_Pfvwd",loading:"loading-G1_Pfvwd",loader:"loader-G1_Pfvwd",providerTitle:"providerTitle-G1_Pfvwd",exchangeTitle:"exchangeTitle-G1_Pfvwd",styleTitle:"styleTitle-G1_Pfvwd",minHideIntervalTitle:"minHideIntervalTitle-G1_Pfvwd",microHideIntervalTitle:"microHideIntervalTitle-G1_Pfvwd",hideExchangeProviderTitles:"hideExchangeProviderTitles-G1_Pfvwd",flagged:"flagged-G1_Pfvwd",medium:"medium-G1_Pfvwd",minimized:"minimized-G1_Pfvwd",micro:"micro-G1_Pfvwd",onlyOneButtonCanBeStick:"onlyOneButtonCanBeStick-G1_Pfvwd",touchMode:"touchMode-G1_Pfvwd",buttonIcon:"buttonIcon-G1_Pfvwd",flag:"flag-G1_Pfvwd",invisibleHover:"invisibleHover-G1_Pfvwd",eye:"eye-G1_Pfvwd",eyeLoading:"eyeLoading-G1_Pfvwd","eye-animation":"eye-animation-G1_Pfvwd",intervalEye:"intervalEye-G1_Pfvwd",markerContainer:"markerContainer-G1_Pfvwd",flagWrapper:"flagWrapper-G1_Pfvwd",sourcesWrapper:"sourcesWrapper-G1_Pfvwd",legendMainSourceWrapper:"legendMainSourceWrapper-G1_Pfvwd",sources:"sources-G1_Pfvwd",
toggler:"toggler-G1_Pfvwd pane-button-Cky0LHBF",onlyOneSourceShown:"onlyOneSourceShown-G1_Pfvwd",counter:"counter-G1_Pfvwd",iconArrow:"iconArrow-G1_Pfvwd",objectTree:"objectTree-G1_Pfvwd",closed:"closed-G1_Pfvwd",objectsTreeCanBeShown:"objectsTreeCanBeShown-G1_Pfvwd"}},818940:e=>{e.exports={loader:"loader-vqx5DqPL",loaderItem:"loaderItem-vqx5DqPL","loader-animation":"loader-animation-vqx5DqPL",touchMode:"touchMode-vqx5DqPL"}},567562:e=>{e.exports={"css-value-pane-controls-padding-left":"1px","css-value-pane-controls-padding-right":"5px",css_value_pane_controls_margin_top:"6",css_value_pane_controls_button_size:"19",css_value_pane_controls_button_touch_size:"19",paneControls:"paneControls-dKqC8zmq",hidden:"hidden-dKqC8zmq",forceHidden:"forceHidden-dKqC8zmq",button:"button-dKqC8zmq pane-button-Cky0LHBF",buttonIcon:"buttonIcon-dKqC8zmq",minimize:"minimize-dKqC8zmq",restore:"restore-dKqC8zmq",newButton:"newButton-dKqC8zmq",touchMode:"touchMode-dKqC8zmq",maximize:"maximize-dKqC8zmq",collapse:"collapse-dKqC8zmq","maximize-animation-up-bracket":"maximize-animation-up-bracket-dKqC8zmq","maximize-animation-down-bracket":"maximize-animation-down-bracket-dKqC8zmq","minimize-animation-up-bracket":"minimize-animation-up-bracket-dKqC8zmq","minimize-animation-down-bracket":"minimize-animation-down-bracket-dKqC8zmq",up:"up-dKqC8zmq","up-animation":"up-animation-dKqC8zmq",down:"down-dKqC8zmq","down-animation":"down-animation-dKqC8zmq",buttonsWrapper:"buttonsWrapper-dKqC8zmq"}},262927:e=>{e.exports={blockHidden:"blockHidden-Cky0LHBF","pane-button":"pane-button-Cky0LHBF"}},811481:(e,t,i)=>{"use strict";i.r(t),i.d(t,{ControlBarNavigation:()=>Z});var s=i(650151),l=i(777754),o=i(778785),n=i(87476),a=i(387226),r=i(768038),d=i(878134),u=i(604286),h=i(638456),c=i(470316),p=i(345848),_=i(850775),m=i(247424),g=i(94881),v=i(715741),b=i(588398),w=i(670340),y=i(549483),S=i(50119),f=i(362884),M=i(250662),C=i(542205),E=i(303106),V=i(978360);i(149021);const x=(0,c.humanReadableModifiers)(c.Modifiers.Alt,!1),T=(0,c.humanReadableModifiers)(c.Modifiers.Shift,!1),P=(0,c.humanReadableModifiers)(c.Modifiers.Mod,!1),k=(0,u.hotKeySerialize)({keys:[x,"R"],text:"{0} + {1}"}),L=(0,u.hotKeySerialize)({keys:[x,"Click",x,"Enter"],text:"{0} + {1}, {2} + {3}"}),A=(0,u.hotKeySerialize)({keys:[S],text:"{0}"}),W=(0,u.hotKeySerialize)({keys:[f],text:"{0}"}),H=(0,u.hotKeySerialize)({keys:[P,M],text:"{0} + {1}"}),B=(0,u.hotKeySerialize)({keys:[P,C],text:"{0} + {1}"}),D=(0,u.hotKeySerialize)({keys:[x,T,f],text:"{0} + {1} + {2}"
}),z=l.t(null,void 0,i(247602)),I=l.t(null,void 0,i(461311)),N=l.t(null,void 0,i(256470)),O=l.t(null,void 0,i(48293)),R=l.t(null,void 0,i(540653)),G=l.t(null,void 0,i(135809)),F=l.t(null,void 0,i(834301)),q=l.t(null,void 0,i(426721)),j=`<div class="control-bar-wrapper">\n\t<div class="control-bar control-bar--hidden">\n\t\t<div class="control-bar__group js-btn-group js-btn-group-zoom">\n\t\t\t<div class="control-bar__btn control-bar__btn--zoom-out apply-common-tooltip" title="${z}" data-tooltip-hotkey="${B}">\n\t\t\t\t${g}\n\t\t\t</div>\n\t\t\t<div class="control-bar__btn control-bar__btn--zoom-in apply-common-tooltip" title="${I}" data-tooltip-hotkey="${H}">\n\t\t\t\t${b}\n\t\t\t</div>\n\t\t</div>\n\t\t<div class="control-bar__group js-btn-group js-btn-group-maximize">\n\t\t\t<div class="control-bar__btn control-bar__btn--maximize apply-common-tooltip" title="${N}" data-tooltip-hotkey="${L}">\n\t\t\t\t${E}\n\t\t\t</div>\n\t\t\t<div class="control-bar__btn control-bar__btn--minimize js-hidden apply-common-tooltip" title="${O}" data-tooltip-hotkey="${L}">\n\t\t\t\t${V}\n\t\t\t</div>\n\t\t</div>\n\t\t<div class="control-bar__group js-btn-group js-btn-group-scroll">\n\t\t\t<div class="control-bar__btn control-bar__btn--move-left apply-common-tooltip" title="${R}" data-tooltip-hotkey="${A}">\n\t\t\t\t${m}\n\t\t\t</div>\n\t\t\t<div class="control-bar__btn control-bar__btn--move-right apply-common-tooltip" title="${G}" data-tooltip-hotkey="${W}">\n\t\t\t\t${w}\n\t\t\t</div>\n\t\t</div>\n\t\t<div class="control-bar__group js-btn-group js-btn-group-reset-scale">\n\t\t\t<div class="control-bar__btn control-bar__btn--turn-button control-bar__btn--btn-hidden apply-common-tooltip js-btn-reset" title="${F}" data-tooltip-hotkey="${k}">\n\t\t\t\t${v}\n\t\t\t</div>\n\t\t</div>\n\t</div>\n</div>`,U=`<div class="control-bar control-bar__btn control-bar__btn--back-present control-bar__btn--btn-hidden apply-common-tooltip" title="${q}" data-tooltip-hotkey="${D}">\n\t${y}\n</div>`,$=h.CheckMobile.any(),K="control-bar__btn--btn-hidden",Y={zoomInOut:!0,maximize:!0,scrollLeftRight:!0,resetScale:!0,goToRealtime:!0};class Z{constructor(e,t,i){this._widget=(0,s.ensureNotNull)((0,d.parseHtml)(j).querySelector(".control-bar-wrapper")),this._controlBar=(0,s.ensureNotNull)(this._widget.querySelector(".control-bar")),this._back=(0,s.ensureNotNull)((0,d.parseHtml)(U).querySelector(".control-bar__btn--back-present")),this._btnGroups=Array.from(this._controlBar.querySelectorAll(".js-btn-group")),this._backButtonVisible=!1,this._boundMouseHandler=null,this._chartModel=null,this._checkIntervalId=0,this._controlBarVisible=!1,this._priceAxisChanged=null,this._resetAvailabilityChanged=null,this._priceAxisName="right",this._rafId=0,this._visibilityTypeProperty=null,this._boundUpdateMaximizeButtonsVisibility=this._updateMaximizeButtonsVisibility.bind(this),this._boundToggleFullscreenButtons=this._toggleFullscreenButtons.bind(this),this._paneWidth=0,this._leftPriceScaleWidth=0,this._rightPriceScaleWidth=0,this._chart=e,this._parent=t,
this._options=Object.assign({},Y,i),this._visibilityPrioritizedGroups=this._initGroupDescriptions(),this._init(),this._initHandlers(),this.updatePosition()}destroy(){if(null!==this._visibilityTypeProperty&&(this._visibilityTypeProperty.unsubscribe(this,this._onVisibilityTypeChange),this._visibilityTypeProperty=null),null!==this._boundMouseHandler&&(this._parent.removeEventListener("mousemove",this._boundMouseHandler,!1),this._parent.removeEventListener("mouseleave",this._boundMouseHandler,!1),this._boundMouseHandler=null),null!==this._priceAxisChanged&&(this._priceAxisChanged.unsubscribe(this,this._updateBackBtnPosition),this._priceAxisChanged=null),clearInterval(this._checkIntervalId),null!==this._resetAvailabilityChanged){this._resetAvailabilityChanged.unsubscribe(this,this._updateResetScalesButtonVisibility);const e=this._chart.getResizerDetacher();e.fullscreenable.unsubscribe(this._boundUpdateMaximizeButtonsVisibility),e.fullscreen.unsubscribe(this._boundToggleFullscreenButtons),this._resetAvailabilityChanged=null}this._chart=null}updatePosition(){const e=this._chart.paneWidgets();if(0===e.length)return;this._paneWidth=e[0].width(),this._leftPriceScaleWidth=this._chart.getPriceAxisMaxWidthByName("left"),this._rightPriceScaleWidth=this._chart.getPriceAxisMaxWidthByName("right");const t=this._chart.timeAxisHeight()+this._bottomMargin();this._widget.style.bottom=`${t}px`,this._back.style.bottom=`${t}px`,this._updateBtnGroupVisibility()}_bottomMargin(){var e;const t=this._chart.paneWidgets();return(null!==(e=this._chart.maximizedPaneWidget())&&void 0!==e?e:t[t.length-1]).containsMainSeries()?32:5}_init(){if(h.CheckMobile.any())for(const e of this._btnGroups)e.classList.add("js-hidden");this._buttons={zoomIn:this._widget.querySelector(".control-bar__btn--zoom-in"),zoomOut:this._widget.querySelector(".control-bar__btn--zoom-out"),moveLeft:this._widget.querySelector(".control-bar__btn--move-left"),moveRight:this._widget.querySelector(".control-bar__btn--move-right"),turn:this._widget.querySelector(".control-bar__btn--turn-button"),maximize:this._widget.querySelector(".control-bar__btn--maximize"),minimize:this._widget.querySelector(".control-bar__btn--minimize")},this._initVisibility(),this._parent.appendChild(this._widget),this._parent.appendChild(this._back),this._backButtonVisible=!1,this._priceAxisName=(0,r.isRtl)()?"left":"right",this._chart.withModel(this,(()=>{this._chartModel=this._chart.model(),this._priceAxisChanged=this._chart.getPriceAxisWidthChangedByName(this._priceAxisName),this._resetAvailabilityChanged=this._chartModel.model().isScalesResetAvailableChanged(),this._priceAxisChanged.subscribe(this,this._updateBackBtnPosition),this._resetAvailabilityChanged.subscribe(this,this._updateResetScalesButtonVisibility);const e=this._chart.getResizerDetacher();e.fullscreenable.subscribe(this._boundUpdateMaximizeButtonsVisibility),e.fullscreen.subscribe(this._boundToggleFullscreenButtons),this._updateMaximizeButtonsVisibility(),this._updateBackBtnPosition(),this._back.addEventListener("click",(()=>{
null!==this._chartModel&&this._chartModel.timeScale().scrollToRealtime(!0)})),this._checkIntervalId=setInterval((()=>this._check()),1e3)}))}_initHandlers(){const e=o.mobiletouch?"touchstart":"mousedown",t=o.mobiletouch?["touchend"]:["mouseup","mouseout"];this._buttons.moveLeft.addEventListener(e,(e=>{e.preventDefault(),this._chart.scrollHelper().moveByBar(1),this._trackEvent("Move Left")})),this._buttons.moveRight.addEventListener(e,(e=>{e.preventDefault(),this._chart.scrollHelper().moveByBar(-1),this._trackEvent("Move Right")}));for(const e of t)this._buttons.moveLeft.addEventListener(e,(()=>this._chart.scrollHelper().stopMoveByBar())),this._buttons.moveRight.addEventListener(e,(()=>this._chart.scrollHelper().stopMoveByBar()));this._buttons.turn.addEventListener("click",(e=>{e.preventDefault(),this._chart.GUIResetScales(),this._trackEvent("Reset to Default Settings")})),this._buttons.zoomOut.addEventListener("click",(e=>{e.preventDefault(),null!==this._chartModel&&this._chartModel.zoomOut(),this._trackEvent("Zoom Out")})),this._buttons.zoomIn.addEventListener("click",(e=>{e.preventDefault(),null!==this._chartModel&&this._chartModel.zoomIn(),this._trackEvent("Zoom In")})),this._buttons.maximize.addEventListener("click",(e=>{e.preventDefault(),this._chart.setActive(!0),this._chart.getResizerDetacher().requestFullscreen(),this._trackEvent(" Maximize Chart")})),this._buttons.minimize.addEventListener("click",(e=>{e.preventDefault(),this._chart.getResizerDetacher().exitFullscreen(),this._trackEvent(" Restore Chart")}));const i=e=>e.addEventListener("contextmenu",(e=>e.preventDefault()));i(this._buttons.moveLeft),i(this._buttons.moveRight),i(this._buttons.turn),i(this._buttons.zoomOut),i(this._buttons.zoomIn),i(this._buttons.minimize),i(this._buttons.maximize)}_initGroupDescriptions(){return[{shouldBeHiddenOnMobile:!1,available:this._isMaximizeButtonAvailable.bind(this),className:"js-btn-group-maximize",element:this._getBtnGroup("js-btn-group-maximize"),totalWidth:50},{shouldBeHiddenOnMobile:!1,available:()=>this._options.resetScale,className:"js-btn-group-reset-scale",element:this._getBtnGroup("js-btn-group-reset-scale"),totalWidth:50},{shouldBeHiddenOnMobile:!n.enabled("show_zoom_and_move_buttons_on_touch"),available:()=>this._options.zoomInOut,className:"js-btn-group-zoom",element:this._getBtnGroup("js-btn-group-zoom"),totalWidth:86},{shouldBeHiddenOnMobile:!n.enabled("show_zoom_and_move_buttons_on_touch"),available:()=>this._options.scrollLeftRight,className:"js-btn-group-scroll",element:this._getBtnGroup("js-btn-group-scroll"),totalWidth:86}]}_check(){if(null===this._chartModel||!this._options.goToRealtime)return;const e=this._chartModel.timeScale().rightOffset()<0;e!==this._backButtonVisible&&(this._backButtonVisible=e,this._back.classList.toggle(K,!this._backButtonVisible))}_initVisibility(){this._visibilityTypeProperty=(0,a.actualBehavior)(),this._visibilityTypeProperty.subscribe(this,this._onVisibilityTypeChange),this._onVisibilityTypeChange()}_onVisibilityTypeChange(){
if(null===this._visibilityTypeProperty)return;const e=this._visibilityTypeProperty.value();"alwaysOn"===e||"alwaysOff"===e?(this._controlBarVisible="alwaysOn"===e,null!==this._boundMouseHandler&&(this._parent.removeEventListener("mousemove",this._boundMouseHandler,!1),this._parent.removeEventListener("mouseleave",this._boundMouseHandler,!1),this._boundMouseHandler=null)):(this._controlBarVisible=!1,this._boundMouseHandler||(this._boundMouseHandler=this._visibilityMouseHandler.bind(this),this._parent.addEventListener("mousemove",this._boundMouseHandler),this._parent.addEventListener("mouseleave",this._boundMouseHandler))),this._updateControlBarVisibility()}_visibilityMouseHandler(e){if(e.buttons)return;if(null!==this._chartModel&&this._chartModel.lineBeingCreated())return;let t="mouseleave"!==e.type;if("mousemove"===e.type){const i=this._widget.getBoundingClientRect(),s=100-this._bottomMargin();t=e.clientX>=i.left-100&&e.clientX<=i.right+100&&e.clientY>=i.top-s&&e.clientY<=i.bottom+100}this._controlBarVisible!==t&&(this._controlBarVisible=t,null===this._rafId&&(this._rafId=this._controlBar.ownerDocument.defaultView.requestAnimationFrame(this._updateControlBarVisibility.bind(this))))}_updateControlBarVisibility(){this._rafId=null,this._controlBar.classList.toggle("control-bar--hidden",!this._controlBarVisible)}_updateBackBtnPosition(){if("left"===this._priceAxisName||"right"===this._priceAxisName){const e=this._chart.getPriceAxisMaxWidthByName(this._priceAxisName)+14;e&&(this._back.style.marginRight=`${e}px`)}}_updateBtnGroupVisibility(){const e=this._leftPriceScaleWidth+this._paneWidth,t=(e+this._rightPriceScaleWidth)/2;let i=2*Math.min(e-t,t-this._leftPriceScaleWidth)-50-50,s=!1;for(const e of this._visibilityPrioritizedGroups){e.enoughSpaceForGroup=!1;e.available()&&(!$||!e.shouldBeHiddenOnMobile)&&(i-=e.totalWidth,e.enoughSpaceForGroup=i>=0&&!s,s=s||!e.enoughSpaceForGroup),!e.enoughSpaceForGroup!==e.element.classList.contains("js-hidden")&&e.element.classList.toggle("js-hidden",!e.enoughSpaceForGroup)}this._updateControlBarPosition()}_getBtnGroup(e){return(0,s.ensureDefined)(this._btnGroups.find((t=>t.classList.contains(e))))}_updateControlBarPosition(){const e=this._visibilityPrioritizedGroups.reduce(((e,t)=>e+(t.enoughSpaceForGroup?t.totalWidth:0)),0),t=(this._paneWidth+this._leftPriceScaleWidth+this._rightPriceScaleWidth)/2-Math.ceil(e/2);this._widget.style.left=`${t}px`}_updateResetScalesButtonVisibility(){if(null===this._chartModel)return;const e=this._chartModel.model().isScalesResetAvailable();this._buttons.turn.classList.toggle(K,!e)}_updateMaximizeButtonsVisibility(){this._updateBtnGroupVisibility()}_toggleFullscreenButtons(){const e=this._chart.getResizerDetacher().fullscreen.value();this._buttons.maximize.classList.toggle("js-hidden",e),this._buttons.minimize.classList.toggle("js-hidden",!e)}_isMaximizeButtonAvailable(){return!!this._options.maximize&&(!!this._chart.getResizerDetacher().fullscreenable.value()&&!_.mediaState.isPhoneSizeDevice())}_trackEvent(e){this._chart.onWidget()||(0,
p.trackEvent)("Navigation button",e)}}},838718:(e,t,i)=>{"use strict";i.r(t),i.d(t,{LegendWidget:()=>ms});var s=i(327714),l=i(650151),o=i(988411),n=i.n(o),a=i(758337),r=i(724377),d=i(87476),u=i(638456),h=i(569421),c=i(159255),p=i(473795),_=i(495028),m=i(196726),g=i(262927);var v=i(818940);class b extends class{constructor(e,t={}){this._loadingEl=document.createElement("span"),this._renderLoading(t),this.toggleVisibility(!1),e.appendChild(this._loadingEl)}toggleVisibility(e){this._loadingEl.classList.toggle(g.blockHidden,!e)}_renderLoading(e){const{className:t}=e;t&&this._loadingEl.classList.add(t)}}{_renderLoading(e){super._renderLoading(e),this._loadingEl.innerHTML=`\n\t\t\t<span class="${v.loaderItem}"></span>\n\t\t\t<span class="${v.loaderItem}"></span>\n\t\t\t<span class="${v.loaderItem}"></span>\n\t\t`,this._loadingEl.classList.add(v.loader)}}function w(e,t){null===e.firstChild?e.textContent=t:e.firstChild.nodeValue=t}var y=i(824317),S=i(839653);const f=u.CheckMobile.any();class M{constructor(e,t,i){this._el=null,this._firstBlockWrapper=null,this._titleParentEl=null,this._titleElements=[],this._valuesParentEl=null,this._valuesAdditionalWrapperEl=null,this._valuesElements=[],this._actionsParentEl=null,this._actionAdditionalWrapperEl=null,this._stayInHoveredMode=!1,this._mode=4,this._statusesWrapper=null,this._resizeObserver=null,this._hideInvisibleHover=null,this._hideValues=null,this._allButtonsWidth=null,this._lastStatusesWrapperWidth=null,this._lastActionsWrapperWidth=null,this._showActionsHandler=null,this._hideActionsHandler=null,this._selectedSourceHandler=null,this._mouseEventHandlers=[],this._disableTimeout=null,this._loader=null,this._updateDisabledState=(e=this._disabled.value())=>{null!==this._el&&(this._el.classList.toggle(S.disabled,e),this._updateLoadingState(),this._updateStatusWidgetVisibility(e),this._updateTitleMaxWidth())},this._updateLoadingState=(e=this._loading.value())=>{if(null!==this._el){const t=this._el.classList;t.toggle(S.eyeLoading,e&&!this._disabled.value()),t.toggle(S.loading,e)}null!==this._loader&&this._loader.toggleVisibility(e)},this._model=e,this._parentEl=t,this._disabled=this._model.disabled().spawn(),this._disabled.subscribe(this._updateDisabledState),this._disabledOnInterval=this._model.disabledOnInterval().spawn(),this._disabledOnInterval.subscribe(this._updateDisabledOnIntervalState.bind(this)),this._selected=this._model.selected().spawn(),this._selected.subscribe(this._updateSelectedState.bind(this)),this._loading=this._model.loading().spawn(),this._loading.subscribe(function(e,t){let i=0;return s=>{clearTimeout(i),s?e():i=setTimeout(e,t)}}(this._updateLoadingState,700)),this._isTitleHidden=this._model.isTitleHidden().spawn(),this._isValuesHidden=this._model.isValuesHidden().spawn(),this._isRowHidden=this._model.isRowHidden().spawn(),this._isTitleHidden.subscribe(this._updateShowTitles.bind(this)),this._isValuesHidden.subscribe(this._updateShowValues.bind(this)),this._isRowHidden.subscribe(this._updateShowLine.bind(this)),this._createTitlesSpawns()
;for(let e=0;e<this._titlesSpawns.length;e++)this._titlesSpawns[e].title.subscribe(this._updateTitlesHandler.bind(this,e));this._values=this._model.values().spawn(),this._values.subscribe(this._updateValues.bind(this)),this._createValuesSpawns(),this._addValuesSpawnsSubscriptions(),this._actionsSpawnArray=this._model.actions().map((e=>({visible:e.visible.spawn(),title:void 0===e.title?null:e.title.spawn()})));for(let e=0;e<this._actionsSpawnArray.length;e++){this._actionsSpawnArray[e].visible.subscribe(this._updateActionVisibilities.bind(this,e));const t=this._actionsSpawnArray[e].title;null!==t&&t.subscribe(this._updateActionTitle.bind(this,e))}this._withActions=i.withActions,this._render(),this._updateStates(),this._updateShowTitles(),this._updateShowValues(),this._updateShowLine(),null!==this._valuesParentEl&&(this._loader=new b(this._valuesParentEl,{className:S.loader})),this._customTextColor=i.customTextColor.spawn(),this._customTextColor.subscribe(this._updateCustomTextColor.bind(this)),this._updateCustomTextColor(),this._withActions&&(this._showActionsHandler=(0,m.wrapHandlerWithPreventEvent)(this._showActions.bind(this)),this._hideActionsHandler=(0,m.wrapHandlerWithPreventEvent)(this._hideActions.bind(this)),this._selectedSourceHandler=(0,m.wrapHandlerWithPreventEvent)(this._model.setSourceSelected.bind(this._model)),null!==this._titleParentEl&&(this._titleParentEl.addEventListener("touchend",this._selectedSourceHandler),this._titleParentEl.addEventListener("mousedown",this._selectedSourceHandler),f||(this._titleParentEl.addEventListener("mouseenter",this._showActionsHandler),this._titleParentEl.addEventListener("mouseleave",this._hideActionsHandler)),this._mouseEventHandlers.push(new _.MouseEventHandler(this._titleParentEl,{mouseDoubleClickEvent:this._model.onShowSettings.bind(this._model),doubleTapEvent:this._model.onShowSettings.bind(this._model)}))),null===this._actionAdditionalWrapperEl||null===this._actionsParentEl||f||(this._actionAdditionalWrapperEl.addEventListener("mouseenter",this._showActionsHandler),this._actionAdditionalWrapperEl.addEventListener("mouseleave",this._hideActionsHandler),this._actionsParentEl.addEventListener("contextmenu",(e=>{e.preventDefault(),e.stopPropagation()}))))}destroy(){var e,t;this._disabled.destroy(),this._disabledOnInterval.destroy(),this._selected.destroy(),this._loading.destroy(),this._isTitleHidden.destroy(),this._isValuesHidden.destroy(),this._isRowHidden.destroy(),this._customTextColor.destroy(),null!==this._disableTimeout&&clearTimeout(this._disableTimeout);for(const e of this._titlesSpawns)e.title.destroy();if(null!==this._titleParentEl){for(const e of this._mouseEventHandlers)e.destroy();this._titleElements=[],this._withActions&&null!==this._selectedSourceHandler&&null!==this._showActionsHandler&&null!==this._hideActionsHandler&&(this._titleParentEl.removeEventListener("touchend",this._selectedSourceHandler),this._titleParentEl.removeEventListener("mousedown",this._selectedSourceHandler),
f||(this._titleParentEl.removeEventListener("mouseenter",this._showActionsHandler),this._titleParentEl.removeEventListener("mouseleave",this._hideActionsHandler))),this._titleParentEl=null}for(const e of this._actionsSpawnArray){e.visible.destroy();const t=e.title;null!==t&&t.destroy()}if(null!==this._actionAdditionalWrapperEl&&(this._withActions&&null!==this._showActionsHandler&&null!==this._hideActionsHandler&&!f&&(this._actionAdditionalWrapperEl.removeEventListener("mouseenter",this._showActionsHandler),this._actionAdditionalWrapperEl.removeEventListener("mouseleave",this._hideActionsHandler)),this._actionAdditionalWrapperEl=null),this._actionsParentEl=null,this._removeValuesSpawnsSubscriptions(),this._values.destroy(),null!==this._valuesParentEl&&(this._valuesElements=[],this._valuesParentEl=null),null===(e=this._hideInvisibleHover)||void 0===e||e.destroy(),null===(t=this._hideValues)||void 0===t||t.destroy(),null!==this._resizeObserver&&(this._resizeObserver.disconnect(),this._resizeObserver=null),null!==this._el){(0,l.ensureNotNull)(this._el.parentNode).removeChild(this._el),this._el=null}}getHeight(){return null===this._el?null:24}updateMode(e){this._mode===e&&null!==this._allButtonsWidth||(this._mode=e,this._updateAllButtonsWidth())}_render(){this._renderTitle(),this._renderActions(),this._renderValues(),this._el=document.createElement("div"),this._firstBlockWrapper=document.createElement("div"),this._firstBlockWrapper.classList.add(S.noWrapWrapper),this._firstBlockWrapper.appendChild((0,l.ensureNotNull)(this._titleParentEl)),null!==this._actionsParentEl&&this._firstBlockWrapper.appendChild(this._actionsParentEl),this._el.appendChild(this._firstBlockWrapper),this._el.appendChild((0,l.ensureNotNull)(this._valuesParentEl)),this._parentEl.append(this._el)}_renderTitle(){null===this._titleParentEl&&(this._titleParentEl=document.createElement("div"),this._titleParentEl.classList.add(S.titleWrapper));const e=this._titleParentEl;for(let t=0;t<this._titlesSpawns.length;t++){const i=this._titlesSpawns[t].title.value(),s=this._titlesSpawns[t].class,l=document.createElement("div");l.classList.add(S.title,s,"apply-overflow-tooltip"),l.dataset.name="legend-source-title",i.length>0?(l.appendChild(document.createTextNode(i)),l.classList.add(S.withDot)):l.classList.add(g.blockHidden),e.appendChild(l),this._titleElements.push(l)}}_renderActions(){if(!this._withActions)return;null===this._actionsParentEl&&(this._actionsParentEl=document.createElement("div"),this._actionsParentEl.classList.add(S.buttonsWrapper),this._parentEl.append(this._actionsParentEl),this._actionAdditionalWrapperEl=document.createElement("div"),this._actionAdditionalWrapperEl.classList.add(S.buttons),this._actionsParentEl.appendChild(this._actionAdditionalWrapperEl));const e=(0,l.ensureNotNull)(this._actionAdditionalWrapperEl),t=h.trackingModeIsAvailable?"large":"small";for(const i of this._model.actions()){const s=(0,p.createActionElement)(i,S.button,S.buttonIcon,g.blockHidden,t);e.appendChild(s)}}_isWidthButtonsMode(){
return null!==this._el&&(this._el.classList.contains(S.withAction)||this._disabled.value()||this._selected.value()||this._stayInHoveredMode)}_updateTitlesHandler(e,t){const i=(0,l.ensureNotNull)(this._titleElements[e]),s=0===t.length;i.classList.toggle(g.blockHidden,s),i.classList.toggle(S.withDot,!s),w(i,t=(0,y.redefineExchangeName)(t))}_updateStates(e){this._updateDisabledState(),this._updateDisabledOnIntervalState(),this._updateSelectedState(),this._updateLoadingState(),e&&this._clearDisableState()}_updateValuesHTMLElHandler(e,t){w((0,l.ensure)(this._valuesElements[e].value),t),this._updateShowValues()}_updateValueColorHandler(e,t=""){(0,l.ensure)(this._valuesElements[e].value).style.color=t}_updateValueVisibleHandler(e,t){const i=(0,l.ensure)(this._valuesElements[e].value).closest(`.${S.valueItem}`);null!==i&&i.classList.toggle(g.blockHidden,!t)}_updateShowLine(){null!==this._el&&this._el.classList.toggle(g.blockHidden,this._isRowHidden.value())}_createValuesSpawns(){this._valuesSpawnArray=this._values.value().map((e=>({value:e.value.spawn(),color:e.color.spawn(),visible:e.visible.spawn(),title:e.title.spawn()})))}_removeValuesSpawnsSubscriptions(){for(const e of this._valuesSpawnArray)e.value.destroy(),e.color.destroy(),e.visible.destroy(),e.title.destroy();this._valuesSpawnArray=[]}_addValuesSpawnsSubscriptions(){for(let e=0;e<this._valuesSpawnArray.length;e++){const t=this._valuesSpawnArray[e];t.value.subscribe(this._updateValuesHTMLElHandler.bind(this,e)),t.color.subscribe(this._updateValueColorHandler.bind(this,e)),t.visible.subscribe(this._updateValueVisibleHandler.bind(this,e)),t.title.subscribe(this._updateValuesTitleHTMLElHandler.bind(this,e))}}_updateShowValues(){null!==this._valuesAdditionalWrapperEl&&this._valuesAdditionalWrapperEl.classList.toggle(g.blockHidden,this._isValuesShouldBeHidden())}_isValuesShouldBeHidden(){return!this._valuesSpawnArray.some((e=>e.value.value().length>0))}_addStatusesWidget(e,t,i){this._statusesWrapper=document.createElement("div"),this._statusesWrapper.classList.add(S.statusesWrapper),this._statusesWrapper.appendChild(e),(0,l.ensureNotNull)(this._firstBlockWrapper).appendChild(this._statusesWrapper),this._hideInvisibleHover=t.spawn(),this._hideInvisibleHover.subscribe(this._updateInvisibleHoverMode.bind(this),{callWithLast:!0}),this._hideValues=i.spawn(),this._hideValues.subscribe(this._updateHideValuesMode.bind(this),{callWithLast:!0}),this._updateStatusWidgetVisibility(this._disabled.value()),this._resizeObserver=new c.default(this._handlerRestrictTitleWidth.bind(this)),null!==this._actionsParentEl&&this._resizeObserver.observe(this._actionsParentEl),this._resizeObserver.observe(this._statusesWrapper)}_updateTitleMaxWidth(){if(null===this._firstBlockWrapper)return;const e=this._allButtonsWidth||0,t=(this._lastActionsWrapperWidth||0)+(this._lastStatusesWrapperWidth||0);this._isWidthButtonsMode()?this._firstBlockWrapper.style.maxWidth=`calc(100% - ${Math.max(e,t)}px)`:this._firstBlockWrapper.style.maxWidth=t>0?`calc(100% - ${t}px)`:""}_updateAllButtonsWidth(){
this._allButtonsWidth=this._getButtonsCount()*R+1,this._updateTitleMaxWidth()}_updateInvisibleHoverMode(e){null!==this._el&&this._el.classList.toggle(S.invisibleHover,!e)}_updateHideValuesMode(e){null!==this._el&&this._el.classList.toggle(S.hideValues,e)}_showActions(){if(null===this._el||!this._withActions)return;this._el.classList.add(S.withAction);const e=null!==this._valuesParentEl&&null!==this._titleParentEl&&this._valuesParentEl.offsetTop===this._titleParentEl.offsetTop;this._el.classList.toggle(S.withTail,e),this._updateTitleMaxWidth()}_hideActions(){null!==this._el&&this._withActions&&!this._stayInHoveredMode&&(this._el.classList.remove(S.withAction),null!==this._valuesParentEl&&this._valuesParentEl.classList.remove(S.withTail),this._updateTitleMaxWidth())}_handlerRestrictTitleWidth(e){if(null===this._actionsParentEl||null===this._firstBlockWrapper)return;let t=null,i=null;for(const s of e)s.target===this._statusesWrapper&&(t=s.contentRect.width),s.target===this._actionsParentEl&&(i=s.contentRect.width);t===this._lastStatusesWrapperWidth&&i===this._lastActionsWrapperWidth||(null!==t&&(this._lastStatusesWrapperWidth=t),null!==i&&(this._lastActionsWrapperWidth=i),this._updateTitleMaxWidth())}_clearDisableState(){null!==this._el&&(this._el.classList.remove(S.eyeLoading),this._el.classList.remove(S.disabled),this._updateStatusWidgetVisibility(this._disabled.value()),this._updateTitleMaxWidth())}_updateDisabledOnIntervalState(){var e;null===(e=this._el)||void 0===e||e.classList.toggle(S.disabledOnInterval,this._disabledOnInterval.value())}_updateSelectedState(){null!==this._el&&this._withActions&&this._el.classList.toggle(S.selected,this._selected.value())}_updateShowTitles(){null!==this._titleParentEl&&(this._titleParentEl.classList.toggle(g.blockHidden,this._isTitleHidden.value()),null!==this._actionsParentEl&&this._actionsParentEl.classList.toggle(g.blockHidden,this._isTitleHidden.value()))}_updateValues(){this._removeValuesSpawnsSubscriptions(),this._createValuesSpawns(),null!==this._valuesParentEl&&null!==this._valuesAdditionalWrapperEl&&(this._valuesElements=[],this._valuesAdditionalWrapperEl.innerHTML=""),this._renderValues(),this._addValuesSpawnsSubscriptions(),this._updateShowValues()}_updateActionVisibilities(e){null!==this._actionsParentEl&&this._actionsParentEl.querySelectorAll(`.${S.button}`)[e].classList.toggle(g.blockHidden,!this._actionsSpawnArray[e].visible.value())}_updateActionTitle(e){const t=this._actionsSpawnArray[e].title;null!==this._actionsParentEl&&null!==t&&this._actionsParentEl.querySelectorAll(`.${S.button}`)[e].setAttribute("title",t.value())}_updateCustomTextColor(){const e=this._customTextColor.value()||"";for(const t of this._titleElements)null!==t&&(t.style.color=e);const t=(0,l.ensureNotNull)(this._valuesParentEl).querySelectorAll(`.${S.valueTitle}`);for(let i=0;i<t.length;i++)t[i].style.color=e;(0,l.ensureNotNull)(this._el).classList.toggle(S.withCustomTextColor,Boolean(e))}_updateStatusWidgetVisibility(e){
null!==this._statusesWrapper&&this._statusesWrapper.classList.toggle(g.blockHidden,e)}}class C extends M{constructor(e,t,i){super(e,t,i),this._clientHeight=null,this._flagged=this._model.flagged().spawn(),this._flagged.subscribe(this._updateFlaggedState.bind(this)),this._updateStates(),i.statusWidgetEl&&this._addStatusesWidget(i.statusWidgetEl,i.hideInvisibleHover,i.hideValues),this._selected.subscribe(this._updateTitleMaxWidth.bind(this))}destroy(){super.destroy(),void 0!==this._flagged&&this._flagged.destroy()}getHeight(){return null===this._el?null:(null===this._clientHeight&&(this._clientHeight=this._el.clientHeight,0===this._clientHeight&&(this._clientHeight=null)),this._clientHeight)}_getButtonsCount(){return 1===this._mode?1:3}_render(){super._render();const e=(0,l.ensureNotNull)(this._el);e.classList.add(S.item,S.series),e.classList.toggle(S.onlyOneButtonCanBeStick,this._model.isOneButtonCanBeStick()),e.dataset.name="legend-series-item"}_updateStates(){super._updateStates(),this._updateFlaggedState()}_renderValues(){null===this._valuesParentEl&&(this._valuesParentEl=document.createElement("div"),this._valuesParentEl.classList.add(S.valuesWrapper),this._valuesAdditionalWrapperEl=document.createElement("div"),this._valuesAdditionalWrapperEl.classList.add(S.valuesAdditionalWrapper),this._valuesParentEl.appendChild(this._valuesAdditionalWrapperEl));const e=(0,l.ensureNotNull)(this._valuesAdditionalWrapperEl),t=this._values.value();for(const i of t){const t=document.createElement("div");t.classList.add(S.valueItem),t.classList.toggle(g.blockHidden,!i.visible.value()),t.classList.toggle(S.unimportant,i.unimportant.value());const s=document.createElement("div"),l=i.title.value()||"";s.classList.add(S.valueTitle),s.classList.toggle(g.blockHidden,0===l.length),s.appendChild(document.createTextNode(l)),t.appendChild(s);const o=document.createElement("div");o.classList.add(S.valueValue),o.style.color=i.color.value()||"",o.appendChild(document.createTextNode(i.value.value())),t.appendChild(o),this._valuesElements.push({title:s,value:o}),e.appendChild(t)}}_createTitlesSpawns(){const e=this._model.titles();this._titlesSpawns=[{title:e.title.spawn(),class:S.mainTitle},{title:e.description.spawn(),class:S.descTitle},{title:e.interval.spawn(),class:S.intervalTitle},{title:e.provider.spawn(),class:S.providerTitle},{title:e.exchange.spawn(),class:S.exchangeTitle},{title:e.chartStyle.spawn(),class:S.styleTitle}]}_isValuesShouldBeHidden(){return!this._valuesSpawnArray.some((e=>e.value.value().length>0||(e.title.value()||"").length>0))}_updateValuesTitleHTMLElHandler(e,t=""){const i=(0,l.ensure)(this._valuesElements[e].title);w(i,t),i.classList.toggle(g.blockHidden,0===t.length),this._updateShowValues()}_isWidthButtonsMode(){return null!==this._el&&(void 0!==this._flagged&&Boolean(this._flagged.value())||super._isWidthButtonsMode())}_updateFlaggedState(){if(void 0===this._flagged)return;(0,l.ensureNotNull)(this._el).classList.toggle(S.flagged,Boolean(this._flagged.value())),this._updateTitleMaxWidth()}}
const E=u.isSafari?"click":"auxclick";class V extends M{constructor(e,t,i){super(e,t,i),this._wheelClickHandler=null,this._canUpdateRowVisibility=!0,this._globalRowVisibility=this._model.globalVisibility().spawn(),this._globalRowVisibility.subscribe(this._updateShowLine.bind(this),{callWithLast:!0}),this._has5Buttons=this._model.isPineScriptDataSource().spawn(),this._has5Buttons.subscribe(this._update5ButtonsStyles.bind(this)),this._updateStates(!this._disabled.value()),i.statusWidgetEl&&this._addStatusesWidget(i.statusWidgetEl,i.hideInvisibleHover,i.hideValues),this._selected.subscribe(this._updateTitleMaxWidth.bind(this)),i.withActions&&(this._wheelClickHandler=this._onWheelClicked.bind(this),null!==this._titleParentEl&&this._titleParentEl.addEventListener(E,this._wheelClickHandler))}destroy(){super.destroy(),this._has5Buttons.destroy(),this._globalRowVisibility&&this._globalRowVisibility.destroy(),null!==this._wheelClickHandler&&null!==this._titleParentEl&&this._titleParentEl.removeEventListener(E,this._wheelClickHandler)}_updateShowLine(){if(null===this._el||!this._canUpdateRowVisibility)return;const e=!this._globalRowVisibility.value();e?this._el.classList.toggle(g.blockHidden,e):super._updateShowLine()}_getButtonsCount(){switch(this._mode){case 4:return this._has5Buttons.value()?5:4;case 3:return 3;default:return 2}}_render(){super._render();const e=(0,l.ensureNotNull)(this._el);e.classList.add(S.item,S.study),e.dataset.name="legend-source-item"}_createTitlesSpawns(){const e=this._model.titles();this._titlesSpawns=[{title:e.title.spawn(),class:S.mainTitle},{title:e.args.spawn(),class:S.descTitle}]}_renderValues(){null===this._valuesParentEl&&(this._valuesParentEl=document.createElement("div"),this._valuesParentEl.classList.add(S.valuesWrapper),this._valuesAdditionalWrapperEl=document.createElement("div"),this._valuesAdditionalWrapperEl.classList.add(S.valuesAdditionalWrapper),this._valuesParentEl.appendChild(this._valuesAdditionalWrapperEl));const e=(0,l.ensureNotNull)(this._valuesAdditionalWrapperEl),t=this._values.value();for(const i of t){const t=document.createElement("div");t.classList.add(S.valueItem),t.classList.toggle(g.blockHidden,!i.visible.value());const s=document.createElement("div");s.classList.add(S.valueValue),s.style.color=i.color.value()||"",s.appendChild(document.createTextNode(i.value.value()));const l=i.title.value();void 0!==l&&(s.classList.add("apply-common-tooltip"),s.title=l),t.appendChild(s),this._valuesElements.push({value:s}),e.appendChild(t)}}_updateValuesTitleHTMLElHandler(e,t=""){const i=(0,l.ensure)(this._valuesElements[e].value);i.classList.toggle("apply-common-tooltip",0!==t.length),i.title=t}_update5ButtonsStyles(e){null!==this._el&&(this._el.classList.toggle(S.has5Buttons,e),this._updateAllButtonsWidth())}_onWheelClicked(e){1===e.button&&this._model.onRemoveSource()}}var x=i(777754),T=i(345848);function P(e){(0,T.trackEvent)("GUI","Legend action",e)}var k=i(947036),L=i(662920),A=i(65300),W=i(736885)
;const H=x.t(null,void 0,i(721686)),B=x.t(null,void 0,i(328705)),D=x.t(null,void 0,i(551072));class z{constructor(e,t,i){this._el=null,this._counterEl=null,this._arrowIconEL=null,this._objectTreeEl=null,this._mode=0,this._parentEl=e,this._themedColor=t.spawn(),this._themedColor.subscribe(this._updateThemedColor.bind(this)),this._sourceCount=i.visibleDataSourceCount.spawn(),this._sourceCount.subscribe(this._updateSourceCount.bind(this)),this._isStateOpen=i.isDataSourcesCollapsed.spawn(),this._isStateOpen.subscribe(this._updateState.bind(this)),this._showObjectsTree=i.showObjectsTree.spawn(),this._showObjectsTree.subscribe(this._updateObjectTreeVisibility.bind(this)),this._render(),this._updateState(),this._updateThemedColor(this._themedColor.value()),this._updateObjectTreeVisibility(this._showObjectsTree.value()),this._toggleStateHandler=(0,m.wrapHandlerWithPreventEvent)(i.onCollapseDataSources),this._showObjectTreeHandler=(0,m.wrapHandlerWithPreventEvent)(i.onShowObjectsTreeDialog),null!==this._el&&(this._el.addEventListener("touchend",this._toggleStateHandler),this._el.addEventListener("click",this._toggleStateHandler),this._el.addEventListener("contextmenu",(e=>{e.preventDefault(),e.stopPropagation()}))),null!==this._objectTreeEl&&(this._objectTreeEl.addEventListener("touchend",this._showObjectTreeHandler),this._objectTreeEl.addEventListener("click",this._showObjectTreeHandler))}destroy(){this._sourceCount.destroy(),this._isStateOpen.destroy(),null!==this._objectTreeEl&&(this._objectTreeEl.removeEventListener("touchend",this._showObjectTreeHandler),this._objectTreeEl.removeEventListener("click",this._showObjectTreeHandler),this._objectTreeEl=null),this._arrowIconEL=null,this._counterEl=null,null!==this._el&&(this._el.removeEventListener("touchend",this._toggleStateHandler),this._el.removeEventListener("click",this._toggleStateHandler),this._el.innerHTML="",this._el=null)}setMode(e){this._mode=e?1:0,this._updateTooltip()}_render(){this._el=document.createElement("div"),this._el.className=`${S.toggler} apply-common-tooltip`,this._arrowIconEL=document.createElement("div"),this._arrowIconEL.classList.add(S.iconArrow),this._arrowIconEL.innerHTML=h.trackingModeIsAvailable?L:k,this._el.appendChild(this._arrowIconEL),this._objectTreeEl=document.createElement("div"),this._objectTreeEl.classList.add(S.objectTree),this._objectTreeEl.innerHTML=h.trackingModeIsAvailable?W:A,this._el.appendChild(this._objectTreeEl),this._counterEl=document.createElement("div"),this._counterEl.classList.add(S.counter),this._counterEl.appendChild(document.createTextNode(String(this._sourceCount.value()))),this._el.appendChild(this._counterEl),this._parentEl.appendChild(this._el)}_updateThemedColor(e){if(null!==this._el)if(e.length>0){const[t,i,s]=(0,r.parseRgb)(e);this._el.style.backgroundColor=(0,r.rgbaToString)([t,i,s,(0,r.normalizeAlphaComponent)(.8)])}else this._el.style.removeProperty("background-color")}_updateSourceCount(e){w((0,l.ensureNotNull)(this._counterEl),String(e));const t=(0,l.ensureNotNull)(this._el),i=e<1
;t.classList.toggle(g.blockHidden,i);const s=1===e;t.classList.toggle(S.onlyOneSourceShown,s)}_updateState(){const e=!this._isStateOpen.value();this._parentEl.classList.toggle(S.closed,e),this._updateTooltip(),P((e?"Hide":"Show")+" not main sources")}_tooltip(){return 1===this._mode?D:this._isStateOpen.value()?H:B}_updateTooltip(){null!==this._el&&this._el.setAttribute("title",this._tooltip())}_updateObjectTreeVisibility(e){(0,l.ensureNotNull)(this._el).classList.toggle(S.objectsTreeCanBeShown,e)}}var I=i(673747),N=i(314308);function O(e,t){const i=new(n())(t(e.value()));e.subscribe((e=>{i.setValue(t(e))}));return i.readonly().spawn((()=>e.unsubscribe()))}const R=h.trackingModeIsAvailable?44:28,G=d.enabled("object_tree_legend_mode");class F{constructor(e,t){this._renderToggler=null,this._mainDataSourceRenderer=null,this._dataSourceRenderers=[],this._parentEl=document.createElement("div"),this._mainDataSourceEl=null,this._dataSourcesEl=null,this._dataSourcesAdditionalWrapperEl=null,this._collapsedDataSourcesWrapperEl=null,this._collapsedDataSourcesEl=null,this._outsideEventForCollapsedTooltip=null,this._options=e,this._togglerOptions=t,this._isStudiesLegendHidden=e.isStudiesLegendHidden.spawn(),this._isStudiesLegendHidden.subscribe(this._updateLegendVisibility.bind(this)),this._isAllLegendHidden=e.isAllLegendHidden.spawn(),this._isAllLegendHidden.subscribe(this._updateLegendVisibility.bind(this)),this._updateLegendVisibility(),this._hideAllExceptFirstLine=e.hideAllExceptFirstLine.spawn(),this._hideAllExceptFirstLine.subscribe(this._updateAllHiddenExeptFirstLine.bind(this)),this._themedColor=e.themedColor.spawn(),this._themedColor.subscribe(this._setCustomBg.bind(this)),this._showBackground=e.showBackground.spawn(),this._showBackground.subscribe(this._setCustomBg.bind(this)),this._backgroundTransparency=e.backgroundTransparency.spawn(),this._backgroundTransparency.subscribe(this._setCustomBg.bind(this)),this._collapsedDataSourcesCountSpawn=e.collapsedDataSourcesCount.spawn(),this._collapsedDataSourcesCountSpawn.subscribe(this._updateCollapsedSourcesCount.bind(this)),this._showCollapsedDataSourcesTooltipHandler=this._showCollapsedDataSourcesTooltip.bind(this),this._parentEl.classList.add(S.legend),this._parentEl.classList.toggle(S.noWrap,!h.trackingModeIsAvailable),this._parentEl.classList.toggle(S.noActions,!this._options.withActions),this._parentEl.classList.toggle(S.touchMode,h.trackingModeIsAvailable),this._parentEl.classList.toggle(S.wrappable,!this._hideAllExceptFirstLine.value()),this._parentEl.dataset.name="legend",this._parentEl.style.setProperty("--legend-source-item-button-width",`${R}px`);const i=t=>{t.preventDefault(),e.showLegendWidgetContextMenu(t)};this._mouseEventHandler=new _.MouseEventHandler(this._parentEl,{contextMenuEvent:i,touchContextMenuEvent:i})}destroy(){if(this._isStudiesLegendHidden.destroy(),this._isAllLegendHidden.destroy(),this._hideAllExceptFirstLine.destroy(),this._themedColor.destroy(),this._showBackground.destroy(),this._backgroundTransparency.destroy(),
this._collapsedDataSourcesCountSpawn.destroy(),h.trackingModeIsAvailable&&null!==this._collapsedDataSourcesWrapperEl&&this._collapsedDataSourcesWrapperEl.removeEventListener("touchend",this._showCollapsedDataSourcesTooltipHandler),this._outsideEventForCollapsedTooltip&&this._outsideEventForCollapsedTooltip(),null!==this._dataSourcesAdditionalWrapperEl&&(this._dataSourcesAdditionalWrapperEl.innerHTML="",this._dataSourcesAdditionalWrapperEl=null),null!==this._dataSourcesEl&&(this._dataSourcesEl.innerHTML="",this._dataSourcesEl=null),null!==this._renderToggler&&(this._renderToggler.destroy(),this._renderToggler=null),null!==this._mainDataSourceRenderer&&(this._mainDataSourceRenderer.destroy(),this._mainDataSourceRenderer=null),0!==this._dataSourceRenderers.length){for(const e of this._dataSourceRenderers)e.destroy();this._dataSourceRenderers=[]}this._mouseEventHandler.destroy(),this._parentEl.innerHTML="",delete this._parentEl}addMainDataSource(e,t){this._renderMainDataSourceEl(),this._mainDataSourceRenderer=new C(e,(0,l.ensureNotNull)(this._mainDataSourceEl),{withActions:this._options.withActions,customTextColor:this._options.customTextColor,statusWidgetEl:t.getElement(),hideInvisibleHover:O(t.visibleWidgetsCount,(e=>Boolean(e))),hideValues:t.errorWidgetIsShown}),this._updateLegendVisibility(),e.onDestroy().subscribe(this,(()=>{null!==this._mainDataSourceRenderer&&(this._mainDataSourceRenderer.destroy(),this._mainDataSourceRenderer=null)}),!0)}addDataSources(e,t){this._renderDataSourcesEl();const i=(0,l.ensureNotNull)(this._dataSourcesAdditionalWrapperEl);for(let s=0;s<e.length;s++){const l=e[s],o=new V(l,i,{withActions:this._options.withActions,customTextColor:this._options.customTextColor,statusWidgetEl:t[s].getElement(),hideInvisibleHover:O(t[s].visibleWidgetsCount,(e=>Boolean(e))),hideValues:t[s].errorWidgetIsShown});this._dataSourceRenderers.push(o),this._updateLegendVisibility(),l.onDestroy().subscribe(this,(()=>{const e=this._dataSourceRenderers.indexOf(o);-1!==e&&(this._dataSourceRenderers[e].destroy(),this._dataSourceRenderers.splice(e,1))}),!0)}}addCustomWidget(e,t){if(0===t.block){this._renderMainDataSourceEl();const i=(0,l.ensureNotNull)(this._mainDataSourceEl);1===t.position&&e.renderTo(i,i.firstChild),0===t.position&&e.renderTo(i)}if(1===t.block){this._renderDataSourcesEl();const i=(0,l.ensureNotNull)(this._dataSourcesAdditionalWrapperEl);1===t.position&&e.renderTo(i,i.firstChild),0===t.position&&e.renderTo(i)}}firstTitle(){return this._parentEl.firstElementChild}getElement(){return this._parentEl}updateMode(e){const t=G&&e<133?1:e<205?2:e<222?3:4;null!==this._mainDataSourceRenderer&&this._mainDataSourceRenderer.updateMode(t);for(const e of this._dataSourceRenderers)e.updateMode(t);this._parentEl.classList.toggle(S.medium,3===t),this._parentEl.classList.toggle(S.minimized,2===t),this._parentEl.classList.toggle(S.micro,1===t),null!==this._renderToggler&&this._renderToggler.setMode(1===t);{const t=e<442;this._parentEl.classList.toggle(S.hideExchangeProviderTitles,t);const i=e<192
;this._parentEl.classList.toggle(S.microHideIntervalTitle,i);const s=e<442;this._parentEl.classList.toggle(S.minHideIntervalTitle,s)}const i=!this._hideAllExceptFirstLine.value()&&(h.trackingModeIsAvailable||e<542);this._parentEl.classList.toggle(S.directionColumn,i),this._parentEl.classList.toggle(S.hideUniportantValueItems,!u.CheckMobile.any()&&e<=272)}getMainSourceHeight(){return null===this._mainDataSourceRenderer?0:this._mainDataSourceRenderer.getHeight()}getDataSourceHeight(){return 0===this._dataSourceRenderers.length?0:this._dataSourceRenderers[0].getHeight()}_renderMainDataSourceEl(){null===this._mainDataSourceEl&&(this._mainDataSourceEl=document.createElement("div"),this._mainDataSourceEl.classList.add(S.legendMainSourceWrapper),this._parentEl.insertBefore(this._mainDataSourceEl,this._dataSourcesEl))}_renderDataSourcesEl(){null===this._dataSourcesEl&&(this._dataSourcesEl=document.createElement("div"),this._dataSourcesEl.classList.add(S.sourcesWrapper),this._renderToggle(this._dataSourcesEl),this._dataSourcesAdditionalWrapperEl=document.createElement("div"),this._dataSourcesAdditionalWrapperEl.classList.add(S.sources),this._dataSourcesEl.appendChild(this._dataSourcesAdditionalWrapperEl),this._renderCollapsedCounter(this._dataSourcesAdditionalWrapperEl),this._parentEl.appendChild(this._dataSourcesEl))}_renderToggle(e){this._options.showToggleButton&&(this._renderToggler=new z(e,this._options.themedColor,this._togglerOptions))}_renderCollapsedCounter(e){this._collapsedDataSourcesWrapperEl=document.createElement("div"),this._collapsedDataSourcesWrapperEl.className=`${S.item} ${S.last}`,this._collapsedDataSourcesEl=document.createElement("span"),this._collapsedDataSourcesEl.className=`${S.text} apply-common-tooltip`,this._collapsedDataSourcesWrapperEl.append(this._collapsedDataSourcesEl),e.append(this._collapsedDataSourcesWrapperEl),h.trackingModeIsAvailable&&this._collapsedDataSourcesWrapperEl.addEventListener("touchend",this._showCollapsedDataSourcesTooltipHandler),this._updateCollapsedSourcesCount(this._collapsedDataSourcesCountSpawn.value())}_showCollapsedDataSourcesTooltip(){(0,I.showOnElement)(this._collapsedDataSourcesEl,{text:this._options.collapsedDataSourcesTitle.value()}),this._addOutsideEventForHideTooltip()}_addOutsideEventForHideTooltip(){null!==this._outsideEventForCollapsedTooltip&&this._outsideEventForCollapsedTooltip(),this._outsideEventForCollapsedTooltip=(0,N.addOutsideEventListener)(new CustomEvent("timestamp").timeStamp,this._collapsedDataSourcesWrapperEl,(()=>{null!==this._outsideEventForCollapsedTooltip&&this._outsideEventForCollapsedTooltip(),(0,I.hide)()}),window.document,{touchEnd:!0})}_updateCollapsedSourcesCount(e){if(null===this._collapsedDataSourcesWrapperEl||null===this._collapsedDataSourcesEl)return;const t=0===e;this._collapsedDataSourcesWrapperEl.classList.toggle(g.blockHidden,t),t||(w(this._collapsedDataSourcesEl,`+${e}`),this._collapsedDataSourcesEl.setAttribute("title",this._options.collapsedDataSourcesTitle.value()))}_updateLegendVisibility(){
this._parentEl.classList.toggle(g.blockHidden,this._isAllLegendHidden.value()),null!==this._dataSourcesEl&&this._dataSourcesEl.classList.toggle(g.blockHidden,this._isStudiesLegendHidden.value())}_updateAllHiddenExeptFirstLine(){this._parentEl.classList.toggle(S.wrappable,!this._hideAllExceptFirstLine.value())}_setCustomBg(){const e=this._showBackground.value(),t=this._themedColor.value(),i=this._backgroundTransparency.value();let s="";if(e){const[e,l,o]=(0,r.parseRgb)(t);s=(0,r.rgbaToString)([e,l,o,(0,r.normalizeAlphaComponent)(1-i/100)])}this._parentEl.style.color=s}}var q=i(809350),j=i(319981),U=i(114123),$=i(683890),K=i(869403),Y=i.n(K),Z=i(768038),X=i(819593);function J(e){return void 0!==e?U.resetTransparency(e):e}const Q=new $.TranslatedString("show {title}",x.t(null,void 0,i(787358))),ee=new $.TranslatedString("hide {title}",x.t(null,void 0,i(470301))),te=x.t(null,void 0,i(581428)),ie=x.t(null,void 0,i(831971));class se{constructor(e,t,i,s,l){this._values=new(n())([]),this._actions=[],this._onDestroy=new(Y()),this._loading=new(n())(!1),this._moreActionCM=null,this._updateLoadingStatus=()=>{this._loading.setValue(this._source.isLoading())},this._model=e,this._source=t,this._options=i,this._callbacks=s,this._contextMenuOptions=l,this._disabled=new(n())(this._getDisabledState()),this._disabledOnInterval=new(n())(this._getDisabledOnIntervalState()),this._selected=new(n())(!1),this._isTitleHidden=new(n())(this._getTitleHiddenValue()),this._isValuesHidden=new(n())(this._getValuesHiddenValue()),this._isRowHidden=new(n())(this._getRowHiddenValue()),this._isEditable=new(n())(this._getIsEditable()),(0,X.combine)((()=>({})),this._isTitleHidden,this._isValuesHidden,this._disabled).subscribe(this._updateRowVisibilities.bind(this)),this._values.subscribe((()=>{this._isValuesHidden.setValue(this._getValuesHiddenValue())}))}destroy(){}onDestroy(){return this._onDestroy}titles(){return this._titles}values(){return this._values.readonly()}actions(){return this._actions}disabled(){return this._disabled.readonly()}disabledOnInterval(){return this._disabledOnInterval.readonly()}selected(){return this._selected.readonly()}loading(){return this._loading.readonly()}isTitleHidden(){return this._isTitleHidden.readonly()}isValuesHidden(){return this._isValuesHidden.readonly()}isRowHidden(){return this._isRowHidden.readonly()}isEditable(){return this._isEditable.readonly()}update(){this._updateTitles(),this._updateValues(),this._updateStates()}updateSource(e){this._source!==e&&(this._source=e,this.update(),this._isTitleHidden.setValue(this._getTitleHiddenValue()),this._isValuesHidden.setValue(this._getValuesHiddenValue()))}onToggleDisabled(){const e=this._source.properties().childs().visible,t=!e.value();this._model.setProperty(e,t,(t?Q:ee).format({title:new $.TranslatedString(this._source.name(),this._source.title())})),P((t?"Show":"Hide")+" source")}onShowSettings(e){this._source.userEditEnabled()&&(this.setSourceSelected(),this._callbacks.showChartPropertiesForSource(this._source,e),P("Settings for source"))}onShowMoreActions(e){
return this._options.readOnlyMode?Promise.resolve(null):(this._callbacks.updateActions(),P("Show source context menu"),this._callbacks.showContextMenuForSources([this._source],this._calcNewPosition(e),this._contextMenuOptions))}setSourceSelected(){this._model.selectionMacro((e=>{e.clearSelection(),e.addSourceToSelection(this._source)}))}_moreActionHandler(e){e.preventDefault(),null!==this._moreActionCM&&this._moreActionCM.isShown()?this._moreActionCM=null:(this.setSourceSelected(),this.onShowMoreActions(e).then((e=>{this._moreActionCM=e})))}_updateStates(){this._disabled.setValue(this._getDisabledState()),this._disabledOnInterval.setValue(this._getDisabledOnIntervalState()),this._selected.setValue(this._model.selection().isSelected(this._source)),this._isEditable.setValue(this._getIsEditable()),this._updateLoadingStatus()}_hasValues(){return this._values.value().length>0}_getEyeTitle(){return this._disabled.value()?te:ie}_getIsEditable(){return this._source.userEditEnabled()}_getDisabledState(){return!this._source.properties().visible.value()}_updateRowVisibilities(){this._isRowHidden.setValue(this._getRowHiddenValue())}_getRowHiddenValue(){return this._options.readOnlyMode&&this._disabled.value()||this._isTitleHidden.value()&&(this._isValuesHidden.value()||this._disabled.value())}_calcNewPosition(e){let t={};if(e.hasOwnProperty("touches")&&e.touches.length>0)t={clientX:e.touches[0].clientX,clientY:e.touches[0].clientY};else if(null!==e.target){const i=e.target.getBoundingClientRect();t={clientX:(0,Z.isRtl)()?i.right:i.left,clientY:i.top+i.height+3}}else{const i=e;t={clientX:i.clientX,clientY:i.clientY}}return t}}var le=i(626740),oe=i(533699),ne=i(125226),ae=i(595531),re=i(754336),de=i(841674),ue=i(387258),he=i(645534);const ce=x.t(null,void 0,i(141610)),pe=x.t(null,void 0,i(593666)),_e=x.t(null,void 0,i(608209)),me=d.enabled("show_hide_button_in_legend"),ge=d.enabled("hide_resolution_in_legend"),ve=d.enabled("marked_symbols")&&(0,ne.isFeatureEnabled)("marked_symbols_enabled");class be extends se{constructor(e,t,i,s,l){super(e,t,i,s,l),this._titles={title:new(n())(""),description:new(n())(""),interval:new(n())(""),provider:new(n())(""),exchange:new(n())(""),chartStyle:new(n())("")},this._symbolMarker=null,this._symbolMarkerIcon=null,this._flagged=new(n())(null),this._symbolAction=null,this._symbol=null,this._isOneButtonCanBeStick=!1,this._createActions(),this._updateSymbolMarker();const o=this._model.model().properties().childs().paneProperties.childs().legendProperties.childs();o.showSeriesTitle.subscribe(this,(()=>{this._isTitleHidden.setValue(this._getTitleHiddenValue())})),this._valuesVisibleProperty=(0,j.combineProperty)(((e,t,i)=>e||t||i),o.showSeriesOHLC,o.showBarChange,o.showVolume),this._valuesVisibleProperty.subscribe(null,(()=>{this._isValuesHidden.setValue(this._getValuesHiddenValue())})),this.update(),this._source.onStatusChanged().subscribe(this,this._updateLoadingStatus)}destroy(){super.destroy(),
this._model.model().properties().childs().paneProperties.childs().legendProperties.childs().showSeriesTitle.unsubscribeAll(this),this._source.onStatusChanged().unsubscribeAll(this),this._valuesVisibleProperty.destroy(),this._onDestroy.fire()}flagged(){return this._flagged.readonly()}onShowSettings(){this._source.userEditEnabled()&&this._callbacks.showGeneralChartProperties(ae.TabNames.symbol)}isOneButtonCanBeStick(){return this._isOneButtonCanBeStick}_updateTitles(){const e=(0,l.ensureNotNull)(this._source.statusView()).getSplitTitle();this._titles.title.setValue((0,q.clean)(e.title,!0)),this._titles.description.setValue((0,q.clean)(e.description,!0)),ge||this._titles.interval.setValue((0,q.clean)(e.interval,!0)),this._titles.provider.setValue((0,q.clean)(e.provider,!0)),this._titles.exchange.setValue((0,q.clean)(e.exchange,!0)),this._titles.chartStyle.setValue((0,q.clean)(e.chartStyle,!0))}_updateValues(){const e=this._source.legendView(),t=this._values.value(),i=e.marketTitle(),s=e.marketTitle().length>0;if(0===t.length){const t={value:new(n())(""),color:new(n())(""),visible:new(n())(s),title:new(n())(i),unimportant:new(n())(!1)},l=e.items().map((e=>({value:new(n())(e.value()),color:new(n())(J(e.color())),visible:new(n())(e.visible()),title:new(n())(e.title()),unimportant:new(n())(e.unimportant())})));this._values.setValue([t].concat(l))}else{t[0].title.setValue(i),t[0].visible.setValue(s);const l=e.items();for(let e=0;e<l.length;e++){const i=l[e];t[e+1].value.setValue(i.value()),t[e+1].color.setValue(J(i.color())),t[e+1].visible.setValue(i.visible()),t[e+1].title.setValue(i.title())}}}_updateStates(){super._updateStates(),this._updateSymbolMarker()}_getDisabledOnIntervalState(){return!1}_getTitleHiddenValue(){return!this._model.model().properties().childs().paneProperties.childs().legendProperties.childs().showSeriesTitle.value()}_getValuesHiddenValue(){return!this._hasValues()||!this._valuesVisibleProperty.value()}_createActions(){if(ve&&this._options.symbolMarkerEnabled){const e=document.createElement("div");e.classList.add(S.markerContainer),this._symbolMarkerIcon=e,this._symbolAction={iconMap:new Map([["large",e],["small",e]]),action:(0,m.wrapHandlerWithPreventEvent)(this._symbolActionHandler.bind(this)),visible:new(n())(!0),className:S.flag,title:new(n())(this._getMarkerTitle()),dataset:{name:"legend-flag-action"}},this._actions.push(this._symbolAction)}if(me){const e={iconMap:new Map([["large",de],["small",re]]),action:(0,m.wrapHandlerWithPreventEvent)(this.onToggleDisabled.bind(this)),visible:new(n())(!0),className:S.eye,title:new(n())(this._getEyeTitle()),dataset:{name:"legend-show-hide-action"}};this._actions.push(e),this._disabled.subscribe((()=>{e.title.setValue(this._getEyeTitle())}))}this._actions.push({iconMap:new Map([["large",he],["small",ue]]),action:this._moreActionHandler.bind(this),visible:new(n())(!0),title:new(n())(ce),dataset:{name:"legend-more-action"}})}_getMarkerTitle(){return null!==this._symbolMarker?this._symbolMarker.isMarked()?_e:pe:""}_symbolActionHandler(){
null!==this._symbolMarker&&(this._updateSymbolMarker(),P("Change flag state"))}_updateSymbolMarker(){if(ve&&this._options.symbolMarkerEnabled){const e=(0,l.ensureNotNull)(this._symbolAction),t=(0,l.ensureNotNull)(this._symbolMarkerIcon),i=this._model.model().mainSeries().symbol();this._symbolMarker?this._symbol!==i&&(this._symbolMarker.bindTo(i,t),this._symbol=i):(this._symbolMarker=(0,le.createSymbolMarkerStandalone)({symbol:i,container:t,specialImage:oe,className:S.flagWrapper,onMarkedChanged:()=>this._updateSymbolMarker()}),this._symbol=i),this._flagged.setValue(this._symbolMarker.isMarked());(0,l.ensureDefined)(e.title).setValue(this._getMarkerTitle())}else this._isOneButtonCanBeStick=!0}}var we=i(943221),ye=i(676221),Se=i(312554),fe=i(223616),Me=i(293689),Ce=i(218333),Ee=i(272001),Ve=i(583637),xe=i(34882),Te=i(488658),Pe=i(252506),ke=i(921341),Le=i(501817);const Ae=(0,Ee.getLogger)("Chart.LegendWidget"),We=x.t(null,void 0,i(389517)),He=x.t(null,void 0,i(966324)),Be=x.t(null,void 0,i(734596)),De=x.t(null,void 0,i(141610)),ze=x.t(null,void 0,i(482751)),Ie=x.t(null,void 0,i(189790)),Ne=x.t(null,void 0,i(337809)),Oe=d.enabled("study_buttons_in_legend"),Re=d.enabled("show_hide_button_in_legend"),Ge=d.enabled("property_pages"),Fe=d.enabled("format_button_in_legend"),qe=d.enabled("delete_button_in_legend");class je extends se{constructor(e,t,i,s,l){super(e,t,i,s,l),this._titles={title:new(n())(""),args:new(n())("")},this._error=new(n())(!1),this._isPineScriptDataSource=new(n())(!1),this._pineAction=null,this._globalVisibility=new(n())(!0),this._createActions();const o=this._model.model().properties().childs().paneProperties.childs().legendProperties.childs(),a=[o.showSeriesTitle,o.showStudyTitles];for(const e of a)e.subscribe(this,(()=>{this._isTitleHidden.setValue(this._getTitleHiddenValue())}));const r=[o.showSeriesOHLC,o.showBarChange,o.showStudyValues];for(const e of r)e.subscribe(this,(()=>{this._isValuesHidden.setValue(this._getValuesHiddenValue())}));this.update(),(0,Me.onPineDeleted)().subscribe(this,this.update.bind(this)),this._updateAbleShowSourceCode()}destroy(){super.destroy();const e=this._model.model().properties().childs().paneProperties.childs().legendProperties.childs();e.showSeriesTitle.unsubscribeAll(this),e.showStudyTitles.unsubscribeAll(this),e.showSeriesOHLC.unsubscribeAll(this),e.showBarChange.unsubscribeAll(this),e.showStudyValues.unsubscribeAll(this),(0,Me.onPineDeleted)().unsubscribeAll(this),this._onDestroy.fire()}error(){return this._error.readonly()}isPineScriptDataSource(){return this._isPineScriptDataSource.readonly()}updateSource(e){this._source!==e&&(this._values.setValue([]),super.updateSource(e),this._updateAbleShowSourceCode())}onRemoveSource(){this._source.isUserDeletable()&&(this._source.hasChildren()?(0,ye.showDeleteStudyTreeConfirm)(this._model.removeSource.bind(this._model,this._source,!1)):this._model.removeSource(this._source,!1),P("Remove sources"))}onShowSourceCode(){if((0,we.isStudy)(this._source)){
const e=this._source.metaInfo(),t=void 0!==e.pine?e.pine.version:"",i=e.scriptIdPart;Promise.resolve((0,Me.getPineSourceCode)(i,t)).then((e=>{const t=(0,l.ensureDefined)(e),s=fe.Version.parse(t.version),o=t.lastVersionMaj?fe.Version.parse(t.lastVersionMaj):new fe.Version(0,0),n={scriptSource:t.source,scriptIdPart:i,scriptName:t.scriptName,scriptTitle:t.scriptTitle,version:t.version,isOld:!o.isZero()&&o.major()!==s.major()};void 0!==window.TradingView.bottomWidgetBar&&window.TradingView.bottomWidgetBar.activateScriptEditorTab(n),P("Open source code for pine scripts")}),(e=>{Ae.logError(e),(0,Ce.showNoticeDialog)({title:ze,content:Ie})}))}}setGlobalVisibility(e){this._globalVisibility.setValue(e)}globalVisibility(){return this._globalVisibility.readonly()}getFullTitle(){return[this._titles.title,this._titles.args].map((e=>e.value())).join(" ")}_updateTitles(){const e=(0,l.ensureNotNull)(this._source.statusView()).getSplitTitle();this._titles.title.setValue((0,q.clean)(e[0],!0));const t=Array.isArray(e[1])?e[1].join(" "):e[1]||"";this._titles.args.setValue((0,q.clean)(t,!0))}_updateValues(){const e=this._source.legendView();if(null===e)return;if(0===e.items().length)return;const t=this._values.value();if(0===t.length){const t=e.items().map((e=>({value:new(n())(e.value()),color:new(n())(J(e.color())),visible:new(n())(e.visible()),unimportant:new(n())(e.unimportant()),title:new(n())(e.title())})));this._values.setValue(t)}else{const i=e.items();for(let e=0;e<i.length;e++){const s=t[e],l=i[e];s.value.setValue(l.value()),s.color.setValue(J(l.color())),s.visible.setValue(l.visible()),s.title.setValue(l.title())}}}_updateStates(){super._updateStates(),void 0!==this._error&&this._error.setValue(Boolean(this._source.isFailed()))}_getTitleHiddenValue(){const e=this._model.model().properties().childs().paneProperties.childs().legendProperties.childs();return this._isSymbolLikeStudy()?!e.showSeriesTitle.value():!e.showStudyTitles.value()}_getDisabledOnIntervalState(){return!(!(0,we.isStudy)(this._source)&&!(0,we.isStudyStub)(this._source))&&!this._source.isActualInterval()}_getValuesHiddenValue(){if(!this._hasValues())return!0;const e=this._model.model().properties().childs().paneProperties.childs().legendProperties.childs();return this._isSymbolLikeStudy()?!e.showSeriesOHLC.value()&&!e.showBarChange.value():!e.showStudyValues.value()}_isSymbolLikeStudy(){return this._source instanceof ke.study_Overlay||this._source instanceof Le.StudyCompare}_updateAbleShowSourceCode(){if((0,we.isStudy)(this._source)&&Oe&&this._options.canShowSourceCode){const e=this._source.metaInfo(),t=window.TradingView.isExistent(e.pine),i=e.scriptIdPart;t&&Promise.resolve((0,Me.isAuthToGetPineSourceCode)(i,e.pine&&e.pine.version)).then((e=>{let t=!0;e||(t=!1),this._updateVisibilityPineAction(t)}),(e=>{Ae.logError("Failed isAuthToGetPineSourceCode, reason: "+e)}))}}_updateVisibilityPineAction(e){null!==this._pineAction&&(this._pineAction.visible.setValue(e),this._isPineScriptDataSource.setValue(e))}_createActions(){if(this._options.readOnlyMode)return
;if(this._pineAction={iconMap:new Map([["large",xe],["small",xe]]),action:(0,m.wrapHandlerWithPreventEvent)(this.onShowSourceCode.bind(this)),visible:new(n())(!1),title:new(n())(He),dataset:{name:"legend-pine-action"}},Re){const e={iconMap:new Map([["large",de],["small",re]]),action:(0,m.wrapHandlerWithPreventEvent)(this.onToggleDisabled.bind(this)),visible:new(n())(!this._getDisabledOnIntervalState()),className:S.eye,title:new(n())(this._getEyeTitle()),dataset:{name:"legend-show-hide-action"}};this._actions.push(e),this._disabled.subscribe((()=>{e.title.setValue(this._getEyeTitle())}));const t={iconMap:new Map([["large",de],["small",re]]),action:(0,m.wrapHandlerWithPreventEvent)(this.onShowSettings.bind(this,ae.TabNames.visibility)),visible:new(n())(this._getDisabledOnIntervalState()),className:S.intervalEye,title:new(n())(Ne),dataset:{name:"legend-interval-show-hide-action"}};this._actions.push(t),this._disabledOnInterval.subscribe((i=>{t.visible.setValue(i),e.visible.setValue(!i)}))}if(Ge&&Fe&&(!(0,we.isStudy)(this._source)||new Se.MetaInfoHelper(this._source.metaInfo()).hasUserEditableOptions())){const e={iconMap:new Map([["large",Ve],["small",Ve]]),action:(0,m.wrapHandlerWithPreventEvent)(this.onShowSettings.bind(this)),visible:new(n())(this._getIsEditable()),title:new(n())(We),dataset:{name:"legend-settings-action"}};this._actions.push(e),this._isEditable.subscribe((t=>{e.visible.setValue(t)}))}if(((0,we.isStudy)(this._source)||(0,we.isStudyStub)(this._source))&&Oe&&this._options.canShowSourceCode&&this._actions.push(this._pineAction),qe){const e={iconMap:new Map([["large",Pe],["small",Te]]),action:(0,m.wrapHandlerWithPreventEvent)(this.onRemoveSource.bind(this)),visible:new(n())(this._getIsEditable()),title:new(n())(Be),dataset:{name:"legend-delete-action"}};this._actions.push(e),this._isEditable.subscribe((t=>{e.visible.setValue(t)}))}const e={iconMap:new Map([["large",he],["small",ue]]),action:this._moreActionHandler.bind(this),visible:new(n())(this._getIsEditable()),title:new(n())(De),dataset:{name:"legend-more-action"}};this._actions.push(e),this._isEditable.subscribe((t=>{e.visible.setValue(t)}))}}var Ue=i(310399),$e=i(263221),Ke=i(720444),Ye=i(98472),Ze=i(868151),Xe=i(354145),Je=i(951983);function Qe(e,t,i){e.setProperty(t,!t.value(),i)}
const et=new $.TranslatedString("change symbol description visibility",x.t(null,void 0,i(26717))),tt=new $.TranslatedString("change open market status visibility",x.t(null,void 0,i(118644))),it=new $.TranslatedString("change OHLC values visibility",x.t(null,void 0,i(457889))),st=new $.TranslatedString("change bar change visibility",x.t(null,void 0,i(845110))),lt=new $.TranslatedString("change indicator titles visibility",x.t(null,void 0,i(231325))),ot=new $.TranslatedString("change indicator arguments visibility",x.t(null,void 0,i(96162))),nt=new $.TranslatedString("change indicator values visibility",x.t(null,void 0,i(399774))),at=new $.TranslatedString("change volume values visibility",x.t(null,void 0,i(709455))),rt=x.t(null,void 0,i(739339)),dt=x.t(null,void 0,i(775991)),ut=x.t(null,void 0,i(199487)),ht=x.t(null,void 0,i(22519)),ct=x.t(null,void 0,i(101111)),pt=x.t(null,void 0,i(126315)),_t=x.t(null,void 0,i(26935)),mt=x.t(null,void 0,i(584098)),gt=(0,Ze.appendEllipsis)(x.t(null,void 0,i(389517)));var vt=i(150301),bt=i(551238),wt=i(535799),yt=i(664224),St=i(508846),ft=i(534193),Mt=i(776734),Ct=i(62802);const Et="tv.alreadyBlinkedStatuses",Vt=[];function xt(){return Ct.getJSON(Et,Vt)}const Tt=new(n())(xt());function Pt(e){const t=Ct.getJSON(Et,Vt);t.includes(e)||(t.push(e),Ct.setJSON(Et,t),Tt.setValue(xt()))}Ct.onSync.subscribe(null,(()=>Tt.setValue(xt())));const kt=Tt;var Lt=i(963644),At=i(947467),Wt=i(72822),Ht=i(167189),Bt=i(257524),Dt=i(267957),zt=i(876948),It=i(458189),Nt=i(156201),Ot=i(498532);const Rt=(0,
Ee.getLogger)("Chart.LegendWidget"),Gt=["TFEXDelayForGuest","MOEXDelayForGuest","CHIXAuDelayForGuest","MILDelayForGuest","NGMDelayForGuest","DEForGuest","ICESGDelayForGuest","ADXDelayForGuest","TRADEGATEDelayForGuest"],Ft=new Map([["DelayToRealtime",new Map([["small",Ht],["medium",Bt],["large",Bt]])],["DelayNoRealtime",new Map([["small",Ht],["medium",Bt],["large",Bt]])],["TFEXDelayForGuest",new Map([["small",Ht],["medium",Bt],["large",Bt]])],["MOEXDelayForGuest",new Map([["small",Ht],["medium",Bt],["large",Bt]])],["CHIXAuDelayForGuest",new Map([["small",Ht],["medium",Bt],["large",Bt]])],["MILDelayForGuest",new Map([["small",Ht],["medium",Bt],["large",Bt]])],["NGMDelayForGuest",new Map([["small",Ht],["medium",Bt],["large",Bt]])],["ICESGDelayForGuest",new Map([["small",Ht],["medium",Bt],["large",Bt]])],["ADXDelayForGuest",new Map([["small",Ht],["medium",Bt],["large",Bt]])],["TRADEGATEDelayForGuest",new Map([["small",Ht],["medium",Bt],["large",Bt]])],["DEForGuest",new Map([["small",Ht],["medium",Bt],["large",Bt]])],["EOD",new Map([["small",Dt],["medium",zt],["large",zt]])],["TickByTick",new Map([["small",It],["medium",Nt],["large",Nt]])],["BATSToRealtime",new Map([["small",It],["medium",Nt],["large",Nt]])],["DelayWithoutMarketAgreement",new Map([["small",Ht],["medium",Bt],["large",Bt]])]]),qt=new Map([["DelayToRealtime",Ot.delay],["DelayNoRealtime",Ot.delay],["TFEXDelayForGuest",Ot.delay],["MOEXDelayForGuest",Ot.delay],["CHIXAuDelayForGuest",Ot.delay],["MILDelayForGuest",Ot.delay],["NGMDelayForGuest",Ot.delay],["ICESGDelayForGuest",Ot.delay],["ADXDelayForGuest",Ot.delay],["TRADEGATEDelayForGuest",Ot.delay],["DEForGuest",Ot.delay],["EOD",Ot.eod],["TickByTick",Ot.notAccurate],["BATSToRealtime",Ot.notAccurate],["DelayWithoutMarketAgreement",Ot.delay]]),jt=new Map([["DelayToRealtime",bt.colorsPalette["color-delay-mode"]],["DelayNoRealtime",bt.colorsPalette["color-delay-mode"]],["TFEXDelayForGuest",bt.colorsPalette["color-delay-mode"]],["MOEXDelayForGuest",bt.colorsPalette["color-delay-mode"]],["CHIXAuDelayForGuest",bt.colorsPalette["color-delay-mode"]],["MILDelayForGuest",bt.colorsPalette["color-delay-mode"]],["NGMDelayForGuest",bt.colorsPalette["color-delay-mode"]],["ICESGDelayForGuest",bt.colorsPalette["color-delay-mode"]],["ADXDelayForGuest",bt.colorsPalette["color-delay-mode"]],["TRADEGATEDelayForGuest",bt.colorsPalette["color-delay-mode"]],["DEForGuest",bt.colorsPalette["color-delay-mode"]],["EOD",bt.colorsPalette["color-eod-mode"]],["TickByTick",bt.colorsPalette["color-notaccurate-mode"]],["BATSToRealtime",bt.colorsPalette["color-notaccurate-mode"]],["DelayWithoutMarketAgreement",bt.colorsPalette["color-delay-mode"]]]),Ut=x.t(null,void 0,i(257310)),$t=x.t(null,void 0,i(659315)),Kt=x.t(null,void 0,i(215815)),Yt=x.t(null,void 0,i(365636)),Zt=x.t(null,void 0,i(107435)),Xt=(0,wt.htmlEscape)(x.t(null,void 0,i(11155))),Jt=(0,wt.htmlEscape)(x.t(null,void 0,i(301084))),Qt=(0,wt.htmlEscape)(x.t(null,void 0,i(652984))),ei=(0,wt.htmlEscape)(x.t(null,void 0,i(136015))),ti=(0,wt.htmlEscape)(x.t(null,void 0,i(52916))),ii=(0,
wt.htmlEscape)(x.t(null,void 0,i(449321))),si=(0,wt.htmlEscape)(x.t(null,void 0,i(425978))),li=(0,wt.htmlEscape)(x.t(null,void 0,i(28412))),oi=(0,wt.htmlEscape)(x.t(null,void 0,i(806667))),ni=(0,wt.htmlEscape)(x.t(null,void 0,i(257918))),ai=(0,wt.htmlEscape)(x.t(null,void 0,i(668025))),ri=(0,wt.htmlEscape)(x.t(null,void 0,i(791459))),di=x.t(null,void 0,i(236004)),ui=x.t(null,void 0,i(718429)),hi=(0,wt.htmlEscape)(x.t(null,void 0,i(825046)));class ci extends ft.StatusViewModel{constructor(e,t,i){super({iconMap:Ft,classNameMap:qt,titleColorMap:jt,size:t}),this._dataUpdatedInfo=new(n())(null).spawn(),this._options=i,this._model=e,this._dataModeBlinkingStatuses=kt.spawn(),this._dataModeBlinkingStatuses.subscribe(this._updateBlinkingMode.bind(this)),this.turnOffBlinkingMode=this._turnOffBlinking.bind(this),this.setModel(e)}destroy(){this._dataUpdatedInfo.destroy(),this._dataModeBlinkingStatuses.destroy()}setModel(e){if(this._dataUpdatedInfo.destroy(),null===e)return this._model=e,void(this._dataUpdatedInfo=new(n())(null).spawn());this._dataUpdatedInfo=e.status().spawn(),this._dataUpdatedInfo.subscribe(this._updateStatus.bind(this),{callWithLast:!0})}_shouldBeHiddenByStatus(e){var t;return!!(null===(t=this._options.shouldBeHiddenRegardlessOfStatus)||void 0===t?void 0:t.value())||super._shouldBeHiddenByStatus(e)}_getTooltip(){const e=this._getShortTexts();return null===e?null:Object.values(e).join(" · ")}async _updateFullTooltipByStatus(){const e=this._dataUpdatedInfo.value();if(null===e)return void this._fullTooltip.setValue(null);const t=this._getShortTexts(),i=await this._getHtmls(),s=await this._getActions();if(e!==this._dataUpdatedInfo.value())return;const l=[];for(const o of e){const e=o.mode;l.push({icon:this._getIcon(e),iconClassName:this._iconClassNames.value(),title:t&&t[e],titleColor:this._getTitleColor(e),html:i&&i[e],size:this._size,action:s&&s[e]})}this._fullTooltip.setValue(l)}_updateStatus(e){var t;const i=null!==e?e[0]:null;super._updateByStatus(null!==(t=null==i?void 0:i.mode)&&void 0!==t?t:null),this._updateBlinkingMode()}async _getHtmls(){var e,t;const s=this._dataUpdatedInfo.value();if(null===s||null===this._model)return Promise.resolve(null);const l={},o=this._model.symbolName();let n=null,a=null;try{n=await this._model.description(),a=this._model.exchange()}catch(e){Rt.logError(`Can't get exchange description, reason: ${(0,Wt.errorToString)(e)}`)}for(const r of s){const s=r.mode;if(l[s]=[],["DelayToRealtime","DelayNoRealtime","DelayWithoutMarketAgreement",...Gt].includes(s)&&(l[s].push(Xt.format({symbolName:o,time:this._model.time().toString()})),this._options.subscriptionFullInfo&&null!==n&&"DelayToRealtime"===s&&l[s].push(Qt.format({description:`<b>${n}</b>`})),null!==n&&"DelayNoRealtime"===s&&l[s].push(ei.format({description:`<b>${n}</b>`})),"DelayWithoutMarketAgreement"===s&&l[s].push(ri.format({listedExchange:this._model.listedExchange()})),this._options.subscriptionFullInfo&&Gt.includes(s)&&l[s].push(Jt.format({listedExchange:this._model.listedExchange()}))),"EOD"===s&&(l[s]=[ti]),
"TickByTick"===s){const o=void 0===r.updatePeriod?ii:(0,wt.htmlEscape)(x.t(null,{count:r.updatePeriod,replace:{amount:(null!==(e=r.updatePeriod)&&void 0!==e?e:1).toString()},plural:"Data on our Basic plan is updated once every {amount} seconds, even if there are more updates on the market."},i(602121))),n=void 0===r.updatePeriod?si:(0,wt.htmlEscape)(x.t(null,{count:r.updatePeriod,replace:{amount:(null!==(t=r.updatePeriod)&&void 0!==t?t:1).toString()},plural:"Data is updated once every {amount} seconds, even if there are more updates on the market."},i(888841)));l[s].push(this._options.subscriptionFullInfo?o:n),this._options.subscriptionFullInfo&&l[s].push(li)}if(null!==a&&"BATSToRealtime"===s){let e=this._model.listedExchange();e=(0,y.redefineExchangeName)(e),l[s].push(oi.format({symbolName:o,exchange:a}),""!==e?ai.format({exchange:e}):ni)}}return Object.keys(l).length>0?l:null}async _getActions(){const e=this._dataUpdatedInfo.value();if(null===e||null===this._model)return null;const t={};if(this._options.subscriptionFullInfo)for(const i of e){const e=i.mode;if(Gt.includes(i.mode)&&(t[e]={text:di,onClick:()=>{(0,Lt.showSignModal)({source:"Data warning indicator"})}}),"DelayWithoutMarketAgreement"===e){const i=this._model.exchange();t[e]={text:hi,onClick:()=>{(0,At.showExchangeAgreementDialog)({exchange:i.toLowerCase()})}}}if("BATSToRealtime"===e&&(t[e]={text:ui,onClick:()=>{if((0,yt.showSupportDialog)({solutionId:43000473924}),null===this._model)return;const e=this._model.proName();(0,Mt.getTracker)().then((t=>t&&e&&t.trackMarketDataSolutionEvent(e)))}}),"TickByTick"===e||"DelayToRealtime"===e){let i=null,s=null;try{i=await this._model.description(),s=this._model.exchange()}catch(e){Rt.logError(`Can't get exchange description, reason: ${(0,Wt.errorToString)(e)}`)}t[e]={text:ui,onClick:()=>{null!==this._model&&(0,St.createGoProDialog)({forceUpgradeBtn:!0,goOnMarkets:!0,customParams:{time:this._model.time(),exchange:s,listedExchange:this._model.listedExchange(),description:i,symbolName:this._model.symbolName(),username:window.user?window.user.username:""},feature:e}).then((()=>{(0,T.trackEvent)("Data Warning","Full description visible",e)}))}}}}return Object.keys(t).length>0?t:null}_getShortTexts(){var e,t;const s=this._dataUpdatedInfo.value();if(null===s||null===this._model)return null;const l={};for(const o of s){const s=o.mode;if(["DelayToRealtime","DelayNoRealtime",...Gt,"DelayWithoutMarketAgreement"].includes(s)&&(l[s]=Ut),"EOD"===s&&(l[s]=$t),"TickByTick"===s){const t=void 0===o.updatePeriod?Kt:(0,wt.htmlEscape)(x.t(null,{plural:"One update every {amount} seconds",count:o.updatePeriod,replace:{amount:(null!==(e=o.updatePeriod)&&void 0!==e?e:1).toString()}},i(705223)));l[s]=t}if("BATSToRealtime"===s){let e=null!==(t=this._model.firstReplacedByBatsExchange())&&void 0!==t?t:"";e=(0,y.redefineExchangeName)(e),l[s]=""!==e?Zt.format({exchange:e,originalExchange:Yt}):Yt}}return Object.keys(l).length>0?l:null}_updateBlinkingMode(){const e=this._dataUpdatedInfo.value();if(null===e)return
;const t=this._dataModeBlinkingStatuses.value();for(const i of e)if(!t.includes(i.mode))return void this.isBlinkingMode.setValue(!0);this.isBlinkingMode.setValue(!1)}_turnOffBlinking(){const e=this._dataUpdatedInfo.value();if(null!==e)for(const t of e)Pt(t.mode)}}var pi=i(127486),_i=i(554430);const mi=x.t(null,void 0,i(539045)),gi=new Map([[!0,new Map([["small",pi],["medium",_i],["large",_i]])],[!1,new Map([["small",""],["medium",""],["large",""]])]]),vi=new Map([[!0,Ot.dataProblemLow],[!1,null]]),bi=new Map([[!0,mi],[!1,null]]),wi=new Map([[!0,mi],[!1,null]]),yi=new Map([[!0,bt.colorsPalette["color-data-problem"]],[!1,null]]);class Si extends ft.StatusViewModel{constructor(e,t,i){super({iconMap:gi,classNameMap:vi,tooltipMap:bi,titleMap:wi,titleColorMap:yi,size:t}),this._dataSourceErrorStatus=new(n())(null).spawn(),this._lastError=null,this._options=i,this.setSource(e)}destroy(){this._dataSourceErrorStatus.destroy()}setSource(e){this._dataSourceErrorStatus.destroy(),this._dataSourceErrorStatus=e.errorStatus().spawn(),this._dataSourceErrorStatus.subscribe(this._updateStatus.bind(this),{callWithLast:!0})}_getTooltip(e){var t;return null!==(t=e?this._getDataSourceErrorStatusCustomTitle():null)&&void 0!==t?t:super._getTooltip(e)}_getTitle(e){var t;return null!==(t=e?this._getDataSourceErrorStatusCustomTitle():null)&&void 0!==t?t:super._getTitle(e)}async _getHtml(e){const t=this._dataSourceErrorStatus.value();return null!==t?[(0,wt.htmlEscape)(t.error)]:null}_getAction(e){const t=this._dataSourceErrorStatus.value();if(this._options.errorSolution&&null!==t){const{solutionId:e,studyFeature:i}=t;if(e)return{text:ui,onClick:()=>{(0,yt.showSupportDialog)({solutionId:e})}};if(i)return{text:ui,onClick:()=>(0,St.createGoProDialog)({feature:i})}}return null}_updateStatus(e){const t=this._status.value();null!==e?(this._status.setValue(!0),t&&this._lastError!==e.error&&this._updateByStatus(!0),this._lastError=e.error):(this._status.setValue(null),this._lastError=null)}_getDataSourceErrorStatusCustomTitle(){var e;return(null===(e=this._dataSourceErrorStatus.value())||void 0===e?void 0:e.title)||null}}const fi=x.t(null,void 0,i(597325)),Mi=new Map([["high",new Map([["small",pi],["medium",_i],["large",_i]])],["low",new Map([["small",pi],["medium",_i],["large",_i]])]]),Ci=new Map([["high",Ot.dataProblemHigh],["low",Ot.dataProblemLow]]),Ei=new Map([["high",fi],["low",fi]]),Vi=new Map([["high",bt.colorsPalette["color-data-problem"]],["low",bt.colorsPalette["color-data-problem"]]]);class xi extends ft.StatusViewModel{constructor(e,t){super({tooltipMap:Ei,iconMap:Mi,classNameMap:Ci,titleMap:Ei,titleColorMap:Vi,size:t}),this._dataProblem=new(n())(null).spawn(),this._isDataProblemCritical=new(n())(!1),this.setModel(e)}destroy(){this._dataProblem.destroy()}isDataProblemCritical(){return this._isDataProblemCritical}setModel(e){this._dataProblem.destroy(),null!==e?(this._dataProblem=e.status().spawn(),this._dataProblem.subscribe(this._updateStatus.bind(this),{callWithLast:!0})):this._dataProblem=new(n())(null).spawn()}async _getHtml(e){
const t=this._dataProblem.value();return null===t?null:[(0,wt.htmlEscape)(t.text)]}_getTooltip(e){var t;return null!==(t=this._getDataProblemCustomTitle())&&void 0!==t?t:super._getTooltip(e)}_getTitle(e){var t;return null!==(t=this._getDataProblemCustomTitle())&&void 0!==t?t:super._getTitle(e)}_updateStatus(e){var t;const i=null!==(t=null==e?void 0:e.severity)&&void 0!==t?t:null;this._status.setValue(i),this._isDataProblemCritical.setValue(function(e){return"high"===e}(i))}_getDataProblemCustomTitle(){var e;return(null===(e=this._dataProblem.value())||void 0===e?void 0:e.title)||null}}class Ti extends ft.StatusViewModel{constructor(e,t){super(t),this._booleanStatus=new(n())(!1).spawn(),this.updateStatus(e)}destroy(){this._booleanStatus.destroy()}updateStatus(e){this._booleanStatus.destroy(),this._booleanStatus=e.spawn(),this._booleanStatus.subscribe(this._updateStatus.bind(this),{callWithLast:!0})}_updateStatus(e){e?this._status.setValue(!0):this._status.setValue(null)}}var Pi=i(479639),ki=i(904696);const Li=x.t(null,void 0,i(814177)),Ai=x.t(null,void 0,i(673717)),Wi=new Map([[!0,new Map([["small",Pi],["medium",ki],["large",ki]])],[!1,new Map([["small",""],["medium",""],["large",""]])]]),Hi=new Map([[!0,Ot.invalidSymbol],[!1,null]]),Bi=new Map([[!0,Li],[!1,null]]),Di=new Map([[!0,Li],[!1,null]]),zi=new Map([[!0,bt.colorsPalette["color-invalid-symbol"]],[!1,null]]),Ii=new Map([[!0,[Ai]],[!1,null]]),Ni=new Map([[!0,null],[!1,null]]);var Oi=i(355611),Ri=i(398451);class Gi{constructor(e,t){var i,s;this.visibleWidgetsCount=new(n())(0),this.errorWidgetIsShown=new(n())(!1),this._size=h.trackingModeIsAvailable?"medium":"small",this._tooltips=new(n())([]),this._visibilitySpawns=[],this._tooltipSpawns=[],this._statusWidgetInfos=[],this._renderer=new Oi.StatusRenderer(this._size,this.visibleWidgetsCount,this._tooltips,{onClick:this._handleToggleDropdown.bind(this)}),this._symbolInvalidViewModel=null,this._dataSourceErrorStatusViewModel=null,this._marketStatusViewModel=null,this._dataUpdatedModeViewModel=null,this._dataProblemViewModel=null,this._sessionWidget=null,this._dataSourceHasErrorVisible=null,this._dataSourceErrorCanBeShown=new(n())(!1),this._marketStatusCanBeShown=new(n())(!1),this._dataUpdatedModeCanBeShown=new(n())(!1),this._dataProblemCanBeShown=new(n())(!1),this._isDataProblemCritical=null,this._container=document.createElement("div"),this._menuOpened=!1,this._menuPosition=null,this._handleDropdownMenuClose=()=>{var e;this._menuOpened=!1,null===(e=this._source.symbol())||void 0===e||e.unsubscribe(this._handleDropdownMenuClose),this._updateDropdownMenu()},this._source=e,this._symbol=null!==(s=null===(i=e.symbol())||void 0===i?void 0:i.spawn())&&void 0!==s?s:null,this._options=t,this._recreateWidgets(),this._addSubscriptionForSymbolInvalid(),null!==this._dataSourceHasErrorVisible&&(this._dataSourceHasErrorVisible.subscribe(this._updateStatusWidgetsVisibilities.bind(this)),this._dataSourceHasErrorVisible.subscribe(this._updateErrorWidgetIsShown.bind(this))),
this._options.dataProblemEnabled&&null!==this._isDataProblemCritical&&this._isDataProblemCritical.subscribe(this._updateStatusWidgetsVisibilities.bind(this));for(const e of this._tooltipSpawns)e.subscribe(this._updateTooltips.bind(this));for(const e of this._visibilitySpawns)e.subscribe(this._updateVisibleWidgetsCount.bind(this)),e.subscribe(this._updateTooltips.bind(this));this._updateErrorWidgetIsShown(),this._updateStatusWidgetsVisibilities(),this._updateVisibleWidgetsCount(),this._updateTooltips()}destroy(){var e,t;this._source.destroy(),null===(e=this._symbol)||void 0===e||e.destroy(),null===(t=this._isDataProblemCritical)||void 0===t||t.destroy();for(const e of this._tooltipSpawns)e.destroy();for(const e of this._visibilitySpawns)e.destroy();this.visibleWidgetsCount.unsubscribe();for(const e of this._statusWidgetInfos)e.model.destroy();this._renderer.destroy()}getElement(){return this._renderer.element}updateSource(e){var t,i,s;this._source!==e&&(null===(t=this._symbol)||void 0===t||t.destroy(),this._source.destroy(),this._source=e,this._symbol=null!==(s=null===(i=e.symbol())||void 0===i?void 0:i.spawn())&&void 0!==s?s:null,this._recreateWidgets(),this._updateStatusWidgetsVisibilities(),this._updateErrorWidgetIsShown(),this._updateVisibleWidgetsCount(),this._updateTooltips())}_updateStatusWidgetsVisibilities(){const e=this._isForceStatusActive();this._dataSourceErrorCanBeShown.setValue(!e),this._marketStatusCanBeShown.setValue(!e),this._dataUpdatedModeCanBeShown.setValue(!e),this._dataProblemCanBeShown.setValue(!this._isPrimaryWidgetShown())}_isPrimaryWidgetShown(){var e,t;return null!==(t=null===(e=this._source.isSymbolInvalid())||void 0===e?void 0:e.value())&&void 0!==t&&t}_isForceStatusActive(){var e,t;return this._isPrimaryWidgetShown()||null!==(t=null===(e=this._isDataProblemCritical)||void 0===e?void 0:e.value())&&void 0!==t&&t}_updateVisibleWidgetsCount(){const e=this._statusWidgetInfos.filter((e=>e.visible.value()));this.visibleWidgetsCount.setValue(e.length)}_updateTooltips(){const e=[];for(let t=0;t<this._tooltipSpawns.length;t++){if(!this._visibilitySpawns[t].value())continue;const i=this._tooltipSpawns[t].value();null!==i&&i.length>0&&e.push(i)}this._tooltips.setValue(e)}_recreateWidgets(){var e,t,i;if(this._options.sourceStatusesEnabled){const e=this._source.isSymbolInvalid();if(null!==e)if(null===this._symbolInvalidViewModel){this._symbolInvalidViewModel=new Ti(e,{tooltipMap:Bi,iconMap:Wi,classNameMap:Hi,titleMap:Di,titleColorMap:zi,htmlMap:Ii,actionMap:Ni,size:this._size});const t=this._symbolInvalidViewModel.visible().spawn();this._visibilitySpawns.push(t),this._tooltipSpawns.push(this._symbolInvalidViewModel.tooltip().spawn());const i={visible:t,model:this._symbolInvalidViewModel};this._statusWidgetInfos.push(i),this._renderer.addStatusModel(i)}else this._symbolInvalidViewModel.updateStatus(e),this._addSubscriptionForSymbolInvalid();if(null===this._dataSourceErrorStatusViewModel){this._dataSourceErrorStatusViewModel=new Si(this._source,this._size,this._options.sourceStatuses),
this._dataSourceHasErrorVisible=(0,X.combine)((()=>this._dataSourceErrorCanBeShown.value()&&(0,l.ensureNotNull)(this._dataSourceErrorStatusViewModel).visible().value()),this._dataSourceErrorCanBeShown,this._dataSourceErrorStatusViewModel.visible()),this._visibilitySpawns.push(this._dataSourceHasErrorVisible),this._tooltipSpawns.push(this._dataSourceErrorStatusViewModel.tooltip().spawn());const e={visible:this._dataSourceHasErrorVisible,model:this._dataSourceErrorStatusViewModel};this._statusWidgetInfos.push(e),this._renderer.addStatusModel(e)}else this._dataSourceErrorStatusViewModel.setSource(this._source)}if(this._options.marketStatusEnabled){const t=this._source.marketStatusModel();if(null===this._marketStatusViewModel){this._marketStatusViewModel=new Ri.MarketStatusViewModel(t,this._size);const e=(0,X.combine)((()=>this._marketStatusCanBeShown.value()&&(0,l.ensureNotNull)(this._marketStatusViewModel).visible().value()&&!(0,Ke.isEconomicSymbol)(this._source.symbolInfo().value())),this._marketStatusCanBeShown,this._marketStatusViewModel.visible(),this._source.symbolInfo());this._visibilitySpawns.push(e),this._tooltipSpawns.push(this._marketStatusViewModel.tooltip().spawn());const i={visible:e,model:this._marketStatusViewModel};null!==t&&(this._sessionWidget=new vt.FullSessionScheduleWidget(this._source),i.additionalWidgets=[this._sessionWidget]),this._statusWidgetInfos.push(i),this._renderer.addStatusModel(i)}else this._marketStatusViewModel.setModel(t),null===(e=this._sessionWidget)||void 0===e||e.updateSource(this._source)}if(this._options.dataUpdateModeEnabled){const e=this._source.dataUpdatedModeModel();if(null===this._dataUpdatedModeViewModel){const s={...this._options.dataUpdateMode,shouldBeHiddenRegardlessOfStatus:null===(i=null===(t=this._source.marketStatusModel())||void 0===t?void 0:t.futuresContractExpirationTime())||void 0===i?void 0:i.expired()};this._dataUpdatedModeViewModel=new ci(e,this._size,s);const o=(0,X.combine)((()=>this._dataUpdatedModeCanBeShown.value()&&(0,l.ensureNotNull)(this._dataUpdatedModeViewModel).visible().value()&&!(0,Ke.isEconomicSymbol)(this._source.symbolInfo().value())),this._dataUpdatedModeCanBeShown,this._dataUpdatedModeViewModel.visible(),this._source.symbolInfo());this._visibilitySpawns.push(o),this._tooltipSpawns.push(this._dataUpdatedModeViewModel.tooltip().spawn());const n={visible:o,model:this._dataUpdatedModeViewModel};this._statusWidgetInfos.push(n),this._renderer.addStatusModel(n)}else this._dataUpdatedModeViewModel.setModel(e)}if(this._options.dataProblemEnabled){const e=this._source.dataProblemModel();if(null===this._dataProblemViewModel){this._dataProblemViewModel=new xi(e,this._size),this._isDataProblemCritical=this._dataProblemViewModel.isDataProblemCritical().spawn();const t=(0,X.combine)((()=>this._dataProblemCanBeShown.value()&&(0,l.ensureNotNull)(this._dataProblemViewModel).visible().value()),this._dataProblemCanBeShown,this._dataProblemViewModel.visible());this._visibilitySpawns.push(t),this._tooltipSpawns.push(this._dataProblemViewModel.tooltip().spawn())
;const i={visible:t,model:this._dataProblemViewModel};this._statusWidgetInfos.push(i),this._renderer.addStatusModel(i)}else this._dataProblemViewModel.setModel(e)}}_addSubscriptionForSymbolInvalid(){const e=this._source.isSymbolInvalid();this._options.sourceStatusesEnabled&&null!==e&&(e.subscribe(this._updateStatusWidgetsVisibilities.bind(this)),e.subscribe(this._updateErrorWidgetIsShown.bind(this),{callWithLast:!0}))}_updateErrorWidgetIsShown(){var e,t,i,s;const l=null!==(t=null===(e=this._source.isSymbolInvalid())||void 0===e?void 0:e.value())&&void 0!==t&&t,o=null!==(s=null===(i=this._dataSourceHasErrorVisible)||void 0===i?void 0:i.value())&&void 0!==s&&s;this.errorWidgetIsShown.setValue(l||o)}_handleToggleDropdown(e){var t,i;this._menuPosition=e,this._menuOpened=!this._menuOpened,this._menuOpened&&(null===(t=this._source.symbol())||void 0===t||t.subscribe(this._handleDropdownMenuClose),i=`Open full tooltip for statuses: ${this._tooltips.value().join(", ")}`,(0,T.trackEvent)("GUI","Statuses widget's action",i)),this._updateDropdownMenu()}_updateDropdownMenu(){Promise.all([i.e(7624),i.e(6092),i.e(12397),i.e(38643)]).then(i.bind(i,285167)).then((e=>{e.render(this._menuOpened,this._container,this._renderer.element,this._statusWidgetInfos,this._handleDropdownMenuClose,(0,l.ensureNotNull)(this._menuPosition))}))}}var Fi=i(13718),qi=i(635561);const ji=x.t(null,void 0,i(504671)),Ui=x.t(null,void 0,i(410153)),$i=x.t(null,void 0,i(351811)),Ki=x.t(null,void 0,i(91757)),Yi=x.t(null,void 0,i(385020)),Zi=x.t(null,void 0,i(641851)),Xi=new Map([[Fi.ReplayStatus.Pause,new Map([["small",qi],["medium",qi],["large",qi]])],[Fi.ReplayStatus.PointSelect,new Map([["small",qi],["medium",qi],["large",qi]])],[Fi.ReplayStatus.AutoPlay,new Map([["small",qi],["medium",qi],["large",qi]])]]),Ji=new Map([[Fi.ReplayStatus.AutoPlay,Ot.replayModeAutoPlay],[Fi.ReplayStatus.Pause,Ot.replayModePause],[Fi.ReplayStatus.PointSelect,Ot.replayModePointSelect]]),Qi=new Map([[Fi.ReplayStatus.AutoPlay,Ui],[Fi.ReplayStatus.Pause,Ui],[Fi.ReplayStatus.PointSelect,Ui]]),es=new Map([[Fi.ReplayStatus.AutoPlay,Ui],[Fi.ReplayStatus.Pause,$i],[Fi.ReplayStatus.PointSelect,ji]]),ts=new Map([[Fi.ReplayStatus.AutoPlay,(0,bt.getHexColorByName)("color-replay-mode")],[Fi.ReplayStatus.Pause,(0,bt.getHexColorByName)("color-replay-mode")],[Fi.ReplayStatus.PointSelect,(0,bt.getHexColorByName)("color-replay-mode-point-select")]]),is=new Map([[Fi.ReplayStatus.AutoPlay,[Yi]],[Fi.ReplayStatus.Pause,[Zi]],[Fi.ReplayStatus.PointSelect,[Ki]]]);class ss extends ft.StatusViewModel{constructor(e,t){super({iconMap:Xi,classNameMap:Ji,tooltipMap:es,titleMap:Qi,titleColorMap:ts,htmlMap:is,size:t}),this._replayStatus=new(n())(Fi.ReplayStatus.Undefined).spawn(),this._replayStatus=e,this._replayStatus.subscribe(this._updateStatus.bind(this),{callWithLast:!0})}destroy(){this._replayStatus.destroy()}_updateStatus(e){this._status.setValue(e!==Fi.ReplayStatus.Undefined?e:null),this.isBlinkingMode.setValue(e===Fi.ReplayStatus.AutoPlay)}}var ls=i(223167),os=i(463346);class ns{constructor(e,t){
this._symbol=null,this._isSymbolInvalid=null,this._symbolInfo=new(n())(null).spawn(),this._source=e,e.properties().hasChild("symbol")&&(this._symbol=(0,j.createWVFromGetterAndSubscription)((()=>e.properties().symbol.value()),e.properties().symbol.listeners()));const i=[];if((0,os.isStudyLineTool)(e))i.push(e.onStatusChanged());else if((0,we.isStudy)(e)||(0,we.isStudyStub)(e))this._isSymbolInvalid=(0,ls.createWVFromGetterAndSubscriptions)((()=>e.isSymbolInvalid()&&e.isActualInterval()),i),i.push(e.onStatusChanged(),e.onIsActualIntervalChange());else{(0,l.assert)(e===t.mainSeries());const s=t.mainSeries();this._isSymbolInvalid=(0,j.createWVFromGetterAndSubscription)((()=>s.isSymbolInvalid()),s.onStatusChanged()),i.push(s.onStatusChanged()),this._symbolInfo=(0,j.createWVFromGetterAndSubscription)(s.symbolInfo.bind(s),s.dataEvents().symbolResolved())}this._dataSourceErrorStatus=(0,ls.createWVFromGetterAndSubscriptions)((()=>this._source.statusProvider({}).errorStatus()),i)}destroy(){var e,t;null===(e=this._symbol)||void 0===e||e.destroy(),null===(t=this._isSymbolInvalid)||void 0===t||t.destroy(),this._dataSourceErrorStatus.destroy(),this._symbolInfo.destroy()}symbol(){return this._symbol}isSymbolInvalid(){return this._isSymbolInvalid}errorStatus(){return this._dataSourceErrorStatus}symbolInfo(){return this._symbolInfo}marketStatusModel(){return this._source.marketStatusModel()}dataProblemModel(){return this._source.dataProblemModel()}dataUpdatedModeModel(){return this._source.dataUpdatedModeModel()}}class as extends Gi{constructor(e,t,i){if(super(new ns(e,t),i),this._isInReplay=new(n())(!1).readonly().spawn(),this._isInReplayCanBeShown=null,this._inited=!1,this._options.sourceStatusesEnabled){this._isInReplayCanBeShown=new(n())(!1),this._isInReplay=(0,X.combine)((e=>e!==Fi.ReplayStatus.Undefined),t.replayStatus());const e=new ss(t.replayStatus().spawn(),this._size),i=(0,X.combine)((()=>(0,l.ensureNotNull)(this._isInReplayCanBeShown).value()&&(0,l.ensureNotNull)(e).visible().value()),this._isInReplayCanBeShown,e.visible());i.subscribe(this._updateStatusWidgetsVisibilities.bind(this)),i.subscribe(this._updateVisibleWidgetsCount.bind(this)),i.subscribe(this._updateTooltips.bind(this)),this._visibilitySpawns.push(i);const s=e.tooltip().spawn();s.subscribe(this._updateTooltips.bind(this)),this._tooltipSpawns.push(s);const o={visible:i,model:e};this._statusWidgetInfos.push(o),this._renderer.addStatusModel(o),this._inited=!0,this._isInReplay.subscribe(this._updateStatusWidgetsVisibilities.bind(this),{callWithLast:!0})}}destroy(){this._options.sourceStatusesEnabled&&this._isInReplay.destroy(),super.destroy()}_updateStatusWidgetsVisibilities(){var e,t;super._updateStatusWidgetsVisibilities(),this._options.sourceStatusesEnabled&&this._inited&&(0,l.ensureNotNull)(this._isInReplayCanBeShown).setValue(!super._isPrimaryWidgetShown()&&null!==(t=null===(e=this._isInReplay)||void 0===e?void 0:e.value())&&void 0!==t&&t)}_isPrimaryWidgetShown(){var e,t
;return super._isPrimaryWidgetShown()||null!==(t=null===(e=this._isInReplay)||void 0===e?void 0:e.value())&&void 0!==t&&t}}var rs=i(440135),ds=i(343370);const us={readOnlyMode:!1,contextMenu:{settings:!0,mainSeries:!0,studies:!0,showOpenMarketStatus:!1},symbolMarkerEnabled:!1,showToggleButton:!0,canShowSourceCode:!1,statusesWidgets:{sourceStatusesEnabled:!1,sourceStatuses:{errorSolution:!0},marketStatusEnabled:!1,marketStatus:{preMarketSolution:!0,postMarketSolution:!0},dataUpdateModeEnabled:!1,dataUpdateMode:{subscriptionFullInfo:!0},dataProblemEnabled:!1}},hs=d.enabled("hide_legend_by_default"),cs=d.enabled("fundamental_widget"),ps=d.enabled("legend_context_menu"),_s=2*parseInt(S.marginlegendhoriz);class ms{constructor(e,t,i,s,l,o,r,d){this._mainSeriesViewModel=null,this._dataSourceViewModels=[],this._visibleDataSourceCount=new(n())(0),this._themedColor=new(n())(""),this._mainSeriesRowHidden=null,this._dataSourceRowsHidden=[],this._customWidgetsVisibilities=[],this._allLegendHidden=new(n())(!1),this._studiesLegendHidden=new(n())(!1),this._customWidgetsHeights=[],this._onLegendVisibilityToggled=null,this._availableHeight=0,this._collapsedDataSourcesCount=new(n())(0),this._collapsedDataSourcesTitle=new(n())(""),this._mainSeriesStatusWidget=null,this._dataSourcesStatusesWidgets=[],this._size=null,this._customLegendWidgetsFactoriesMap=new Map,this._customLegendWidgetsMap=new Map,this._margin=0,this._model=e,this._paneWidget=t,this._options=(0,a.merge)((0,a.clone)(us),r),this._callbacks=d,this._mainSeriesViewModelsOptions={readOnlyMode:this._options.readOnlyMode,symbolMarkerEnabled:this._options.symbolMarkerEnabled},this._dataSourceViewModelsOptions={...this._mainSeriesViewModelsOptions,canShowSourceCode:this._options.canShowSourceCode},this._backgroundThemeName=i;const u=this._showLegendCalculatedProperty();if(this._isDataSourcesCollapsed=new(n())(u.value()),u.subscribe(this,(()=>{this._isDataSourcesCollapsed.setValue(u.value())})),hs&&!Ct.getBool("legend.isVisibilityToggled")){const e=this._showLegendOriginalProperty();this._onLegendVisibilityToggled=this._setLegendVisibilityToggled.bind(this),e.setValue(!1),e.subscribe(this,this._onLegendVisibilityToggled)}const h=new(n())(this._getCustomTextColorValue()),c=this._model.model().properties().childs();c.scalesProperties.childs().textColor.subscribe(this,(()=>{h.setValue(this._getCustomTextColorValue())}));const p=c.paneProperties.childs().legendProperties.childs().showBackground,_=new(n())(p.value());p.subscribe(this,(()=>{_.setValue(p.value())}));const m=c.paneProperties.childs().legendProperties.childs().backgroundTransparency,g=new(n())(m.value());m.subscribe(this,(()=>{g.setValue(m.value())})),this._hideNotMainSources=s,this._hideNotMainSources.subscribe(this._updateLegendVisibilities.bind(this)),this._hideAllExceptFirstLine=l,this._hideAllExceptFirstLine.subscribe(this._updateCollapsedSourcesMode.bind(this)),this._hideWholeLegend=o,this._hideWholeLegend.subscribe(this._updateLegendVisibilities.bind(this)),this._isPaneMain=new(n())(this._getIsPaneMainValue()),
this._updateCollapsedSourcesModeThrottle=(0,ds.default)(this._updateCollapsedSourcesMode.bind(this),100),this._renderer=new F({withActions:!this._options.readOnlyMode,showToggleButton:this._options.showToggleButton,isStudiesLegendHidden:this._studiesLegendHidden.readonly(),isAllLegendHidden:this._allLegendHidden.readonly(),customTextColor:h.readonly(),themedColor:this._themedColor.readonly(),showBackground:_.readonly(),backgroundTransparency:g.readonly(),collapsedDataSourcesCount:this._collapsedDataSourcesCount.readonly(),collapsedDataSourcesTitle:this._collapsedDataSourcesTitle.readonly(),showLegendWidgetContextMenu:this.onShowLegendWidgetContextMenu.bind(this),hideAllExceptFirstLine:this._hideAllExceptFirstLine},{visibleDataSourceCount:this._visibleDataSourceCount.readonly(),isDataSourcesCollapsed:this._isDataSourcesCollapsed.readonly(),showObjectsTree:this._isPaneMain.readonly(),onCollapseDataSources:this.onCollapseDataSources.bind(this),onShowObjectsTreeDialog:this._callbacks.showObjectsTreeDialog})}destroy(){this._backgroundThemeName.destroy(),this._hideNotMainSources.destroy(),this._hideAllExceptFirstLine.destroy(),this._hideWholeLegend.destroy(),null!==this._mainSeriesViewModel&&this._destroyMainDataSource();for(const e of this._dataSourceViewModels)e.destroy();for(const e of this._dataSourcesStatusesWidgets)e.destroy();this._clearSubscriptions();for(const e of Array.from(this._customLegendWidgetsMap.keys()))this._destroyCustomWidgetFromLayerBlock(e);this._customLegendWidgetsMap.clear(),this._renderer.destroy(),delete this._renderer,this._showLegendCalculatedProperty().unsubscribeAll(this),this._showLegendOriginalProperty().unsubscribeAll(this);const e=this._model.model().properties().childs();e.scalesProperties.childs().textColor.unsubscribeAll(this),e.paneProperties.childs().legendProperties.childs().showBackground.unsubscribeAll(this),e.paneProperties.childs().legendProperties.childs().backgroundTransparency.unsubscribeAll(this)}addCustomWidgetToLegend(e,t){const i=this._customLegendWidgetsFactoriesMap.get(t.block)||new Map,s=i.get(t.position)||[];s.push(e),i.set(t.position,s),this._customLegendWidgetsFactoriesMap.set(t.block,i),this.updateLayout(),this._updateCustomWidgetModeBySize()}onShowLegendWidgetContextMenu(e,t){if(this._options.readOnlyMode||!ps)return Promise.resolve();P("Show legend context menu");const i=new Map;for(const e of Array.from(this._customLegendWidgetsMap.keys())){const t=(0,l.ensureDefined)(this._customLegendWidgetsMap.get(e)),s=new Map;for(const e of Array.from(t.keys())){const i=(0,l.ensureDefined)(t.get(e)),o=s.get(e)||[];for(const e of i)o.push(...e.contextMenuActions());s.set(e,o)}i.set(e,s)}return function(e,t,i,s,l,o){const n=[],a=s.get(0);if(void 0!==a){const e=a.get(1);void 0!==e&&e.length>0&&(n.push(...e),n.push(new Ue.Separator))}const r=e.model().properties().childs().paneProperties.childs().legendProperties.childs();if(n.push(new Ue.Action({actionId:"Chart.Legend.ToggleSymbolVisibility",checkable:!0,checked:r.showSeriesTitle.value(),label:rt,statName:"Show Symbol",
onExecute:()=>Qe(e,r.showSeriesTitle,et)})),t.showOpenMarketStatus&&"market"===e.mainSeries().marketStatusModel().status().value()&&!(0,Ke.isEconomicSymbol)(e.mainSeries().symbolInfo())&&n.push(new Ue.Action({actionId:"Chart.Legend.ToggleOpenMarketStatusVisibility",checkable:!0,checked:Ye.showMarketOpenStatusProperty.value(),label:dt,statName:"Show Open market status",onExecute:()=>Qe(e,Ye.showMarketOpenStatusProperty,tt)})),n.push(new Ue.Action({actionId:"Chart.Legend.ToggleOhlcValuesVisibility",checkable:!0,checked:r.showSeriesOHLC.value(),label:ut,statName:"Show OHLC Values",onExecute:()=>Qe(e,r.showSeriesOHLC,it)})),n.push(new Ue.Action({actionId:"Chart.Legend.ToggleBarChangeValuesVisibility",checkable:!0,checked:r.showBarChange.value(),label:ht,statName:"Show Bar Change Values",onExecute:()=>Qe(e,r.showBarChange,st)})),n.push(new Ue.Action({actionId:"Chart.Legend.ToggleVolumeVisibility",checkable:!0,checked:r.showVolume.value(),label:ct,statName:"Show Volume",onExecute:()=>Qe(e,r.showVolume,at)})),n.push(new Ue.Separator),void 0!==a){const e=a.get(0);void 0!==e&&e.length>0&&(n.push(...e),n.push(new Ue.Separator))}const d=s.get(1);if(void 0!==d){const e=d.get(1);void 0!==e&&e.length>0&&(n.push(...e),n.push(new Ue.Separator))}if(e.model().priceDataSources().some((e=>!(0,Xe.isActingAsSymbolSource)(e)&&e.showInObjectTree()))&&(n.push(new Ue.Action({actionId:"Chart.Legend.ToggleIndicatorTitlesVisibility",checkable:!0,checked:r.showStudyTitles.value(),label:pt,statName:"Show Indicator Titles",onExecute:()=>Qe(e,r.showStudyTitles,lt)})),n.push(new Ue.Action({actionId:"Chart.Legend.ToggleIndicatorArgumentsVisibility",checkable:!0,checked:r.showStudyArguments.value(),label:_t,statName:"Show Indicator Arguments",onExecute:()=>Qe(e,r.showStudyArguments,ot)})),n.push(new Ue.Action({actionId:"Chart.Legend.ToggleIndicatorValuesVisibility",checkable:!0,checked:r.showStudyValues.value(),label:mt,statName:"Show Indicator Values",onExecute:()=>Qe(e,r.showStudyValues,nt)}))),void 0!==d){const e=d.get(0);void 0!==e&&e.length>0&&(n.push(...e),n.push(new Ue.Separator))}return t.settings&&(n[n.length-1]instanceof Ue.Separator||n.push(new Ue.Separator),n.push(new Ue.Action({actionId:"Chart.Dialogs.ShowGeneralSettings.LegendTab",label:gt,icon:Je,statName:"Settings...",onExecute:()=>i(ae.TabNames.legend)}))),$e.ContextMenuManager.showMenu(n,l,void 0,{menuName:"LegendPropertiesContextMenu"},o)}(this._model,this._options.contextMenu,this._callbacks.showGeneralChartProperties,i,e,t)}onCollapseDataSources(){const e=this._showLegendOriginalProperty();e.setValue(!e.value())}updateLayout(){const e=this._paneWidget.state().sourcesByGroup().legendViewSources().filter((e=>null!==e.statusView()&&e.isDisplayedInLegend()));if(0===e.length)return;const t=this._model.mainSeries(),i=e.indexOf(t);i>-1?(e.splice(i,1),cs||null!==this._mainSeriesViewModel||(this._mainSeriesViewModel=new be(this._model,t,this._mainSeriesViewModelsOptions,this._callbacks,this._options.contextMenu),
this._mainSeriesStatusWidget=new as(t,this._model.model(),this._options.statusesWidgets),this._renderer.addMainDataSource(this._mainSeriesViewModel,this._mainSeriesStatusWidget)),this._addCustomWidgetForLayerBlock(0)):null!==this._mainSeriesViewModel&&(this._destroyMainDataSource(),this._destroyCustomWidgetFromLayerBlock(0));const s=[],o=[],n=this._dataSourceViewModels.length;if(0===n)for(let t=e.length-1;t>=0;t--){const i=e[t];s.push(new je(this._model,i,this._dataSourceViewModelsOptions,this._callbacks,this._options.contextMenu)),o.push(new Gi(new ns(i,this._model.model()),this._options.statusesWidgets))}else{let t=0;for(let i=e.length-1;i>=0;i--){const l=e[i];this._dataSourceViewModels[t]?(this._dataSourceViewModels[t].updateSource(l),this._dataSourcesStatusesWidgets[t].updateSource(new ns(l,this._model.model()))):(s.push(new je(this._model,l,this._dataSourceViewModelsOptions,this._callbacks,this._options.contextMenu)),o.push(new Gi(new ns(e[i],this._model.model()),this._options.statusesWidgets))),t++}for(;this._dataSourceViewModels.length>t;)(0,l.ensureDefined)(this._dataSourceViewModels.pop()).destroy();for(;this._dataSourcesStatusesWidgets.length>t;)(0,l.ensureDefined)(this._dataSourcesStatusesWidgets.pop()).destroy()}0!==s.length&&(this._renderer.addDataSources(s,o),this._dataSourceViewModels.push(...s),this._dataSourcesStatusesWidgets.push(...o)),n!==this._dataSourceViewModels.length&&this._updateCollapsedSourcesMode(),this._dataSourceViewModels.length>0?this._addCustomWidgetForLayerBlock(1):this._destroyCustomWidgetFromLayerBlock(1),this._recreateSubscriptions(),this._isPaneMain.setValue(this._getIsPaneMainValue()),this.update(),this._updateWidgetModeByWidth()}update(){null!==this._mainSeriesViewModel&&this._mainSeriesViewModel.update();for(const e of this._dataSourceViewModels)e.update()}updateThemedColors(e){null===e&&(e=(0,rs.getStdThemedValue)("chartProperties.paneProperties.background",this._backgroundThemeName.value())),this._themedColor.setValue(e||"")}firstTitle(){return this._renderer.firstTitle()}getElement(){return this._renderer.getElement()}addMargin(e){if(this._margin===e)return;this._margin=e;this._renderer.getElement().style.maxWidth=0===this._margin?"":`calc(100% - ${this._margin+_s}px)`,this._updateWidgetModeBySize()}updateWidgetModeBySize(e){this._size=e,this._updateWidgetModeBySize()}_updateWidgetModeBySize(){this._updateWidgetModeByWidth(),this._updateWidgetModeByHeight(),this._updateCustomWidgetModeBySize()}_updateWidgetModeByWidth(){if(null===this._size)return;const e=this._availableWidth();this._renderer.updateMode(e),this._paneWidget.hasState()&&this._paneWidget.state().containsMainSeries()&&this._model.mainSeries().setTextSourceIsAlwaysTickerRestrictionEnabled(e<=132)}_updateWidgetModeByHeight(){null!==this._size&&(this._availableHeight=.8*this._size.height,this._updateCollapsedSourcesModeThrottle())}_updateCustomWidgetModeBySize(){if(null===this._size)return;const e=(0,s.size)({width:this._availableWidth(),height:this._size.height})
;for(const t of Array.from(this._customLegendWidgetsMap.values()))for(const i of Array.from(t.values()))for(const t of i)t.updateWidgetModeBySize(e)}_destroyMainDataSource(){(0,l.ensureNotNull)(this._mainSeriesStatusWidget).destroy(),this._mainSeriesStatusWidget=null,(0,l.ensureNotNull)(this._mainSeriesViewModel).destroy(),this._mainSeriesViewModel=null}_updateCollapsedSourcesMode(){const e=this._dataSourceViewModels.length,t=this._hideAllExceptFirstLine.value();if(this._availableHeight>0&&e>2){const i=Number(this._renderer.getMainSourceHeight()),s=this._renderer.getDataSourceHeight(),l=this._getCustomWidgetsHeight();if(null!==s){const o=Math.floor((this._availableHeight-i-l)/s),n=Math.max(o,2)-1;if(e>n+1){let i="";for(let s=0;s<e;s++){const e=s<n;this._dataSourceViewModels[s].setGlobalVisibility(e&&(!t||0===s)),e||(i+=`${0===i.length?"":", "}${this._dataSourceViewModels[s].getFullTitle()}`)}return this._collapsedDataSourcesTitle.setValue(i),void this._collapsedDataSourcesCount.setValue(e-n)}}}for(let e=0;e<this._dataSourceViewModels.length;++e)this._dataSourceViewModels[e].setGlobalVisibility(!t||0===e);this._collapsedDataSourcesCount.setValue(0),this._collapsedDataSourcesTitle.setValue("")}_getCustomWidgetsHeight(){let e=0;for(const t of Array.from(this._customLegendWidgetsMap.values()))for(const i of Array.from(t.values()))for(const t of i)e+=t.height().value();return e}_getCustomTextColorValue(){const e=this._model.model().properties().childs().scalesProperties.childs().textColor.value();return(0,rs.isStdThemedDefaultValue)("chartProperties.scalesProperties.textColor",e,(0,rs.getCurrentTheme)().name)?null:e}_clearSubscriptions(){null!==this._mainSeriesRowHidden&&(this._mainSeriesRowHidden.destroy(),this._mainSeriesRowHidden=null);for(const e of this._dataSourceRowsHidden)e.destroy();this._dataSourceRowsHidden=[];for(const e of this._customWidgetsVisibilities)e.destroy();this._customWidgetsVisibilities=[];for(const e of this._customWidgetsHeights)e.destroy();this._customWidgetsHeights=[]}_recreateSubscriptions(){this._clearSubscriptions(),null!==this._mainSeriesViewModel&&(this._mainSeriesRowHidden=this._mainSeriesViewModel.isRowHidden().spawn(),this._mainSeriesRowHidden.subscribe(this._updateLegendVisibilities.bind(this)));for(const e of this._dataSourceViewModels){const t=e.isRowHidden().spawn();this._dataSourceRowsHidden.push(t),t.subscribe(this._updateVisibleDataSourceCount.bind(this)),t.subscribe(this._updateLegendVisibilities.bind(this))}for(const e of Array.from(this._customLegendWidgetsMap.values()))for(const t of Array.from(e.values()))for(const e of t){const t=e.visibility().spawn();this._customWidgetsVisibilities.push(t),t.subscribe(this._updateLegendVisibilities.bind(this));const i=e.height().spawn();this._customWidgetsHeights.push(i),i.subscribe(this._updateCollapsedSourcesMode.bind(this))}this._updateVisibleDataSourceCount(),this._updateLegendVisibilities()}_updateLegendVisibilities(){if(this._hideWholeLegend.value())return void this._allLegendHidden.setValue(!0)
;const e=this._dataSourceRowsHidden.every((e=>e.value())),t=this._hideNotMainSources.value()||e;this._studiesLegendHidden.setValue(t);const i=null===this._mainSeriesRowHidden||this._mainSeriesRowHidden.value(),s=this._customWidgetsVisibilities.some((e=>e.value()));this._allLegendHidden.setValue(e&&i&&!s)}_updateVisibleDataSourceCount(){const e=this._dataSourceRowsHidden.filter((e=>!e.value())).length;this._visibleDataSourceCount.setValue(e)}_setLegendVisibilityToggled(){Ct.setValue("legend.isVisibilityToggled",!0);this._showLegendOriginalProperty().unsubscribe(this,(0,l.ensureNotNull)(this._onLegendVisibilityToggled))}_getIsPaneMainValue(){return this._paneWidget.containsMainSeries()}_showLegendCalculatedProperty(){return this._model.model().showLegend()}_showLegendOriginalProperty(){return this._model.model().properties().childs().paneProperties.childs().legendProperties.childs().showLegend}_addCustomWidgetForLayerBlock(e){const t=this._customLegendWidgetsFactoriesMap.get(e);if(void 0===t)return;const i=this._customLegendWidgetsMap.get(e)||new Map;let s=!1;for(const l of Array.from(t.keys())){const o=i.get(l)||[],n=t.get(l)||[];for(let t=o.length;t<n.length;t++){const i=n[t](this._model.model(),this._backgroundThemeName);0===e&&0===l&&i.setGlobalVisibility((0,X.combine)(((e,t)=>!e&&!t),this._hideNotMainSources,this._hideAllExceptFirstLine)),o.push(i),this._renderer.addCustomWidget(i,{block:e,position:l}),s=!0}s&&i.set(l,o)}s&&this._customLegendWidgetsMap.set(e,i)}_destroyCustomWidgetFromLayerBlock(e){const t=this._customLegendWidgetsMap.get(e);if(void 0!==t){for(const e of Array.from(t.values()))for(const t of e)t.destroy();t.clear(),this._customLegendWidgetsMap.delete(e)}}_availableWidth(){return null===this._size?0:this._size.width-this._margin-_s}}},387226:(e,t,i)=>{"use strict";i.d(t,{navigationButtonsVisibilityKey:()=>l,property:()=>o,availableValues:()=>n,actualBehavior:()=>a});var s=i(831356);const l="NavigationButtons.visibility",{property:o,availableValues:n,actualBehavior:a}=(0,s.createVisibilityController)(l)},728730:(e,t,i)=>{"use strict";i.d(t,{property:()=>o,availableValues:()=>n,actualBehavior:()=>a});var s=i(831356),l=i(387226);const{property:o,availableValues:n,actualBehavior:a}=(0,s.createVisibilityController)("PaneButtons.visibility",l.navigationButtonsVisibilityKey)},326883:(e,t,i)=>{"use strict";i.r(t),i.d(t,{PaneControlsWidget:()=>ee});var s=i(778785),l=i(345848),o=i(777754),n=i(470316),a=i(728730),r=i(943221),d=i(650151),u=i(724377),h=i(569421),c=i(473795),p=i(567562),_=i(262927);class m{constructor(e,t,i){this._parentEl=document.createElement("div"),this._listActionsWrapperEl=null,this._listActionsElements={},this._actionsSpawns={},this._onMouseEnterLeaveEventHandler=null,this._mouseOverWidget=!1,this._width=null,this._wrapEl=e,this._onMouseEnterLeaveEventHandler=this._onMouseEnterLeaveEvent.bind(this),this._wrapEl.addEventListener("mouseenter",this._onMouseEnterLeaveEventHandler),this._wrapEl.addEventListener("mouseleave",this._onMouseEnterLeaveEventHandler),this._actions=t,
this._globalVisibility=i.globalVisibility.spawn(),this._globalVisibility.subscribe(this._updatePaneControlsWidgetVisibility.bind(this)),this._visibilityType=i.visibilityType.spawn(),this._visibilityType.subscribe(this._updatePaneControlsWidgetVisibility.bind(this)),this._doNotSwitchToContextMenuMode=i.doNotSwitchToContextMenuMode,this._forceContextMenuMode=i.forceContextMenuMode.spawn(),this._forceContextMenuMode.subscribe(this._updateWidgetMode.bind(this)),this._themedColor=i.themedColor.spawn(),this._themedColor.subscribe(this._updateThemedColor.bind(this));for(const[e,t]of Object.entries(this._actions)){const i=e;this._actionsSpawns[i]={visible:t.visible.spawn(),title:void 0===t.title?null:t.title.spawn()},this._actionsSpawns[i].visible.subscribe(this._updateActionVisibilities.bind(this,i));const s=this._actionsSpawns[i].title;null!==s&&s.subscribe(this._updateActionTitle.bind(this,i))}this._render(),this._updatePaneControlsWidgetVisibility(),this._updateThemedColor(this._themedColor.value()),this._parentEl.classList.toggle(p.touchMode,h.trackingModeIsAvailable),this._parentEl.addEventListener("contextmenu",(e=>e.preventDefault()))}destroy(){this._visibilityType.destroy(),this._forceContextMenuMode.destroy(),this._themedColor.destroy();for(const e of Object.keys(this._actionsSpawns)){const t=e;this._actionsSpawns[t].visible.destroy();const i=this._actionsSpawns[t].title;null!==i&&i.destroy()}null!==this._onMouseEnterLeaveEventHandler&&(this._wrapEl.removeEventListener("mouseenter",this._onMouseEnterLeaveEventHandler),this._wrapEl.removeEventListener("mouseleave",this._onMouseEnterLeaveEventHandler),this._onMouseEnterLeaveEventHandler=null),this._parentEl.innerHTML="",delete this._parentEl}getElement(){return this._parentEl}bottomWithMargin(){const e=this._parentEl.classList.contains(p.touchMode)?Number(p.css_value_pane_controls_button_touch_size):Number(p.css_value_pane_controls_button_size);return 2*Number(p.css_value_pane_controls_margin_top)+e}updateWidgetModeByWidth(e){this._width=e,this._updateWidgetMode()}_updateWidgetMode(){if(null===this._width)return;const e=!this._doNotSwitchToContextMenuMode.value()&&this._width<356,t=!this._doNotSwitchToContextMenuMode.value()&&(this._forceContextMenuMode.value()||this._width<666.65),i=(0,d.ensureNotNull)(this._listActionsWrapperEl),s=(0,d.ensureNotNull)(this._listActionsElements.more);i.classList.toggle(_.blockHidden,e||t),s.classList.toggle(_.blockHidden,e||!t||!this._actions.more.visible.value())}_render(){this._renderActions(),this._parentEl.classList.add(p.paneControls),this._wrapEl.append(this._parentEl)}_renderActions(){null===this._listActionsWrapperEl&&(this._listActionsWrapperEl=document.createElement("div"),this._listActionsWrapperEl.classList.add(p.buttonsWrapper),this._parentEl.append(this._listActionsWrapperEl));const e=h.trackingModeIsAvailable?"large":"small";this._listActionsElements.up=(0,c.createActionElement)(this._actions.up,p.button,p.buttonIcon,_.blockHidden,e),this._listActionsElements.down=(0,
c.createActionElement)(this._actions.down,p.button,p.buttonIcon,_.blockHidden,e),this._listActionsElements.collapse=(0,c.createActionElement)(this._actions.collapse,p.button,p.buttonIcon,_.blockHidden,e),this._listActionsElements.restore=(0,c.createActionElement)(this._actions.restore,p.button,p.buttonIcon,_.blockHidden,e),this._listActionsElements.close=(0,c.createActionElement)(this._actions.close,p.button,p.buttonIcon,_.blockHidden,e),this._listActionsElements.maximize=(0,c.createActionElement)(this._actions.maximize,p.button,p.buttonIcon,_.blockHidden,e),this._listActionsElements.minimize=(0,c.createActionElement)(this._actions.minimize,p.button,p.buttonIcon,_.blockHidden,e),this._listActionsWrapperEl.append(this._listActionsElements.up,this._listActionsElements.down,this._listActionsElements.close,this._listActionsElements.collapse,this._listActionsElements.restore,this._listActionsElements.maximize,this._listActionsElements.minimize),this._listActionsElements.more=(0,c.createActionElement)(this._actions.more,p.button,p.buttonIcon,_.blockHidden,e);for(const e of Object.keys(this._listActionsElements))(0,d.ensureNotNull)(this._listActionsElements[e]).classList.add(p.newButton);this._parentEl.append(this._listActionsElements.more)}_updateActionVisibilities(e,t){(0,d.ensureNotNull)(this._listActionsElements[e]).classList.toggle(_.blockHidden,!t)}_updateActionTitle(e,t){(0,d.ensureNotNull)(this._listActionsElements[e]).setAttribute("title",t)}_onMouseEnterLeaveEvent(e){this._mouseOverWidget="mouseenter"===e.type,"visibleOnMouseOver"===this._visibilityType.value()&&this._updatePaneControlsWidgetVisibility()}_updatePaneControlsWidgetVisibility(){let e,t=!1;switch(this._visibilityType.value()){case"alwaysOff":e=!1,t=!0;break;case"alwaysOn":e=this._globalVisibility.value();break;case"visibleOnMouseOver":e=this._globalVisibility.value()&&this._mouseOverWidget}this._parentEl.classList.toggle(p.hidden,!e),this._parentEl.classList.toggle(p.forceHidden,!this._globalVisibility.value()||t)}_updateThemedColor(e){if(e.length>0){const[t,i,s]=(0,u.parseRgb)(e);this._parentEl.style.color=(0,u.rgbaToString)([t,i,s,(0,u.normalizeAlphaComponent)(.8)])}else this._parentEl.style.removeProperty("color")}}var g=i(310399),v=i(263221),b=i(636016),w=i(472899),y=i(648344),S=i(99539),f=i(520465),M=i(334763);const C=o.t(null,void 0,i(68854)),E=C,V=(0,n.humanReadableModifiers)(n.Modifiers.Mod)+C;var x=i(988411),T=i.n(x),P=i(440135),k=i(604286),L=i(893271),A=i(125226),W=i(572237),H=i(981020),B=i(203515),D=i(279526),z=i(682847),I=i(374362),N=i(970471),O=i(671402),R=i(142930);const G=s.mobiletouch,F=o.t(null,void 0,i(683498)),q=o.t(null,void 0,i(370343)),j=o.t(null,void 0,i(939899)),U=o.t(null,void 0,i(819603)),$=o.t(null,void 0,i(491029)),K=o.t(null,void 0,i(39589)),Y=o.t(null,void 0,i(335732)),Z=o.t(null,void 0,i(68854)),X=(0,k.hotKeySerialize)({keys:[""],text:Z}),J=(0,k.hotKeySerialize)({keys:[(0,n.humanReadableModifiers)(n.Modifiers.Mod,!1)],text:`{0} + ${Z}`}),Q=(0,A.isFeatureEnabled)("collapse_pane_buttons_when_connected_to_broker");class ee{
constructor(e,t,i,s,l){this._actions={},this._moreCMShown=!1,this._themedColor=new(T())(""),this._connectedToBroker=new(T())(!1),this._isDestroyed=!1,this._model=e,this._paneWidget=t,this._callbacks=s,this._closeButtonVisibility=new(T())(this._getCloseButtonVisibility()),this._upButtonVisibility=new(T())(this._getUpButtonVisibility()),this._downButtonVisibility=new(T())(this._getDownButtonVisibility()),this._maximizeButtonVisibility=new(T())(this._getMaximizeButtonVisibility()),this._minimizeButtonVisibility=new(T())(this._getMinimizeButtonVisibility()),this._collapseButtonVisibility=new(T())(this._getCollapseButtonVisibility()),this._restoreButtonVisibility=new(T())(this._getRestoreButtonVisibility()),this._createActions(),this._visibilityTypeProperty=(0,a.actualBehavior)(),this._visibilityTypeProperty.subscribe(this,(e=>{this._visibilityType.setValue(e.value())})),this._visibilityType=new(T())(this._visibilityTypeProperty.value()),this._isPaneMaximize=new(T())(this._getIsPaneMaximizeValue()),this._isWidgetShow=new(T())(this._getIsWidgetShow()),this._backgroundThemeName=i.backgroundThemeName,Q&&this._subscribeOnConnectedToBroker(),this._renderer=new m(l,this._actions,{visibilityType:this._visibilityType.readonly(),globalVisibility:this._isWidgetShow.readonly(),doNotSwitchToContextMenuMode:this._isPaneMaximize.readonly(),forceContextMenuMode:this._connectedToBroker.readonly(),themedColor:this._themedColor.readonly()})}destroy(){var e;Q&&(null===(e=(0,L.tradingService)())||void 0===e||e.onConnectionStatusChange.unsubscribeAll(this)),this._visibilityTypeProperty.unsubscribeAll(this),this._renderer.destroy(),this._isDestroyed=!0}getElement(){return this._renderer.getElement()}bottomWithMargin(){return this._renderer.bottomWithMargin()}action(){return this._actions}update(){this._updateButtonsVisibility(),this._isPaneMaximize.setValue(this._getIsPaneMaximizeValue()),this._isWidgetShow.setValue(this._getIsWidgetShow())}updateWidgetModeByWidth(e){this._renderer.updateWidgetModeByWidth(e)}updateThemedColors(e){null===e&&(e=(0,P.getStdThemedValue)("chartProperties.paneProperties.background",this._backgroundThemeName.value())),this._themedColor.setValue(e||"")}async _subscribeOnConnectedToBroker(){const e=await(0,L.waitTradingService)();this._isDestroyed||(e.onConnectionStatusChange.subscribe(this,this._updateConnectedToBroker.bind(this)),this._updateConnectedToBroker(e.connectStatus()))}_updateConnectedToBroker(e){this._connectedToBroker.setValue(1===e)}_updateButtonsVisibility(){this._closeButtonVisibility.setValue(this._getCloseButtonVisibility()),this._upButtonVisibility.setValue(this._getUpButtonVisibility()),this._downButtonVisibility.setValue(this._getDownButtonVisibility()),this._maximizeButtonVisibility.setValue(this._getMaximizeButtonVisibility()),this._minimizeButtonVisibility.setValue(this._getMinimizeButtonVisibility()),this._collapseButtonVisibility.setValue(this._getCollapseButtonVisibility()),this._restoreButtonVisibility.setValue(this._getRestoreButtonVisibility())}_createActions(){this._actions.up={
iconMap:new Map([["large",H],["small",H]]),action:this._onUpDownButton.bind(this,"up"),visible:this._upButtonVisibility,title:new(T())(q),className:p.up,dataset:{name:"pane-button-up"}},this._actions.down={iconMap:new Map([["large",B],["small",B]]),action:this._onUpDownButton.bind(this,"down"),visible:this._downButtonVisibility,title:new(T())(j),className:p.down,dataset:{name:"pane-button-down"}},this._actions.close={iconMap:new Map([["large",W],["small",W]]),action:this._onCloseButton.bind(this),visible:this._closeButtonVisibility,title:new(T())(F),dataset:{name:"pane-button-close"}},this._actions.maximize={iconMap:new Map([["large",I],["small",D]]),action:this._onToggleMaximizeButton.bind(this,"Maximize pane"),visible:this._maximizeButtonVisibility,title:new(T())(U),hotKeyTitle:X,className:p.maximize,dataset:{name:"pane-button-maximize"}},this._actions.minimize={iconMap:new Map([["large",I],["small",D]]),action:this._onToggleMaximizeButton.bind(this,"Minimize pane"),visible:this._minimizeButtonVisibility,title:new(T())($),hotKeyTitle:X,className:p.minimize,dataset:{name:"pane-button-minimize"}},this._actions.collapse={iconMap:new Map([["large",O],["small",O]]),action:this._onToggleCollapseButton.bind(this,"Collapse pane"),visible:this._collapseButtonVisibility,title:new(T())(K),hotKeyTitle:J,className:p.collapse,dataset:{name:"pane-button-collapse"}},this._actions.restore={iconMap:new Map([["large",R],["small",R]]),action:this._onToggleCollapseButton.bind(this,"Restore pane"),visible:this._restoreButtonVisibility,title:new(T())($),hotKeyTitle:J,className:p.restore,dataset:{name:"pane-button-restore"}},this._actions.more={iconMap:new Map([["large",N],["small",z]]),action:this._showButtonsInContextMenu.bind(this),visible:new(T())(!G),title:new(T())(Y),dataset:{name:"pane-button-more"}}}_getCloseButtonVisibility(){const e=this._paneWidget.state();let t=!1;return e.containsMainSeries()||e.maximized().value()||G||(t=e.dataSources().some((e=>(0,r.isStudy)(e)))),t}_onCloseButton(){this._trackEvent("Delete pane");const e=this._model.model().panes().indexOf(this._paneWidget.state());this._model.removePane(e)}_getUpButtonVisibility(){const e=this._paneWidget.state();return this._model.model().panes().indexOf(e)>0&&!e.maximized().value()&&!G}_getDownButtonVisibility(){const e=this._paneWidget.state(),t=this._model.model().panes();return t.indexOf(e)<t.length-1&&!e.maximized().value()&&!G}_onUpDownButton(e){this._trackEvent(`Move pane ${e}`);const t=this._model.model().panes().indexOf(this._paneWidget.state());this._model.rearrangePanes(t,e)}_getMaximizeButtonVisibility(){const e=this._paneWidget.state();return this._model.model().panes().length>1&&!e.maximized().value()&&!G}_getMinimizeButtonVisibility(){const e=this._paneWidget.state();return this._model.model().panes().length>1&&e.maximized().value()}_getCollapseButtonVisibility(){if(G)return!1;const e=this._paneWidget.state();return!e.maximized().value()&&!e.collapsed().value()&&this._model.model().paneCollapsingAvailable().value()}_getRestoreButtonVisibility(){
const e=this._paneWidget.state();return!e.maximized().value()&&e.collapsed().value()}_onToggleMaximizeButton(e){this._trackEvent(e),this._callbacks.toggleMaximizePane(this._paneWidget)}_onToggleCollapseButton(e){this._trackEvent(e),this._callbacks.toggleCollapsedPane(this._paneWidget)}_showButtonsInContextMenu(e){e.preventDefault(),this._moreCMShown||function(e,t,i){const s=[];if(e.maximize.visible.value()){const t=(0,d.ensure)(e.maximize.title),i=(0,d.ensureNotNull)(e.maximize.action);s.push(new g.Action({actionId:"Chart.PaneControls.MaximizePane",icon:S,label:t.value(),statName:"Maximize Pane",shortcutHint:E,onExecute:()=>i()}))}else if(e.minimize.visible.value()){const t=(0,d.ensure)(e.minimize.title),i=(0,d.ensureNotNull)(e.minimize.action);s.push(new g.Action({actionId:"Chart.PaneControls.MinimizePane",icon:S,label:t.value(),statName:"Minimize Pane",shortcutHint:E,onExecute:()=>i()}))}if(e.collapse.visible.value()){const t=(0,d.ensure)(e.collapse.title),i=(0,d.ensureNotNull)(e.collapse.action);s.push(new g.Action({actionId:"Chart.PaneControls.CollapsePane",icon:f,label:t.value(),statName:"Collapse pane",shortcutHint:V,onExecute:()=>i()}))}if(e.restore.visible.value()){const t=(0,d.ensure)(e.restore.title),i=(0,d.ensureNotNull)(e.restore.action);s.push(new g.Action({actionId:"Chart.PaneControls.RestorePane",icon:M,label:t.value(),statName:"Restore pane",shortcutHint:V,onExecute:()=>i()}))}if(e.up.visible.value()){const t=(0,d.ensure)(e.up.title),i=(0,d.ensureNotNull)(e.up.action);s.push(new g.Action({actionId:"Chart.PaneControls.MovePaneUp",icon:w,label:t.value(),statName:"Move pane up",onExecute:()=>i()}))}if(e.down.visible.value()){const t=(0,d.ensure)(e.down.title),i=(0,d.ensureNotNull)(e.down.action);s.push(new g.Action({actionId:"Chart.PaneControls.MovePaneDown",icon:y,label:t.value(),statName:"Move pane down",onExecute:()=>i()}))}if(e.close.visible.value()){const t=(0,d.ensure)(e.close.title),i=(0,d.ensureNotNull)(e.close.action);s.push(new g.Action({actionId:"Chart.PaneControls.DeletePane",icon:b,label:t.value(),statName:"Delete pane",onExecute:()=>i()}))}const l=(0,d.ensureNotNull)(t.target).getBoundingClientRect();return v.ContextMenuManager.showMenu(s,{clientX:l.right,clientY:l.top+l.height+3,attachToXBy:"right"},void 0,void 0,i)}(this._actions,e,(()=>{this._moreCMShown=!1})).then((()=>{this._moreCMShown=!0}))}_getIsPaneMaximizeValue(){return this._paneWidget.state().maximized().value()}_getIsWidgetShow(){return this._model.model().panes().length>1}_trackEvent(e){(0,l.trackEvent)("GUI","Pane action",e)}}},473795:(e,t,i)=>{"use strict";i.d(t,{createActionElement:()=>l});var s=i(758337);function l(e,t,i,l,o){const n=document.createElement("div");n.className=t,n.classList.toggle(l,!e.visible.value()),Object.assign(n.dataset,e.dataset),void 0!==e.className&&n.classList.add(e.className),void 0!==e.title&&(n.classList.add("apply-common-tooltip"),n.setAttribute("title",e.title.value()),void 0!==e.hotKeyTitle&&(n.dataset.tooltipHotkey=e.hotKeyTitle)),n.addEventListener("touchend",e.action),
n.addEventListener("mousedown",(t=>{0===t.button&&e.action(t)}));const a=document.createElement("div");a.classList.add(i);const r=e.iconMap.get(o)||"";return(0,s.isString)(r)?a.innerHTML=r:a.appendChild(r),n.appendChild(a),n}},947467:(e,t,i)=>{"use strict";async function s(e){(await Promise.all([i.e(83578),i.e(58619),i.e(94710),i.e(88230),i.e(86256),i.e(91901),i.e(59333),i.e(7624),i.e(12275),i.e(33335),i.e(83772),i.e(85761),i.e(64884),i.e(37908),i.e(78707),i.e(33287),i.e(20187),i.e(51907),i.e(62040),i.e(10302),i.e(47523),i.e(36509),i.e(64566),i.e(23879),i.e(95882),i.e(53549),i.e(31429),i.e(62073),i.e(95204),i.e(61932)]).then(i.bind(i,143372))).openExchangeAgreementDialog(e)}i.d(t,{showExchangeAgreementDialog:()=>s})},252506:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 2 30 24" width="30" height="24" fill="none"><path fill="currentColor" fill-rule="evenodd" clip-rule="evenodd" d="M15.82 14l5.36-5.36-.82-.82L15 13.18 9.64 7.82l-.82.82L14.18 14l-5.36 5.36.82.82L15 14.82l5.36 5.36.82-.82L15.82 14z"/></svg>'},488658:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 22" width="24" height="22" fill="none"><path fill="currentColor" fill-rule="evenodd" clip-rule="evenodd" d="M17.35 6.35l-10 10-.7-.7 10-10 .7.7z"/><path fill="currentColor" fill-rule="evenodd" clip-rule="evenodd" d="M6.65 6.35l10 10 .7-.7-10-10-.7.7z"/></svg>'},841674:e=>{
e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 22" width="30" height="24" fill="none"><g fill="currentColor" fill-rule="evenodd" clip-rule="evenodd" class="normal-eye"><path d="M18 7.91C16.7 6.5 14.7 5 12 5S7.3 6.49 6 7.91C6 7.91 4 10 4 11s2 3.09 2 3.09C7.3 15.5 9.3 17 12 17s4.7-1.49 6-2.91c0 0 2-2.09 2-3.09s-2-3.09-2-3.09zm-11.26 5.5C7.94 14.74 9.7 16 12 16s4.05-1.26 5.25-2.59c0 0 1.75-1.91 1.75-2.41 0-.5-1.75-2.41-1.75-2.41C16.05 7.26 14.3 6 12 6S7.95 7.26 6.74 8.59C6.74 8.59 5 10.5 5 11c0 .5 1.74 2.41 1.74 2.41z"/><path d="M12 13a2 2 0 1 0 0-4 2 2 0 0 0 0 4zm0 1a3 3 0 1 0 0-6 3 3 0 0 0 0 6z"/></g><g fill="currentColor" fill-rule="evenodd" clip-rule="evenodd" class="crossed-eye"><path d="M8.85 16.27c.92.44 1.97.73 3.15.73 2.7 0 4.7-1.49 6-2.91 0 0 2-2.09 2-3.09s-2-3.09-2-3.09l-.39-.4-.7.7.34.38S19 10.5 19 11c0 .5-1.75 2.41-1.75 2.41C16.05 14.74 14.3 16 12 16c-.88 0-1.68-.18-2.4-.48l-.75.75zM7.1 13.78l-.36-.37S5 11.5 5 11c0-.5 1.74-2.41 1.74-2.41C7.94 7.26 9.7 6 12 6c.88 0 1.68.18 2.4.48l.75-.75A7.17 7.17 0 0 0 12 5C9.3 5 7.3 6.49 6 7.91 6 7.91 4 10 4 11s2 3.09 2 3.09l.39.4.7-.7z"/><path d="M11.22 13.9a3 3 0 0 0 3.68-3.68l-.9.9A2 2 0 0 1 12.13 13l-.9.9zm.66-4.9A2 2 0 0 0 10 10.88l-.9.9a3 3 0 0 1 3.68-3.68l-.9.9zM5.65 16.65l12-12 .7.7-12 12-.7-.7z"/></g><g class="loading-eye"><path fill="currentColor" fill-rule="evenodd" clip-rule="evenodd" d="M18 7.91C16.7 6.5 14.7 5 12 5S7.3 6.49 6 7.91C6 7.91 4 10 4 11s2 3.09 2 3.09C7.3 15.5 9.3 17 12 17s4.7-1.49 6-2.91c0 0 2-2.09 2-3.09s-2-3.09-2-3.09zm-11.26 5.5C7.94 14.74 9.7 16 12 16s4.05-1.26 5.25-2.59c0 0 1.75-1.91 1.75-2.41 0-.5-1.75-2.41-1.75-2.41C16.05 7.26 14.3 6 12 6S7.95 7.26 6.74 8.59C6.74 8.59 5 10.5 5 11c0 .5 1.74 2.41 1.74 2.41z"/></g><g class="animated-loading-eye"><path stroke="currentColor" stroke-linecap="round" d="M14.5 11a2.5 2.5 0 1 0-2.5 2.5"/></g></svg>'},754336:e=>{
e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 22" width="24" height="22" fill="none"><g class="normal-eye"><path fill="currentColor" fill-rule="evenodd" clip-rule="evenodd" d="M17.9948 7.91366C16.6965 6.48549 14.6975 5 11.9999 5C9.30225 5 7.30322 6.48549 6.00488 7.91366C6.00488 7.91366 4 10 4 11C4 12 6.00488 14.0863 6.00488 14.0863C7.30322 15.5145 9.30225 17 11.9999 17C14.6975 17 16.6965 15.5145 17.9948 14.0863C17.9948 14.0863 20 12 20 11C20 10 17.9948 7.91366 17.9948 7.91366ZM6.74482 13.4137C7.94648 14.7355 9.69746 16 11.9999 16C14.3022 16 16.0532 14.7355 17.2549 13.4137C17.2549 13.4137 19 11.5 19 11C19 10.5 17.2549 8.58634 17.2549 8.58634C16.0532 7.26451 14.3022 6 11.9999 6C9.69746 6 7.94648 7.26451 6.74482 8.58634C6.74482 8.58634 5 10.5 5 11C5 11.5 6.74482 13.4137 6.74482 13.4137Z"/><path fill="currentColor" fill-rule="evenodd" clip-rule="evenodd" d="M12 13C13.1046 13 14 12.1046 14 11C14 9.89543 13.1046 9 12 9C10.8954 9 10 9.89543 10 11C10 12.1046 10.8954 13 12 13ZM12 14C13.6569 14 15 12.6569 15 11C15 9.34315 13.6569 8 12 8C10.3431 8 9 9.34315 9 11C9 12.6569 10.3431 14 12 14Z"/></g><g class="crossed-eye"><path fill="currentColor" fill-rule="evenodd" clip-rule="evenodd" d="M8.8503 16.2712C9.76531 16.7135 10.8152 17 11.9999 17C14.6975 17 16.6965 15.5145 17.9948 14.0863C17.9948 14.0863 20 12 20 11C20 10 17.9948 7.91366 17.9948 7.91366C17.8729 7.77954 17.7448 7.64491 17.6105 7.51105L16.9035 8.2181C17.0254 8.33968 17.1425 8.46276 17.2549 8.58634C17.2549 8.58634 19 10.5 19 11C19 11.5 17.2549 13.4137 17.2549 13.4137C16.0532 14.7355 14.3022 16 11.9999 16C11.1218 16 10.324 15.8161 9.60627 15.5153L8.8503 16.2712ZM7.09663 13.7823C6.97455 13.6606 6.85728 13.5374 6.74482 13.4137C6.74482 13.4137 5 11.5 5 11C5 10.5 6.74482 8.58634 6.74482 8.58634C7.94648 7.26451 9.69746 6 11.9999 6C12.8781 6 13.6761 6.18398 14.394 6.48495L15.1499 5.729C14.2348 5.28657 13.1847 5 11.9999 5C9.30225 5 7.30322 6.48549 6.00488 7.91366C6.00488 7.91366 4 10 4 11C4 12 6.00488 14.0863 6.00488 14.0863C6.12693 14.2206 6.25516 14.3553 6.38959 14.4893L7.09663 13.7823Z"/><path fill="currentColor" fill-rule="evenodd" clip-rule="evenodd" d="M11.2231 13.8984C11.4709 13.9647 11.7313 14 12 14C13.6569 14 15 12.6569 15 11C15 10.7313 14.9647 10.4709 14.8984 10.2231L13.9961 11.1254C13.934 12.1301 13.1301 12.934 12.1254 12.9961L11.2231 13.8984ZM11.8751 9.00384C10.87 9.06578 10.0658 9.87001 10.0038 10.8751L9.10166 11.7772C9.03535 11.5294 9 11.2688 9 11C9 9.34315 10.3431 8 12 8C12.2688 8 12.5294 8.03535 12.7772 8.10166L11.8751 9.00384Z"/><path fill="currentColor" fill-rule="evenodd" clip-rule="evenodd" d="M5.64648 16.6465L17.6465 4.64648L18.3536 5.35359L6.35359 17.3536L5.64648 16.6465Z"/></g><g class="loading-eye"><path fill="currentColor" fill-rule="evenodd" clip-rule="evenodd" d="M17.9948 7.91366C16.6965 6.48549 14.6975 5 11.9999 5C9.30225 5 7.30322 6.48549 6.00488 7.91366C6.00488 7.91366 4 10 4 11C4 12 6.00488 14.0863 6.00488 14.0863C7.30322 15.5145 9.30225 17 11.9999 17C14.6975 17 16.6965 15.5145 17.9948 14.0863C17.9948 14.0863 20 12 20 11C20 10 17.9948 7.91366 17.9948 7.91366ZM6.74482 13.4137C7.94648 14.7355 9.69746 16 11.9999 16C14.3022 16 16.0532 14.7355 17.2549 13.4137C17.2549 13.4137 19 11.5 19 11C19 10.5 17.2549 8.58634 17.2549 8.58634C16.0532 7.26451 14.3022 6 11.9999 6C9.69746 6 7.94648 7.26451 6.74482 8.58634C6.74482 8.58634 5 10.5 5 11C5 11.5 6.74482 13.4137 6.74482 13.4137Z"/></g><g class="animated-loading-eye"><path stroke="currentColor" stroke-linecap="round" d="M14.5 11C14.5 9.61929 13.3807 8.5 12 8.5C10.6193 8.5 9.5 9.61929 9.5 11C9.5 12.3807 10.6193 13.5 12 13.5"/></g></svg>'
},645534:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 2 30 24" width="30" height="24" fill="none"><circle stroke="currentColor" stroke-width="1.15" cx="8.08" cy="14" r="1.73"/><circle stroke="currentColor" stroke-width="1.15" cx="15" cy="14" r="1.73"/><circle stroke="currentColor" stroke-width="1.15" cx="21.92" cy="14" r="1.73"/></svg>'},387258:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 4" width="16" height="4" fill="none"><circle stroke="currentColor" cx="2" cy="2" r="1.5"/><circle stroke="currentColor" cx="8" cy="2" r="1.5"/><circle stroke="currentColor" cx="14" cy="2" r="1.5"/></svg>'},736885:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 18 18" width="18" height="18"><path fill="currentColor" d="M8.54.84a.8.8 0 0 1 .92 0l7.5 5.25a.8.8 0 0 1 0 1.32l-7.5 5.25a.8.8 0 0 1-.92 0L1.04 7.4a.8.8 0 0 1 0-1.32L8.54.84zM2.9 6.75L9 11.02l6.1-4.27L9 2.48 2.9 6.75z"/><path fill="currentColor" d="M.84 10.8a.8.8 0 0 1 1.12-.2L9 15.51l7.04-4.93a.8.8 0 0 1 .92 1.32l-7.5 5.25a.8.8 0 0 1-.92 0l-7.5-5.25a.8.8 0 0 1-.2-1.12z"/></svg>'},65300:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 15 15" width="15" height="15"><path fill="currentColor" d="M7.23 2.58a.5.5 0 0 1 .54 0l5.5 3.5a.5.5 0 0 1 0 .84l-5.5 3.5a.5.5 0 0 1-.54 0l-5.5-3.5a.5.5 0 0 1 0-.84l5.5-3.5zM2.93 6.5L7.5 9.4l4.57-2.9L7.5 3.6 2.93 6.5z"/><path fill="currentColor" d="M1.58 9.23a.5.5 0 0 1 .69-.15L7.5 12.4l5.23-3.33a.5.5 0 0 1 .54.84l-5.5 3.5a.5.5 0 0 1-.54 0l-5.5-3.5a.5.5 0 0 1-.15-.69z"/></svg>'},34882:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 22" width="24" height="22" fill="none"><path fill="currentColor" fill-rule="evenodd" clip-rule="evenodd" d="M6 6.5A2.5 2.5 0 0 1 8.5 4H10v1H8.5C7.67 5 7 5.67 7 6.5v1.15a3.5 3.5 0 0 1-1.93 3.13l-.45.22.45.22A3.5 3.5 0 0 1 7 14.35v1.15c0 .83.67 1.5 1.5 1.5H10v1H8.5A2.5 2.5 0 0 1 6 15.5v-1.15a2.5 2.5 0 0 0-1.38-2.23l-1.34-.67a.5.5 0 0 1 0-.9l1.34-.67A2.5 2.5 0 0 0 6 7.65V6.5zM15.5 5H14V4h1.5A2.5 2.5 0 0 1 18 6.5v1.15c0 .94.54 1.8 1.38 2.23l1.34.67a.5.5 0 0 1 0 .9l-1.34.67A2.5 2.5 0 0 0 18 14.35v1.15a2.5 2.5 0 0 1-2.5 2.5H14v-1h1.5c.83 0 1.5-.67 1.5-1.5v-1.15a3.5 3.5 0 0 1 1.93-3.13l.45-.22-.45-.22A3.5 3.5 0 0 1 17 7.65V6.5c0-.83-.67-1.5-1.5-1.5z"/></svg>'},583637:e=>{
e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 14 14" width="14" height="14" fill="none"><path fill="currentColor" fill-rule="evenodd" d="M8.63 1.08a2.04 2.04 0 0 1-3.26 0c-.51.14-1 .35-1.45.6l.01.2A2.05 2.05 0 0 1 1.7 3.93a6.1 6.1 0 0 0-.6 1.45 2.04 2.04 0 0 1 0 3.26c.13.51.34 1 .6 1.45l.2-.01a2.05 2.05 0 0 1 2.03 2.24c.45.26.94.47 1.45.6a2.04 2.04 0 0 1 3.26 0c.51-.13 1-.34 1.45-.6l-.01-.2a2.05 2.05 0 0 1 2.24-2.03c.26-.45.47-.94.6-1.45a2.04 2.04 0 0 1 0-3.26 6.1 6.1 0 0 0-.6-1.45 2.05 2.05 0 0 1-2.23-2.23 6.1 6.1 0 0 0-1.45-.6zM7.84.42c.17-.24.43-.47.72-.4.84.18 1.62.5 2.32.96.23.15.26.48.22.76a1.03 1.03 0 0 0 1.16 1.16c.28-.04.6-.01.76.22.45.7.78 1.48.97 2.32.06.29-.17.55-.41.72a1.02 1.02 0 0 0 0 1.68c.24.17.47.43.4.72a7.12 7.12 0 0 1-.96 2.32c-.15.23-.48.26-.76.22a1.03 1.03 0 0 0-1.17 1.01l.01.15c.04.28.01.6-.22.76-.7.45-1.48.78-2.32.97-.29.06-.55-.17-.72-.41a1.02 1.02 0 0 0-1.68 0c-.17.24-.43.47-.72.4a7.12 7.12 0 0 1-2.32-.96c-.23-.15-.26-.48-.22-.76v-.15a1.02 1.02 0 0 0-1.16-1c-.28.03-.6 0-.76-.23A7.12 7.12 0 0 1 0 8.56c-.06-.29.17-.55.41-.72a1.02 1.02 0 0 0 0-1.68c-.24-.17-.47-.43-.4-.72.18-.84.5-1.62.96-2.32.15-.23.48-.26.76-.22h.15a1.02 1.02 0 0 0 1-1.16c-.03-.28 0-.6.23-.76C3.82.53 4.6.2 5.44 0c.29-.06.55.17.72.41a1.02 1.02 0 0 0 1.68 0zM9 7a2 2 0 1 1-4 0 2 2 0 0 1 4 0zm1 0a3 3 0 1 1-6 0 3 3 0 0 1 6 0z"/></svg>'},572237:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 15 15" width="15" height="15"><path fill="currentColor" d="M11.65 12.35l-9-9 .7-.7 9 9-.7.7z"/><path fill="currentColor" d="M2.65 11.65l9-9 .7.7-9 9-.7-.7z"/></svg>'},671402:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 15 15" width="15" height="15" fill="none"><path stroke="currentColor" d="M11 2 7.5 5 4 2" class="bracket-up"/><path stroke="currentColor" d="M4 13l3.5-3 3.5 3" class="bracket-down"/></svg>'},636016:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 28" width="28" height="28"><path fill="currentColor" d="M7.65 8.35l.7-.7 6.15 6.14 6.15-6.14.7.7-6.14 6.15 6.14 6.15-.7.7-6.15-6.14-6.15 6.14-.7-.7 6.14-6.15-6.14-6.15z"/></svg>'},520465:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 28" width="28" height="28" fill="none"><path stroke="currentColor" d="M20.53 3.73 14 9.33 7.47 3.73M7.47 24.27l6.53 -5.60 6.53 5.60"/></svg>'},648344:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 28" width="28" height="28"><path fill="currentColor" d="M14 7v12.93l5.18-4.31.64.76-6.32 5.27-6.32-5.27.64-.76L13 19.93V7h1z"/></svg>'},99539:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 28" width="28" height="28"><path fill="currentColor" d="M19.32 6H8.68A2.68 2.68 0 0 0 6 8.68V11h1V8.68C7 7.75 7.75 7 8.68 7h10.64c.93 0 1.68.75 1.68 1.68V11h1V8.68C22 7.2 20.8 6 19.32 6zM7 19.32c0 .93.75 1.68 1.68 1.68h10.64c.93 0 1.68-.75 1.68-1.68V17h1v2.32C22 20.8 20.8 22 19.32 22H8.68A2.68 2.68 0 0 1 6 19.32V17h1v2.32z"/></svg>'},334763:e=>{
e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 28" width="28" height="28" fill="none"><path stroke="currentColor" d="m7.47 9.33 6.53 -5.60L20.53 9.33M20.53 18.67l-6.53 5.60L7.47 18.67"/></svg>'},472899:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 28" width="28" height="28"><path fill="currentColor" d="M13.5 6.35l6.32 5.27-.64.76L14 8.07V21h-1V8.07l-5.18 4.31-.64-.76 6.32-5.27z"/></svg>'},970471:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 18 18" width="18" height="18"><circle fill="currentColor" cx="15" cy="9" r="1.5"/><circle fill="currentColor" cx="9" cy="9" r="1.5"/><circle fill="currentColor" cx="3" cy="9" r="1.5"/></svg>'},682847:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 15 15" width="15" height="15"><circle fill="currentColor" cx="12.75" cy="7.5" r="1.25"/><circle fill="currentColor" cx="7.5" cy="7.5" r="1.25"/><circle fill="currentColor" cx="2.25" cy="7.5" r="1.25"/></svg>'},203515:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 15 15" width="15" height="15"><path fill="currentColor" d="M11.83 8.88l-.66-.76L8 10.9V3H7v7.9L3.83 8.12l-.66.76 4.33 3.78 4.33-3.78z"/></svg>'},374362:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 18 18" width="18" height="18"><path fill="currentColor" d="M3.5 2.8a.7.7 0 0 0-.7.7V6H1.2V3.5a2.3 2.3 0 0 1 2.3-2.3h11a2.3 2.3 0 0 1 2.3 2.3V6h-1.6V3.5a.7.7 0 0 0-.7-.7h-11z" class="bracket-up"/><path fill="currentColor" d="M3.5 15.2a.7.7 0 0 1-.7-.7V12H1.2v2.5a2.3 2.3 0 0 0 2.3 2.3h11a2.3 2.3 0 0 0 2.3-2.3V12h-1.6v2.5a.7.7 0 0 1-.7.7h-11z" class="bracket-down"/></svg>'},279526:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 15 15" width="15" height="15" fill="none"><path fill="currentColor" d="M4.5 12A1.5 1.5 0 0 1 3 10.5V9H2v1.5A2.5 2.5 0 0 0 4.5 13h6a2.5 2.5 0 0 0 2.5-2.5V9h-1v1.5c0 .83-.67 1.5-1.5 1.5h-6z" class="bracket-up"/><path fill="currentColor" d="M4.5 3C3.67 3 3 3.67 3 4.5V6H2V4.5A2.5 2.5 0 0 1 4.5 2h6A2.5 2.5 0 0 1 13 4.5V6h-1V4.5c0-.83-.67-1.5-1.5-1.5h-6z" class="bracket-down"/></svg>'},142930:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 15 15" width="15" height="15" fill="none"><path stroke="currentColor" d="m4 5 3.5-3L11 5" class="bracket-up"/><path stroke="currentColor" d="M11 10l-3.5 3L4 10" class="bracket-down"/></svg>'},981020:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 15 15" width="15" height="15"><path fill="currentColor" d="M11.83 6.12l-.66.76L8 4.1V12H7V4.1L3.83 6.88l-.66-.76L7.5 2.34l4.33 3.78z"/></svg>'},554430:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 18 18" width="18" height="18"><path fill="currentColor" fill-rule="evenodd" clip-rule="evenodd" d="M9 2.5c-1.06 0-1.88.93-1.75 1.98l.63 5.03a1.13 1.13 0 0 0 2.25 0l.62-5.03A1.77 1.77 0 0 0 9 2.5zm0 10a1.5 1.5 0 1 0 0 3 1.5 1.5 0 0 0 0-3z"/></svg>'},127486:e=>{
e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 18 18" width="18" height="18"><path fill="currentColor" fill-rule="evenodd" clip-rule="evenodd" d="M9 4c-.79 0-1.38.7-1.25 1.48l.67 4.03a.59.59 0 0 0 1.16 0l.67-4.03A1.27 1.27 0 0 0 9 4zm0 8a1 1 0 1 0 0 2 1 1 0 0 0 0-2z"/></svg>'},904696:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 18 18" width="18" height="18"><path stroke="currentColor" stroke-linecap="round" stroke-width="2" d="M13.5 4.5l-9 9M4.5 4.5l9 9"/></svg>'},479639:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 18 18" width="18" height="18"><path stroke="currentColor" stroke-linecap="round" stroke-width="1.7" d="M12.5 5.5l-7 7m0-7l7 7"/></svg>'},257524:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 18 18" width="18" height="18"><path fill="currentColor" d="M7.57 14.8H5.03V3.36c1.62-.05 2.64-.08 3.06-.08 1.66 0 2.98.49 3.96 1.47a5.23 5.23 0 0 1 1.47 3.88c0 4.11-1.99 6.17-5.95 6.17zm-.5-9.66v7.8c.32.04.67.06 1.05.06 1.03 0 1.83-.38 2.41-1.12.58-.75.88-1.79.88-3.13 0-2.44-1.14-3.67-3.42-3.67-.22 0-.53.02-.93.06z"/></svg>'},167189:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 18 18" width="18" height="18"><path fill="currentColor" d="M7.84 13.7H5.78V4.4l2.48-.06c1.35 0 2.42.4 3.22 1.2.8.78 1.19 1.83 1.19 3.15 0 3.34-1.61 5.01-4.83 5.01zm-.41-7.85v6.35c.26.02.55.03.86.03.83 0 1.48-.3 1.95-.9.48-.6.72-1.46.72-2.54 0-2-.93-2.99-2.78-2.99-.18 0-.43.02-.75.05z"/></svg>'},876948:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 18 18" width="18" height="18"><path fill="currentColor" d="M7.65 5.16v2.68h3.78v1.73H7.65V13h5.19v1.8H5.62V3.35h7.3v1.8H7.65z"/></svg>'},267957:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 18 18" width="18" height="18"><path fill="currentColor" d="M7.9 5.87v2.17h3.07v1.4H7.9v2.8h4.22v1.46H6.25V4.4h5.94v1.47H7.9z"/></svg>'},156201:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 18 18" width="18" height="18"><path fill="currentColor" d="M14.48 5.1c-.52 2.03-1.46 3.04-2.82 3.04-.64 0-1.55-.19-2.74-.56-1.17-.38-1.99-.57-2.46-.57-.69 0-1.22.37-1.58 1.13H3.55A4.3 4.3 0 0 1 4.5 6c.5-.6 1.08-.9 1.74-.9.7 0 1.65.2 2.84.58 1.2.37 2.04.55 2.52.55.8 0 1.32-.37 1.59-1.13h1.29zm0 4.84c-.52 2.02-1.46 3.03-2.82 3.03-.64 0-1.55-.19-2.74-.56-1.17-.38-1.99-.57-2.46-.57-.69 0-1.22.38-1.58 1.13H3.55a4.3 4.3 0 0 1 .95-2.14c.5-.6 1.08-.9 1.74-.9.7 0 1.65.2 2.84.58 1.2.37 2.04.56 2.52.56.8 0 1.32-.38 1.59-1.13h1.29z"/></svg>'},458189:e=>{
e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 18 18" width="18" height="18"><path fill="currentColor" d="M13.4 5.9c-.41 1.62-1.16 2.43-2.25 2.43-.52 0-1.25-.15-2.2-.45-.93-.3-1.58-.45-1.96-.45-.55 0-.98.3-1.27.9H4.66c.1-.67.36-1.24.76-1.71.4-.48.86-.72 1.4-.72.56 0 1.31.16 2.27.46.95.3 1.62.45 2.01.45.64 0 1.06-.3 1.27-.9h1.03zm0 3.87c-.41 1.62-1.16 2.43-2.25 2.43-.52 0-1.25-.15-2.2-.45-.93-.3-1.58-.46-1.96-.46-.55 0-.98.3-1.27.9H4.66c.1-.67.36-1.24.76-1.7.4-.48.86-.72 1.4-.72.56 0 1.31.15 2.27.46.95.3 1.62.44 2.01.44.64 0 1.06-.3 1.27-.9h1.03z"/></svg>'},635561:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 18 18" width="18" height="18"><path fill="currentColor" d="M13 12.78V5.22a.3.3 0 0 0-.51-.2L8.7 8.78a.3.3 0 0 0 0 .42L12.5 13a.3.3 0 0 0 .51-.21zM8 12.78V5.22a.3.3 0 0 0-.51-.2L3.7 8.78a.3.3 0 0 0 0 .42L7.5 13a.3.3 0 0 0 .51-.21z"/></svg>'},662920:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" width="16" height="16"><path fill="currentColor" d="M2.4 5.46a.8.8 0 0 1 1.14-.05L8 9.42l4.46-4.01a.8.8 0 0 1 1.08 1.18L8 11.58 2.47 6.59a.8.8 0 0 1-.06-1.13z"/></svg>'},947036:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 15 15" width="15" height="15"><path fill="currentColor" d="M3.5 5.58c.24-.28.65-.3.92-.07L7.5 8.14l3.08-2.63a.65.65 0 1 1 .84.98L7.5 9.86 3.58 6.49a.65.65 0 0 1-.07-.91z"/></svg>'},542205:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 7 7" width="7" height="7"><path fill="currentColor" d="M3.5 7L7 4H4V0H3V4H0L3.5 7Z"/></svg>'},247424:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 14 14" width="14" height="14"><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-width="2" d="M8.5 1.5L3.5 7l5 5.5"/></svg>'},533699:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 12" width="12" height="12" fill="none"><path fill="currentColor" d="M11.57 0H1a1 1 0 0 0-1 1v10a1 1 0 0 0 1 1h10.57a.5.5 0 0 0 .41-.78l-3.3-4.94a.5.5 0 0 1 0-.56l3.3-4.94a.5.5 0 0 0-.41-.78z"/></svg>'},303106:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 28" width="28" height="28"><g class="corner-left-top"><path fill="currentColor" d="M6 9C6 7.89543 6.89543 7 8 7H10C10.5523 7 11 7.44772 11 8C11 8.55228 10.5523 9 10 9H8V11C8 11.5523 7.55228 12 7 12C6.44772 12 6 11.5523 6 11V9Z"/></g><g class="corner-right-top"><path fill="currentColor" d="M17 8C17 7.44772 17.4477 7 18 7H20C21.1046 7 22 7.89543 22 9V11C22 11.5523 21.5523 12 21 12C20.4477 12 20 11.5523 20 11V9H18C17.4477 9 17 8.55228 17 8Z"/></g><g class="corner-right-bottom"><path fill="currentColor" d="M21 16C21.5523 16 22 16.4477 22 17V19C22 20.1046 21.1046 21 20 21H18C17.4477 21 17 20.5523 17 20C17 19.4477 17.4477 19 18 19H20V17C20 16.4477 20.4477 16 21 16Z"/></g><g class="corner-left-bottom"><path fill="currentColor" d="M7 16C7.55228 16 8 16.4477 8 17V19H10C10.5523 19 11 19.4477 11 20C11 20.5523 10.5523 21 10 21H8C6.89543 21 6 20.1046 6 19V17C6 16.4477 6.44772 16 7 16Z"/></g></svg>'},978360:e=>{
e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 28" width="28" height="28"><g class="corner-left-top"><path fill="currentColor" d="M10 7C10.5523 7 11 7.44772 11 8V10C11 11.1046 10.1046 12 9 12H7C6.44772 12 6 11.5523 6 11C6 10.4477 6.44772 10 7 10H9V8C9 7.44772 9.44772 7 10 7Z"/></g><g class="corner-right-top"><path fill="currentColor" d="M18 7C18.5523 7 19 7.44772 19 8V10H21C21.5523 10 22 10.4477 22 11C22 11.5523 21.5523 12 21 12H19C17.8954 12 17 11.1046 17 10V8C17 7.44772 17.4477 7 18 7Z"/></g><g class="corner-right-bottom"><path fill="currentColor" d="M17 18C17 16.8954 17.8954 16 19 16H21C21.5523 16 22 16.4477 22 17C22 17.5523 21.5523 18 21 18H19V20C19 20.5523 18.5523 21 18 21C17.4477 21 17 20.5523 17 20V18Z"/></g><g class="corner-left-bottom"><path fill="currentColor" d="M6 17C6 16.4477 6.44772 16 7 16H9C10.1046 16 11 16.8954 11 18V20C11 20.5523 10.5523 21 10 21C9.44772 21 9 20.5523 9 20V18H7C6.44772 18 6 17.5523 6 17Z"/></g></svg>'},94881:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 14 14" width="14" height="14"><path stroke="currentColor" stroke-linecap="round" stroke-width="2" d="M2 7h10"/></svg>'},588398:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 14 14" width="14" height="14"><path stroke="currentColor" stroke-linecap="round" stroke-width="2" d="M7 2v10M2 7h10"/></svg>'},715741:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 14 18" width="14" height="18"><g fill="none" stroke="currentColor" stroke-linecap="round" stroke-width="2"><path d="M1 10a6 6 0 1 0 6-6H3"/><path d="M5 1L2.5 4 5 7"/></g></svg>'},549483:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 14 14" width="14" height="14"><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-width="2" d="M6.5 1.5l5 5.5-5 5.5M3 4l2.5 3L3 10"/></svg>'},670340:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 14 14" width="14" height="14"><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-width="2" d="M5.5 1.5l5 5.5-5 5.5"/></svg>'},250662:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 7 7" width="7" height="7"><path fill="currentColor" d="M3.5 0L0 3h3v4h1V3h3L3.5 0z"/></svg>'}}]);