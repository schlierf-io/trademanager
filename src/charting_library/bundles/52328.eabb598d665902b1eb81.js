"use strict";(self.webpackChunktradingview=self.webpackChunktradingview||[]).push([[52328],{954588:(e,a,n)=>{n.d(a,{getEarlyAccessDiscount:()=>l,getVisitEarlyAccessPaymentPageProperties:()=>c,visitEarlyAccessPaymentPage:()=>u,fill:()=>d});var t=n(960489),o=n(960254),i=n(919490),r=n(51237),s=n(985919);function l(){return window.user&&window.user.available_offers&&window.user.available_offers.early_access?window.user.available_offers.early_access.max_discount:null}function c(e,a,n={}){return e=e||o.ProPlans.ProRealtime,(a=a||l())&&(e="{0}_{1}{2}".format(e,a,i.EA_SUFFIX)),{billingCycle:t.BillingCycle.OneYear,options:{fixedCycle:!1,paymentMethod:n.paymentMethod,productName:e}}}function u(e,a,n={}){const{billingCycle:t,options:o}=c(e,a,n);(0,r.visitPaymentPage)(t,o)}function d(e){var a;const t=document.querySelector(".js-early-access-area"),o=l(),i=window.user.available_offers?null===(a=window.user.available_offers[s.OFFERS.early_access])||void 0===a?void 0:a.expire_on:void 0;t&&o&&i&&async function(e,a){(await Promise.all([n.e(37908),n.e(53262),n.e(99292),n.e(75514),n.e(66742),n.e(5416),n.e(71854)]).then(n.bind(n,593988))).renderEarlyBirdBanner(e,a)}(t,{discount:o,onButtonClick:e,expiration:i}).then((()=>{t.classList.remove("js-hidden")}))}},252328:(e,a,n)=>{var t=n(823127),o=n(49437).TVLocalStorage,i=n(117427).trialMessageSuccessDialog,r=n(989345).startFreeTrialDialog,s=n(379388).getEarlyBirdDialogDay,l=n(600106).showEarlyBirdDialog,c=n(481200).showSixMonthsDialog,u=n(871843).blackFridayDialog,d=n(803732).showThreeMonthsDialog,f=n(798062).getUrlParams,p=n(51237).visitPaymentPage,_=n(345848).trackEvent,h=n(919490),v=n(954588).fill,w=n(464580).fill,g=n(464580).getLastChanceFeatureKey,y=n(243640).fill,m=n(490048).fill,b=n(954588).visitEarlyAccessPaymentPage,P=n(954588).getEarlyAccessDiscount,D=n(62802),T=n(985919).OFFERS,k=n(252445).TrialTokenStates;const{qaGlobals:S}=n(659863);var C=n(890740).fetch,F=n(960254).ProPlans,x=n(960489).BillingCycle,E=n(776734).getTracker,O=n(638456).onGoPro,M=n(638456).onOrder,V=n(508846).createGoProDialog,B=n(527538).PredefinedAction,A=n(619057).check,R=n(453122).initThreeMonthsToast,N=n(919490).getProductForTrial,W=n(267077).getCountries,L=n(425213).initOrderDialogLoader;const j=["VN"];function I(){this._inited=!1}var q=new I;I.prototype.init=function(){if(!this._inited)return this._inited=!0,$(),!0};var G=n(777754).t(null,void 0,n(479809)),U=n(777754).t(null,void 0,n(720759)),H=n(777754).t(null,void 0,n(225365)),X="<p>"+G+"</p><p><span>"+H+"</span></p>",Y="<p>"+U+"</p><p><span>"+H+"</span></p>",$=function(){function e(e){_("ProRT trial",e)}function a(e,a){return function(e){var a=t.Deferred();e=e||{};var o=new FormData;return o.append("product_id",e.product_id),C("/trial/change/",{method:"POST",credentials:"include",headers:new Headers({acccept:"application/json","X-Requested-With":"XMLHttpRequest"}),body:o}).then((function(e){return e.json()})).then((function(t){!function(e,a){if(!e.code)return!1;var t,o=h.humanizeProPlan(a.product_id),i="",r=n(777754).t(null,void 0,n(133011)).format({
proPlanName:o}),s=n(777754).t(null,void 0,n(132730)).format({proPlanName:o}),l=n(777754).t(null,{context:"input"},n(309633));switch(e.code){case"user_has_product":i=S(n(777754).t(null,void 0,n(513612)).format({proPlanName:o}),s);break;case"trial_failed":i=S(n(777754).t(null,void 0,n(929480)).format({proPlanName:o}),s);break;case"unable_find_order":case"unable_change_trial":case"unable_update_subscription":i=S(n(777754).t(null,void 0,n(555447)).format({proPlanName:o}),n(777754).t(null,void 0,n(194600)));break;case"user_not_on_trial":i=S(n(777754).t(null,void 0,n(129083)),s);break;case"trial_not_available":r=n(777754).t(null,{context:"prohibited_trial"},n(655937)),i=S(n(777754).t(null,void 0,n(661170))),l=n(777754).t(null,{context:"prohibited_trial"},n(563990)),t=function(){p(x.OneYear,{paymentMethod:"paypal",productName:a.product_id})}}return Promise.all([n.e(36037),n.e(43082),n.e(36956),n.e(4100),n.e(50251),n.e(85783),n.e(25977),n.e(50762),n.e(39694),n.e(29201)]).then(n.bind(n,363170)).then((({warningDialog:e})=>{const a=e({title:r,content:i,closeButtonText:l}).open();t&&a.on("action:no",t)})),!0}(t,e)?a.resolve():a.reject()})),a.promise()}({product_id:e}).done((function(){i({title:n(777754).t(null,void 0,n(158942)),content:a||X}).then((function(e){e.on("afterClose",(function(){TradingView.onChartPage||location.reload()}))}))}))}function S(e,a){return a&&(a="<p>"+a+"</p>"),"<div>"+(a||"")+(e?"<p>"+e+"</p>":"")+"</div>"}function I(e){ee()&&is_authenticated&&(e=e||{},A().then((a=>{a?Promise.resolve().then(n.bind(n,997959)).then((({showRestrictedCountryNotificationDialog:e})=>{e()})):function(e){var a={startTrial:(e=e||{}).product_id,billingCycle:e.billing_cycle,proContext:e.proContext};window.TVDialogs&&window.TVDialogs.signModal?window.TVDialogs.signModal.on("afterClose",(function(){r(a).then((()=>e.onDestroySpinner()))})):r(a).then((()=>{e.onDestroySpinner()}))}(e)})))}function G(a){var n=function(){var n=(a=a||{}).discount=a.discount||P();if(!user.is_trial||!n||M()||O())return!1;var t=user.available_offers[T.early_access],o=a.trialDaysPassed||void 0!==t&&t.trial_days_passed,i=function(e,a){return"early_bird_dialog_"+s(e,a)}(a.state,o);var r={state:a.state,trialDaysPassed:o,discount:n,maxDiscount:t.max_discount,actionHref:"/gopro/?source=early_bird_dialog&feature=show_options",onActionClick:function(){$(i,"accept",window.user.id),runOrSignIn((function(){U("popup with discount: {0}%".format(n))}),{source:"Early access trial dialog"})},onClose:function(){$(i,"decline",window.user.id),a.onDecline?a.onDecline():function(a){e("Offer declined with discount: {0}%".format(a)),H()}(n)},root:document.createElement("div")};l(r),$(i,"open",window.user.id),e(a.ga_shown_msg||"Early access dialog shown with {0}% discount".format(n))};return"undefined"!=typeof pro?pro.runOrUpdate(n):n(),!0}function U(a){H(),e("GoPro after trial: {0}".format(a))}function H(){t.get("/accounts/update-trial-marker/"),window.user&&user.available_offers&&user.available_offers[T.early_access]&&delete user.available_offers[T.early_access].offer_state}
function $(e,a,n){E().then((function(t){null!==t&&t.trackPermissionDialog(e,a,(n||"").toString())}))}function K(){let e=!1;if(!(window.is_authenticated&&window.user&&window.user.available_offers&&window.user.available_offers[T.early_access]))return e;var a=P();v((function(){U("from billing page with discount: {0}%".format(a))}));var n=window.user.available_offers[T.early_access];if(!n.actual_state)return e;switch(n.offer_state){case k.Week1:case k.Week2:case k.Week3:case k.Week4:case k.Finished:e=G({state:n.offer_state})}return delete n.offer_state,e}function z(){var e=user.available_offers&&user.available_offers[T.three_months];if(!is_authenticated||!e)return!1;const a=parseInt(e.expire_on,10),n="three_months."+a,t="three_months_toast."+a,o="three_months_dialog";var i=new Date(1e3*(a-432e3)),r=new Date(1e3*(a-259200));return!O()&&!M()&&(!D.getValue(n)&&new Date>i?(d({onActionClick:function(){const e=N(window.user.pro_plan),a=window.user.available_offers[T.three_months].products[e];if(!a)return;const n=a.product_id;p(x.ThreeMonths,{productName:n}),$(o,"accept",window.user.id)},onClose:function(){$(o,"decline",window.user.id)},root:document.createElement("div")}),D.setValue(n,1,{forceFlush:!0}),$(o,"open",window.user.id),!0):void(D.getValue(t)||new Date>r&&(R("chart"),D.setValue(t,1,{forceFlush:!0}))))}function J(){var e=user.available_offers&&user.available_offers[T.six_months];if(!is_authenticated||!e)return!1;const a=parseInt(e.expire_on,10),t="six_months.week_shown_popup."+a,o="six_months.last_day_shown_popup."+a,i="six_months_dialog_last_day";if(m(),M()||O())return!1;if(!D.getValue(o)){var r=new Date(1e3*(a-86400));if(new Date>r)return c({actionHref:"/gopro/?source=six_months_last_day_popup&feature=show_options",onActionClick:function(){$(i,"accept",window.user.id)},onClose:function(){$(i,"decline",window.user.id)},root:document.createElement("div")}),D.setValue(o,1,{forceFlush:!0}),$(i,"open",window.user.id),!0}if(!D.getValue(t)){r=new Date(1e3*(a-1987200));if(new Date>r)return V({feature:"SixMonths",actions:[{text:n(777754).t(null,void 0,n(621760)),action:B.OpenGopro},{text:n(777754).t(null,void 0,n(476443)),action:B.Close,variant:"secondary",color:"red"}],closeButton:!1,closeOnEsc:!1,goproSource:"six_months_first_week_popup"}),D.setValue(t,1,{forceFlush:!0}),!0}return!1}function Q(){is_authenticated&&user.is_trial&&TradingView.setTrialAvailiable(!1),function(){const e=[K,z,J];for(let a=0;a<e.length&&!e[a]();a++);}(),function(){var e=user.available_offers&&user.available_offers[T.upgrade],a="upgrade.shown_popup";if(is_authenticated&&e&&e.last_payment_date){if(!f().upgrade_popup){if(D.getValue(a))return;var t=new Date(1e3*e.last_payment_date);const n=Math.abs(new Date-t);if(Math.ceil(n/864e5)<30)return}V({feature:"upgradeNotification",actions:[{text:n(777754).t(null,void 0,n(195451)),action:B.OpenGopro},{text:n(777754).t(null,void 0,n(553653)),action:B.Close,variant:"secondary",color:"red"}],closeButton:!1,closeOnEsc:!1,goproSource:"upgrade_info_popup"}),D.setValue(a,1,{forceFlush:!0})}}(),function(){
if(!O()&&!M()){var e=user.available_offers&&user.available_offers[T.last_chance];if(is_authenticated&&e){var a=g();if(a){w();var t=`${a}.shown_popup`;D.getValue(t)||(V({feature:a,actions:[{text:n(777754).t(null,void 0,n(99234)),action:B.OpenGopro},{text:n(777754).t(null,void 0,n(476443)),action:B.Close,variant:"secondary",color:"red"}],closeButton:!1,closeOnEsc:!1,goproSource:"last_chance_info_popup"}),D.setValue(t,1,{forceFlush:!0}))}}}}(),function(){var e=user.available_offers&&user.available_offers[T.one_usd];if(!O()&&!M()&&is_authenticated&&e){y();var a=new Date(1e3*e.expire_on),t="oneUsd.shown_popup_"+a.getFullYear()+"_"+a.getMonth();D.getValue(t)||(V({feature:"oneUsd",actions:[{text:n(777754).t(null,void 0,n(126154)),action:B.OpenGopro},{text:n(777754).t(null,void 0,n(476443)),action:B.Close,variant:"secondary",color:"red"}],closeButton:!1,closeOnEsc:!1,goproSource:"one_usd_info_popup"}),D.setValue(t,1,{forceFlush:!0}))}}();const e=user.available_offers[T.black_friday]||{},a=user.available_offers[T.cyber_monday]||{};(e.show_popup||a.show_popup)&&u(user.available_offers)}var Z=!1;function ee(){var e=o.getItem("trial_availiable");return null!=e&&1==+e}return q.startTrial=function(e){const a=L(),n={product_id:F.ProRealtime,billing_cycle:x.Monthly,onDestroySpinner:async()=>(await a)()};Object.assign(n,e||{});const t={mode:"signup",source:"before_start_trial",verifiedPhoneRequired:!0,doNotCheckSocialActivity:!0,doNotShowConfirmation:!0,startTrial:!0,paidAccountCheck:!0};W().then((e=>{const a=e.current_country_code;a&&j.includes(a)&&(t.isSuspiciousCountry=!0)})).finally((()=>runOrSignIn(I.bind(this,n),t)))},q.earlyAccessDialog=G,q.changeTrial=a,q.upgradeTrial=function(e){return a(e,X)},q.downgradeTrial=function(e){return a(e,Y)},q.isTrialAvailable=ee,q.openEarlyAccessPaymentPage=function(a){var n;b((a=a||{}).product_id,a.discount,{paymentMethod:a.paymentMethod}),n=a.reason,H(),e("Order after trial: {0}".format(n))},function(){if(Z)return!1;Z=!0;var e=function(){var e=t(document.documentElement);window.is_authenticated&&ee()?e.addClass("is-trial-available").removeClass("is-not-trial-available"):e.addClass("is-not-trial-available").removeClass("is-trial-available")};loginStateChange.subscribe(null,(function(a){a||e()})),e(),t(Q)}}();e.exports=q},464580:(e,a,n)=>{n.d(a,{getLastChanceFeatureKey:()=>i,fill:()=>r});var t=n(985919);function o(){var e,a;return null===(a=null===(e=window.user.available_offers)||void 0===e?void 0:e[t.OFFERS.last_chance])||void 0===a?void 0:a.expire_on}function i(){const e=o();if(!e)return;const a=a=>new Date(1e3*(e-24*a*60*60));let n=t.LastChanceType.TwoWeeks;const i=new Date;if(i>=new Date(1e3*e))return;const r=a(2),s=a(1);return i>r&&(n=t.LastChanceType.TwoDays),i>s&&(n=t.LastChanceType.Hours),n}function r(){const e=document.querySelector(".js-last-chance-area"),a=o(),r=null===(l=null===(s=window.user.available_offers)||void 0===s?void 0:s[t.OFFERS.last_chance])||void 0===l?void 0:l.max_discount;var s,l;e&&a&&r&&async function(e,a){
(await Promise.all([n.e(37908),n.e(53262),n.e(99292),n.e(75514),n.e(5416),n.e(71611)]).then(n.bind(n,86618))).renderLastChanceBanner(e,a)}(e,{expiration:a,maxDiscount:r,lastChanceType:i()}).then((()=>{e.classList.remove("js-hidden")}))}},243640:(e,a,n)=>{n.d(a,{fill:()=>o});var t=n(985919);function o(){var e;const a=document.querySelector(".js-one-usd-area"),o=window.user.available_offers?null===(e=window.user.available_offers[t.OFFERS.one_usd])||void 0===e?void 0:e.expire_on:void 0;a&&async function(e,a){(await Promise.all([n.e(37908),n.e(53262),n.e(99292),n.e(75514),n.e(5416),n.e(47550)]).then(n.bind(n,803713))).renderOneUsdBanner(e,a)}(a,{expiration:o}).then((()=>{a.classList.remove("js-hidden")}))}},490048:(e,a,n)=>{n.d(a,{fill:()=>o});var t=n(985919);function o(){var e,a;const o=document.querySelector(".js-six-months-area"),i=null===(a=null===(e=window.user.available_offers)||void 0===e?void 0:e[t.OFFERS.six_months])||void 0===a?void 0:a.expire_on;o&&i&&async function(e,a){(await Promise.all([n.e(37908),n.e(53262),n.e(99292),n.e(75514),n.e(5416),n.e(90850)]).then(n.bind(n,915553))).renderBanner(e,a)}(o,{expiration:i}).then((()=>{o.classList.remove("js-hidden")}))}},453122:(e,a,n)=>{n.d(a,{initThreeMonthsToast:()=>r});var t=n(638456),o=n(314802);class i{async showThreeMonthsToast(e,a){const{globalToasts:t}=await Promise.all([n.e(91217),n.e(37742),n.e(75514),n.e(7250),n.e(94291)]).then(n.bind(n,13830));!async function(e,a,t){(await Promise.all([n.e(18619),n.e(21009),n.e(82485),n.e(45837)]).then(n.bind(n,326833))).showThreeMonthsNotification(e,a,t)}(t,e,a)}static getInstance(){return i._instance||(i._instance=new i),i._instance}}function r(e){return(0,o.isOnMobileAppPage)("any")||t.CheckMobile.Android()||window.TVD||!window.TradingView.onChartPage?Promise.resolve():new Promise((a=>{i.getInstance().showThreeMonthsToast(e,(()=>(a(),Promise.resolve())))}))}},252445:(e,a,n)=>{var t;n.d(a,{TrialTokenStates:()=>t}),function(e){e.Started="started",e.Week1="after 1 week",e.Week2="after 2 weeks",e.Week3="after 3 weeks",e.Week4="after 4 weeks",e.Finished="finished"}(t||(t={}))},871843:(e,a,n)=>{n.d(a,{blackFridayDialog:()=>r});var t=n(62802),o=n(985919),i=n(314802);function r(e){const a=o.OFFERS.cyber_monday in e?o.OFFERS.cyber_monday:o.OFFERS.black_friday,r=window.location.pathname.split("/")[1];if((0,i.isOnMobileAppPage)("any"))return Promise.resolve();if(t.getBool(`${a}.shown_popup_last_day_2022`))return Promise.resolve();const s=e[o.OFFERS.cyber_monday];return s&&(1e3*s.date_end-Date.now())/864e5>1||["","black-friday","order","paypal","accounts","account-recovery","gopro"].includes(r)?Promise.resolve():async function(e){const{showBlackFridayDialog:a}=await Promise.all([n.e(18619),n.e(36037),n.e(43082),n.e(36956),n.e(49846),n.e(4100),n.e(50251),n.e(85783),n.e(53262),n.e(36979),n.e(34200),n.e(79218),n.e(474),n.e(65966),n.e(75514),n.e(25977),n.e(33767),n.e(39694),n.e(74247),n.e(67713)]).then(n.bind(n,760521));a().on("afterClose",(()=>{t.setValue(`${e}.shown_popup_last_day_2022`,!0,{forceFlush:!0})}))}(a)}},600106:(e,a,n)=>{
async function t(e){(await Promise.all([n.e(89525),n.e(86256),n.e(37908),n.e(13249),n.e(96246),n.e(53262),n.e(33764),n.e(75514),n.e(33619),n.e(58435)]).then(n.bind(n,768869))).renderEarlyBirdDialog(e)}n.d(a,{showEarlyBirdDialog:()=>t})},379388:(e,a,n)=>{n.d(a,{getEarlyBirdDialogDay:()=>o});var t=n(252445);function o(e,a){switch(e){case t.TrialTokenStates.Week1:return"7";case t.TrialTokenStates.Week2:return"14";case t.TrialTokenStates.Week3:return"21";case t.TrialTokenStates.Week4:case t.TrialTokenStates.Finished:return 28===a?"28":"30";default:return null}}},989345:(e,a,n)=>{n.d(a,{startFreeTrialDialog:()=>i});var t=n(125226),o=n(492630);function i(e){return(0,t.isFeatureEnabled)("braintree-trial-in-order-dialog")?(0,o.showPaymentOrderDialog)({productId:e.startTrial,billingCycle:e.billingCycle,isTrial:!0}):(0,t.isFeatureEnabled)("braintree-trial-implementation")?Promise.all([n.e(76049),n.e(57688),n.e(13554),n.e(97325),n.e(88230),n.e(18619),n.e(7624),n.e(59333),n.e(12275),n.e(33335),n.e(78707),n.e(83772),n.e(85761),n.e(33287),n.e(36037),n.e(64884),n.e(37908),n.e(20187),n.e(51907),n.e(62040),n.e(20849),n.e(89034),n.e(36509),n.e(47523),n.e(24263),n.e(56342),n.e(64566),n.e(68849),n.e(29082),n.e(83265),n.e(75514),n.e(24951),n.e(41346),n.e(16665),n.e(62073),n.e(65679),n.e(25418),n.e(46533),n.e(78132)]).then(n.bind(n,869281)).then((a=>{(0,a.showStartFreeTrialDialog)(e)})):Promise.all([n.e(76049),n.e(13554),n.e(46962),n.e(97325),n.e(15769),n.e(88230),n.e(7624),n.e(59333),n.e(12275),n.e(33335),n.e(83772),n.e(33287),n.e(43082),n.e(20187),n.e(36956),n.e(51907),n.e(85931),n.e(62040),n.e(83278),n.e(36509),n.e(78672),n.e(64820),n.e(64566),n.e(74341),n.e(29082),n.e(34821),n.e(75514),n.e(25977),n.e(24951),n.e(62073),n.e(84107),n.e(46533),n.e(49144)]).then(n.bind(n,459505)).then((a=>{(0,a.showStartFreeTrialDialog)(e)}))}},481200:(e,a,n)=>{async function t(e){(await Promise.all([n.e(86256),n.e(37908),n.e(13249),n.e(96246),n.e(53262),n.e(77772),n.e(75514),n.e(44816)]).then(n.bind(n,517356))).renderSixMonthsDialog(e)}n.d(a,{showSixMonthsDialog:()=>t})},803732:(e,a,n)=>{async function t(e){(await Promise.all([n.e(86256),n.e(37908),n.e(13249),n.e(96246),n.e(50651),n.e(75514),n.e(53626)]).then(n.bind(n,291514))).renderThreeMonthsDialog(e)}n.d(a,{showThreeMonthsDialog:()=>t})},117427:(e,a,n)=>{async function t(e={}){return(await Promise.all([n.e(36037),n.e(43082),n.e(36956),n.e(4100),n.e(50251),n.e(85783),n.e(6877),n.e(25977),n.e(9073),n.e(39694),n.e(91653)]).then(n.bind(n,625302))).trialMessageSuccessDialog(e)}n.d(a,{trialMessageSuccessDialog:()=>t})}}]);